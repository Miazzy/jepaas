/*
  * ===========================================================
  *  je-util-min.js Form JEPAAS 
  *  version:V7.0.0 (2019-10-10) 
  *  This file using the AGPL3.0, if need to revise this file, please use the same agreement.
  * =========================================================== 
*/
!function(){var r=window.JE=window.JE||{};r.static=r.static||{};Ext.iterate({"JE.common":{image:{user:"/static/project/images/user.png",logo:"/static/project/images/logo.png",error:"/static/project/images/error.png","logo-small":"/static/project/images/logo-small.png"}},"JE.app.view.MainView":{image:{"no-perm":"/static/project/images/perm-empty.png"}},"JE.core.util.func.Grid":{image:{nodata:"/static/project/images/data-empty.png"}},"JE.core.ux.form.FilesUploadSet":{image:{search:"/static/images/form/search.png",download:"/static/images/form/download.png",remove:"/static/images/form/remove.png"}},"JE.core.view.industry.Cell":{image:{image:"/static/images/industry/image.png",on:"/static/images/industry/on.png",off:"/static/images/industry/off.png"}},"JE.sys.chart.view.MainView":{image:{chart:"/static/images/plantform/chart.png"}},"JE.sys.funccfg.view.field.FieldFormTitle":{image:{formedit:"/static/images/form/formedit.png"}},"JE.sys.funccfg.view.Func":{image:{FUNCINFO_OCFORM:"/static/images/FUNCINFO_OCFORM.png",FUNCINFO_ONETOFORM:"/static/images/FUNCINFO_ONETOFORM.png"}},"JE.sys.im.view.MainView":{image:{mibg:"/static/images/mibg.jpg"}},"JE.sys.plantform.view.MainView":{image:{"plantform-logo":"/static/images/plantform/plantform-logo.png",product:"/static/images/plantform/product.png","plantform-show1":"/static/images/plantform/plantform-show1.png","plantform-show2":"/static/images/plantform/plantform-show2.png"}},"JE.sys.saas.controller.CpPermController":{image:{CustomDevelop:"/static/images/saas/CustomDevelop.jpg"}},"JE.sys.saas.view.market.OrderView":{image:{nocp:"/static/images/saas/market/nocp.png"}},"JE.sys.saas.view.market.TypeView":{image:{star:"/static/images/saas/market/star.png","star-selected":"/static/images/saas/market/star-selected.png",buy:"/static/images/saas/market/buy.png","buy-selected":"/static/images/saas/market/buy-selected.png",plugin:"/static/images/saas/market/plugin.png","plugin-selected":"/static/images/saas/market/plugin-selected.png"}},"JE.sys.table.view.MainView":{image:{table:"/static/images/plantform/table.png"}},"JE.sys.workflowfunc.view.CenterView":{image:{new:"/static/images/new.gif"}},"JE.core.ux.mxgraph.cells.WorkFlowCells":{image:{start:"/static/images/workflow/start.png",end:"/static/images/workflow/end.png",decision:"/static/images/workflow/decision.png",fork:"/static/images/workflow/fork.png",join:"/static/images/workflow/join.png",countersign:"/static/images/workflow/countersign.png",joint:"/static/images/workflow/joint.png",to_assignee:"/static/images/workflow/to_assignee.png",child_flow:"/static/images/workflow/child_flow.png",auto:"/static/images/workflow/auto.png",circular:"/static/images/workflow/circular.png"}},"JE.core.ux.mxgraph.cells.IndustryCells":{image:{image:"/static/images/industry/image.png",on:"/static/images/industry/on.png",off:"/static/images/industry/off.png","背景":"/static/images/industry/背景.png","开关":"/static/images/industry/开关.png","刻度":"/static/images/industry/刻度.png","指示灯":"/static/images/industry/指示灯.png","指示灯2":"/static/images/industry/指示灯2.png","文字":"/static/images/industry/文字.png","文本域":"/static/images/industry/文本域.png","自定义":"/static/images/industry/自定义.png",APP:"/static/images/industry/custom/APP.png",CHART:"/static/images/industry/custom/CHART.png",HTML:"/static/images/industry/custom/HTML.png",REPORT:"/static/images/industry/custom/REPORT.png"}},"JE.app":{image:{folder:"/static/ux/phone/images/folder.png",app:"/static/ux/phone/images/app.png",logo:"/static/ux/phone/images/logo.png"}},"JE.qrcode":{image:{vcardbg7:"/static/ux/qrcode/img/vcardbg7.jpg",file:"/static/ux/qrcode/img/file.png",maku:"/static/ux/qrcode/img/maku.png","upload-file":"/static/ux/qrcode/img/upload-file.png","upload-image":"/static/ux/qrcode/img/upload-image.png"}},"JE.core.util.PortalUtil":{swf:{"时钟1":"/static/ux/colckSWF/时钟1.swf","时钟2":"/static/ux/colckSWF/时钟2.swf","时钟3":"/static/ux/colckSWF/时钟3.swf","时钟4":"/static/ux/colckSWF/时钟4.swf","时钟5":"/static/ux/colckSWF/时钟5.swf","时钟6":"/static/ux/colckSWF/时钟6.swf","时钟7":"/static/ux/colckSWF/时钟7.swf","时钟8":"/static/ux/colckSWF/时钟8.swf","时钟9":"/static/ux/colckSWF/时钟9.swf","时钟10":"/static/ux/colckSWF/时钟10.swf","时钟11":"/static/ux/colckSWF/时钟11.swf","时钟12":"/static/ux/colckSWF/时钟12.swf"}},"JE.common.file":{swf:{swfupload:"/static/ux/uploadPanel/swfupload/swfupload.swf",swfupload_fp9:"/static/ux/uploadPanel/swfupload/swfupload_fp9.swf",Uploader:"/static/ux/webuploader/swf/Uploader.swf",cmp:"/static/ux/cmpplayer/cmp.swf"}}},function(i,e){Ext.iterate(e,function(a,e){r.static[a]=r.static[a]||{},Ext.iterate(e,function(e,t){r.static[a][i+"."+e]=t})})})}(),Ext.define("JE.util.EChartUtil",{EColors:["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"],drawEChart:function(e,a){var i=Ext.getCmp(e);if(i){i.chart&&i.chart.timeFn&&clearInterval(i.chart.timeFn);var r=this.buildEChartCfg(i,a);if(i.store&&0==i.store.getCount())return i.destroyChart(),void i.getCmp("chartBox").update('<div class="empty-msg" style="width:100%;height:100%;background-color:#ffffff;display:table;"><span style="display: table-cell;text-align: center;vertical-align: middle;">没有数据展示！</span></div>');var t=Ext.value(a.echart.theme,"macarons");if(i.chart=echarts.init(i.getCmp("chartBox").getEl().dom,t),i.chart.setOption(r,!0,!1),"AngularGauge"==a.type){a.realTime=JE.toBool(a.chart.realTime),a.times=Number(Ext.value(a.chart.times,1e4));function o(){var t=a.ds[a.dsCfg.data.split(".")[0]].load(a.params);Ext.isArray(t)&&(t=t[0]),Ext.each(r.series,function(e){e.data[0].value=t[e.name]}),i.chart.setOption(r)}o(),a.realTime&&0<a.times&&(i.chart.timeFn=setInterval(o,a.times))}return i.hasListener("labelclick")&&i.chart.on("click",function(e){var t=e.data;Ext.isArray(e.value)&&Ext.isNumber(e.special)&&(t=e.value[e.special]),i.fireEvent("labelclick",i,t,i.chart)}),i.hasListener("load")&&i.fireEvent("load",i),i.chart}},buildEChartCfg:function(e,t){var a=this;t.typeInfo=a.getEChartTypes(t),t.dataInfo=a.buildEChartData(e,t);var i=a.buildOption(e,t);if(i=a.buildEChartEnd(e,t,i),JE.toBool(t.echart.enableIDIT)&&JE.isNotEmpty(t.echart.iditOption)){var r=JE.eval(t.echart.iditOption,JE.getLocalLang("core.jechartview").echartCfgError);JE.isNotEmpty(r)&&(i=r(i,e,t))}return i},buildOption:function(e,t){var i=this,a=t.chart,r=Ext.value(t.echart,{}),o=t.typeInfo,l=t.dataInfo,n={animation:JE.toBool(Ext.value(a.animation,"1")),backgroundColor:Ext.value(a.bgcolor,"#ffffff"),title:{show:!JE.toBool(r.hideTitle),left:Ext.value(r.titleX,"center"),top:Ext.value(r.titleY,"top"),text:a.caption,subtext:a.subcaption,textStyle:JE.toObj(r.textStyle),subtextStyle:JE.toObj(r.subtextStyle)},grid:{backgroundColor:Ext.value(a.canvasbgcolor,"rgba(0,0,0,0)"),borderWidth:JE.toNum(Ext.value(a.canvasborderthickness,0)),borderColor:Ext.value(a.canvasbordercolor,"#ccc")},legend:{show:JE.toBool(a.showlegend),padding:5,left:Ext.value(r.legendX,"center"),top:Ext.value(r.legendY,"bottom"),orient:Ext.value(r.legendOrient,"horizontal"),itemGap:10,data:l.legends},series:l.series};Ext.each(["top","right","bottom","left"],function(e){var t=r["grid_"+e];JE.isNotEmpty(t)&&(n.grid[e]=Ext.isNumber(t)?JE.toNum(t):t)}),n=Ext.apply(n,o.options),-1!=["vintage","dark"].indexOf(r.theme)&&JE.isEmpty(a.bgcolor)&&delete n.backgroundColor,n.title.show||delete n.title;var s=e.getCmp("chartBox").getEl();s&&(JE.isNotEmpty(a.bgimage)?(n.grid.backgroundColor="rgba(0,0,0,0)",n.grid.borderWidth=0,s.setStyle({backgroundImage:"url("+a.bgimage+")",backgroundRepeat:"tile"==a.bgimagedisplaymode?"repeat":"no-repeat",backgroundPositionX:Ext.value(a.bgimagehalign,"left"),backgroundPositionY:Ext.value(a.bgimagevalign,"top")})):s.setStyle({backgroundImage:"none"}));var c=JE.decode(Ext.value(r.mark,"[]")),d={},u={max:JE.getLocalLang("core.jechartview").max,min:JE.getLocalLang("core.jechartview").min,average:JE.getLocalLang("core.jechartview").average};return Ext.each(c,function(e){if(JE.isNotEmpty(e.serie)){d[e.serie]=Ext.value(d[e.serie],{markLine:{data:[]},markPoint:{data:[]}});var t="markPoint";"line"==e.type&&(t="markLine");var a={type:e.value,name:Ext.value(e.name,u[e.value])};JE.isNotEmpty(e.color)&&(a.itemStyle={normal:{color:e.color}}),Ext.isNumeric(a.type)&&(a.yAxis=a.type,delete a.type,"point"==e.type&&JE.alert("标注点不支持数值的标注值！")),JE.isNotEmpty(e.label)&&(a.label={normal:{formatter:i.echartFormatter(e.label)}}),d[e.serie][t].data.push(a)}}),Ext.each(n.series,function(e){d[e.name]&&Ext.apply(e,d[e.name])}),n},buildEChartData:function(e,a){var c=a.typeInfo,d=Ext.value(c.series,{}),u=(c.itemStyle,[]),E=[],p=[],f=0,m=0,g=0,h=!1;if("gauge"!=c.type){var t=this.buildDataSet(e,a),i=t.dataset;JE.isEmpty(i)&&t.data&&(i=[{data:t.data,seriesname:t.seriesname}]);var x=c.options.color||this.EColors;if(Ext.each(i,function(e,i){var t=Ext.value(e.renderas,c.type).toLowerCase(),r=["id","name","value","seriesname","bean"],o=[],l=0,n=0,s=0;Ext.each(e.data,function(t){0==i&&u.push(t.label),t.name=t.label;var a={};Ext.each(r,function(e){a[e]=t[e]}),a.value>l&&(l=a.value),a.value<n&&(n=a.value),!c.Column&&!c.Bar||c.MS||c.Stacked||(s>x.length&&(s=0),a.itemStyle={normal:{color:x[s]}},s++),o.push(a)});var a={type:t,data:o,_max:l};JE.isNotEmpty(e.renderas)&&("column"==a.type?a.type="bar":(Ext.apply(a,c.lineInfo),"area"==a.type&&(a.type="line",a.areaStyle={normal:{}}))),"S"==e.parentyaxis?(a.yAxisIndex=1,h=!0,m<l&&(m=l),g<n&&(g=n)):(f<l&&(f=l),0<n&&(yMix=n)),JE.isNotEmpty(e.seriesname)&&(a.name=e.seriesname,E.push(a.name)),c.Stacked&&(a.stack="echartStack"),Ext.applyIf(a,d),p.push(a)}),"radar"==c.type){var r=Ext.clone(d);r.data=[],Ext.each(p,function(e){var t=e.data,a=[];Ext.each(t,function(e){a.push(e.value)}),r.data.push({name:Ext.value(e.name,""),value:a,data:t}),r._max=r._max>e._max?r._max:e._max}),p=[r]}}else Ext.each(a.dsCfg.data.split(","),function(e){a.realDS=e.split(".")[0];var t={name:e=e.split(".")[1],data:[{id:e,name:e,value:0}]};Ext.applyIf(t,d),p.push(t)});return c.columnBar&&(Ext.each(p,function(e){e.data.reverse()}),u.reverse()),{labels:u,legends:E,series:p,yMM:[{max:f,min:0,useY:!0},{max:m,min:g,useY:h}]}},buildEChartEnd:function(e,t,a){var o=this,l=t.chart,i=Ext.value(t.echart,{}),r=t.typeInfo,n=t.dataInfo,s=n.labels;n.legends,n.series;if(-1!=["pie","radar","funnel","gauge"].indexOf(r.type)){if(delete a.grid,-1!=["pie","funnel"].indexOf(r.type))a.legend.data=s;else if("radar"==r.type){var c=a.radar,d=JE.isNotEmpty(a.series)?a.series[0]._max:0;Ext.each(s,function(e){c.indicator.push({text:e,max:d})}),JE.isNotEmpty(l.radarfillcolor)&&(c.splitArea={show:!0,areaStyle:{color:l.radarfillcolor}}),JE.isNotEmpty(l.radarbordercolor)&&(c.splitLine={show:!0,lineStyle:{color:l.radarbordercolor,width:JE.toNum(Ext.value(l.radarborderthickness,1)),type:"solid"}}),JE.toBool(l.showyaxisvalues)}}else{var u=[],E=[{prefix:l.numberprefix,suffix:l.numbersuffix},{prefix:l.snumberprefix,suffix:l.snumbersuffix}],p=[{max:l.pyaxismaxvalue,min:l.pyaxisminvalue},{max:l.syaxismaxvalue,min:l.syaxisminvalue}];Ext.each([l.yaxisname,l.syaxisname],function(e,t){var a=n.yMM[t],i=p[t];if(a.useY){var r={type:"value",name:e,splitNumber:JE.toNum(Ext.value(l.numdivlines,4))+1,axisLabel:{show:JE.toBool(l.showyaxisvalues),formatter:Ext.value(E[t].prefix,"")+"{value}"+Ext.value(E[t].suffix,"")}};JE.isNotEmpty(i.max)?r.max=JE.toNum(i.max):(r.max=a.max,r.max=o.buildEMaxNum(r)),JE.isNotEmpty(i.min)&&(r.min=JE.toNum(i.min)),u.push(r)}}),a.yAxis=u,i.rotate_x=Ext.value(i.rotate_x,"1"==l.slantlabels?50:0),a.xAxis=[{type:"category",data:s,boundaryGap:[.1,.1],name:l.xaxisname,axisLabel:{show:JE.toBool(l.showlabels),interval:JE.toNum(l.labelstep),rotate:JE.toNum(i.rotate_x)}}];var f=JE.decode(Ext.value(i.xyTitletextStyle,"{}")),m=JE.decode(Ext.value(i.xyLabeltextStyle,"{}"));if(splits=[{width:l.vdivlinethickness,color:l.vdivlinecolor,dashed:l.vdivlineisdashed,area:l.showalternatevgridcolor,areaColor:l.alternatevgridcolor},{width:Ext.value(l.divlinethickness,"1"),color:l.divlinecolor,dashed:l.divlineisdashed,area:l.showalternatehgridcolor,areaColor:l.alternatehgridcolor}],Ext.each([a.xAxis,a.yAxis],function(e,i){Ext.each(e,function(e,t){if(e.nameTextStyle=f,e.nameTextStyle.fontWeight=Ext.value(e.nameTextStyle.fontWeight,"bold"),e.axisLabel.textStyle=m,0==t){var a=splits[i];e.splitLine={show:0<JE.toNum(a.width),lineStyle:{color:[Ext.value(a.color,"#ccc")],width:JE.toNum(a.width),type:JE.toBool(a.dashed)?"dashed":"solid"}},e.splitArea={show:JE.toBool(a.area),areaStyle:{color:Ext.isEmpty(a.areaColor)?["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]:[a.areaColor]}}}})}),r.columnBar){var g=a.xAxis;a.xAxis=a.yAxis,a.yAxis=g}}return JE.isEmpty(a.legend.data)&&delete a.legend,a},getEChartTypes:function(e){var t=this,a=e.chart,i=Ext.value(e.echart,{}),r=e.type,o={code:r,type:"bar",options:{},series:{}};if(Ext.each(["Stacked","Scroll","DY","Combi","MS","Column","Bar","Pareto","Line","Area","Pie","Doughnut","Pyramid","Radar","AngularGauge"],function(e){o[e]=t.isExist(e,r)}),o.Column||o.Bar||o.Pareto)o.type="bar",o.columnBar=o.Bar,o.useColors=!o.MS;else if(o.Line||o.Area)o.type="line",Ext.apply(o.series,{smooth:JE.toBool(i.lineSmooth),lineStyle:{normal:{type:Ext.value(i.lineType,"solid")}}}),o.Area&&(o.series.areaStyle={normal:{}});else if(o.Combi)o.lineInfo={smooth:JE.toBool(i.lineSmooth),lineStyle:{normal:{type:Ext.value(i.lineType,"solid")}}};else if(o.Pie||o.Doughnut)o.useColors=!0,o.type="pie",o.radius="series",Ext.apply(o.series,{radius:[0,"60%"],selectedMode:"multiple",startAngle:0,clockwise:!1,label:{normal:{formatter:Ext.value(i.EPieLabelFormatter,"{name} : "+(JE.toBool(a.showpercentvalues)?"{percent}%":"{value}"))}}}),o.Doughnut&&(o.series.radius=["30%","60%"]),o.options.tooltip={formatter:"{name} : {value} ({percent}%)"};else if(o.Pyramid)o.type="funnel",o.useColors=!0,Ext.apply(o.series,{sort:"ascending",maxSize:"50%",label:{normal:{formatter:Ext.value(i.EPieLabelFormatter,"{name} : "+(JE.toBool(a.showpercentvalues)?"{percent}%":"{value}"))}}}),o.options.tooltip={formatter:"{name} : {value} ({percent}%)"};else if(o.Radar)o.type="radar",o.radius="radar",Ext.apply(o.options,{radar:{radius:"75%",indicator:[]},tooltip:{formatter:function(e){var t=[],a=e.data.data;return Ext.each(a,function(e){t.push(e.name+" : "+e.value)}),t.join("</br>")}}});else if(o.AngularGauge){o.type="gauge",o.radius="series";var l=Ext.apply(o.series,{startAngle:JE.toNum(Ext.value(a.gaugestartangle,225)),endAngle:JE.toNum(Ext.value(a.gaugeendangle,-45)),max:JE.toNum(Ext.value(a.upperLimit,100)),min:JE.toNum(Ext.value(a.lowerLimit,0)),splitNumber:JE.toNum(Ext.value(a.majorTMNumber,11))-1,axisTick:{show:!JE.toBool(i.gaugeHideAT),splitNumber:JE.toNum(Ext.value(a.minorTMNumber,5)),length:JE.toNum(Ext.value(i.gaugeAT,8))},precision:2,splitLine:{show:!JE.toBool(i.gaugeHideSL),length:JE.toNum(Ext.value(i.gaugeSL,30))},title:{show:!JE.toBool(i.gaugeHideTitle)},axisLabel:{show:JE.toBool(a.showtickvalues),formatter:Ext.value(a.numbersuffix,"")+"{value}"+Ext.value(a.numberprefix,"")},detail:{show:JE.toBool(a.showvalue),formatter:Ext.value(a.numbersuffix,"")+"{value}"+Ext.value(a.numberprefix,"")},radius:"75%",axisLine:{lineStyle:{color:[],width:10}},pointer:{length:"80%",width:8,color:"auto"}}),n=l.max,s=l.min,c=[];Ext.each(Ext.decode(Ext.value(a.colorrange,"[]")),function(e){c.push([(JE.toNum(e.maxvalue)-s)/(n-s),e.code])}),0<(l.axisLine.lineStyle.color=c).length?(l.axisTick.lineStyle={color:"#eee",width:1,type:"solid"},l.splitLine.lineStyle={color:"#eee",width:2,type:"solid"},l.axisLabel.textStyle={color:"#333"}):delete l.axisLine.lineStyle.color,JE.isNotEmpty(i.ERadius)&&(l.radius=Ext.isNumeric(i.ERadius)?JE.toNum(i.ERadius):i.ERadius),JE.isNotEmpty(i.ERadius2)&&(l.axisLine.lineStyle.width=Ext.isNumeric(i.ERadius2)?JE.toNum(i.ERadius2):i.ERadius2)}if(o.series.type=o.type,JE.toBool(a.enablecolors)&&JE.isNotEmpty(a.palettecolors)&&(o.options.color=a.palettecolors.split(",")),o.radius){var d=("radar"==o.type?o.options:o)[o.radius],u=d.radius,E=i.ERadius,p=i.ERadius2;Ext.isString(u)?(u=Ext.value(E,u),u=Ext.isNumeric(u)?JE.toNum(u):u):(u[0]=Ext.value(p,u[0]),u[1]=Ext.value(E,u[1]),u[0]=Ext.isNumeric(u[0])?JE.toNum(u[0]):u[0],u[1]=Ext.isNumeric(u[1])?JE.toNum(u[1]):u[1]),d.radius=u;var f=Ext.value(i.ECenterX,"50%"),m=Ext.value(i.ECenterY,"50%");f=Ext.isNumeric(f)?JE.toNum(f):f,m=Ext.isNumeric(m)?JE.toNum(m):m,d.center=[f,m]}return(o.Pie||o.Doughnut||o.Pyramid)&&(o.series.label={normal:{formatter:Ext.value(i.EPieLabelFormatter,"{name} : "+(JE.toBool(a.showpercentvalues)?"{percent}%":"{value}"))}}),o.series.label=o.series.label||{normal:{}},o.series.labelLine=o.series.labelLine||{normal:{}},o.series.label.normal.show=o.series.labelLine.normal.show=JE.toBool(e.chart.showvalues),o.series.label.normal.textStyle=JE.toObj(Ext.value(i.itemtextStyle,"{}")),o.series.label.normal.formatter=t.echartFormatter(o.series.label.normal.formatter),JE.isNotEmpty(i.labelPosition)&&(o.series.label.normal.position=i.labelPosition),o.Pie&&JE.toBool(i.EPieLabelPosition)&&(o.series.label.normal.position="inner",o.series.labelLine.normal.show=!1,o.series.label.emphasis={show:!0,formatter:o.series.label.normal.formatter}),o.options.tooltip=Ext.value(o.options.tooltip,{}),Ext.apply(o.options.tooltip,{show:JE.toBool(a.showtooltip),trigger:Ext.value(i.tooltipTrigger,"item"),axisPointer:{type:Ext.value(i.tooltipPointer,"none")}}),o.options.tooltip.formatter=t.echartFormatter(Ext.value(i.formatter,o.options.tooltip.formatter)),o},echartFormatter:function(e){if(JE.isNotEmpty(e))return Ext.isString(e)?JE.toXT(e,{seriesName:"{a}",name:"{b}",value:"{c}",percent:"{d}"}):e},buildEMaxNum:function(e){var t=JE.toNum(Ext.Number.toFixed(e.max,0)),a=e.splitNumber,i=t.toString(),r=i.length,o=t,l=1;if(2<r)for(var n=r<7?1:r-5,s=(o=JE.toNum(i.substring(0,n))+1,l=.1,0);s<r-n;s++)o*=10,l*=10;else o=t+(5-t%5);for(;o%a!=0;)o+=l;var c=o/a;for(s=1;c*s<t;)s++;for(o=c*s;o%a!=0;)o+=l;e.max=o,e.minInterval=e.max/a},isExist:function(e,t){return t.replace(e,"")!=t}}),Ext.define("JE.util.ChartUtil",{mixins:["JE.util.EChartUtil"],drawChart:function(e,t,a){return"echart"==a?this.drawEChart(e,t):this.drawFChart(e,t)},drawFChart:function(e,i){var t=this,a=Ext.getCmp(e);if(a){a.chart&&a.chart.timeFn&&clearInterval(a.chart.timeFn);var r=a.body.id,o=a.getCmp("chartBox");o&&(r=o.getEl().id);var l=new FusionCharts({swfUrl:t.loadSwf(i.type,!0),width:"100%",height:"100%"}),n={};if(n.chart=t.buildChart(a,i),n.styles=t.buildStyles(a,i),"AngularGauge"==i.type)n.renderId=r,t.buildAngularGauge(n,i);else{var s=t.buildDataSet(a,i);Ext.apply(n,s);var c=t.buildTrendlines(a,i);Ext.apply(n,c)}return l.setJSONData(n),Ext.defer(function(){if(l.render(r),"AngularGauge"==i.type){i.realDS;l.addEventListener("Rendered",function(e,t){function a(){var e=i.ds[i.realDS].load(i.params);Ext.isArray(e)&&(e=e[0]),Ext.iterate(e,function(e,t){l.setDataForId(e,t)})}a(),i.realTime&&0<i.times&&(l.timeFn=setInterval(a,i.times))})}a.hasListener("load")&&l.addEventListener("Rendered",function(e,t){a.fireEvent("load",a)})},10),l}},buildAngularGauge:function(t,a){var e=JE.toObj(t.chart.colorrange),i=JE.toObj(t.chart.trendpoints),r=JE.toObj(a.dsCfg.dialsCfg);a.realTime=JE.toBool(t.chart.realTime),a.times=Number(Ext.value(t.chart.times,1e4));var o=Ext.get(t.renderId);delete t.chart.colorrange,delete t.chart.trendpoints,delete t.chart.dialsCfg,delete t.chart.realTime,delete t.chart.times,delete t.renderId;var l=Ext.value(t.chart.gaugeOriginX,"50%"),n=Ext.value(t.chart.gaugeOriginY,"50%");l=Ext.isNumeric(l)?JE.toNum(l):JE.toNum(l.replace("%",""))/100*o.getWidth(),n=Ext.isNumeric(n)?JE.toNum(n):JE.toNum(n.replace("%",""))/100*o.getHeight(),t.chart.gaugeOriginX=l,t.chart.gaugeOriginY=n,t.colorrange={color:[]},Ext.each(e,function(e){t.colorrange.color.push(e)}),t.trendpoints={point:[]},Ext.each(i,function(e){e.displayvalue=JE.toXT(e.displayvalue,e),"1"==e.usemarker?Ext.apply(e,{markerColor:"#F1f1f1",markerBorderColor:"#666666",markerRadius:"10"}):delete e.usemarker,t.trendpoints.point.push(e)}),t.dials={dial:[]},Ext.each(a.dsCfg.data.split(","),function(e){a.realDS=e.split(".")[0];var i={id:e=e.split(".")[1],value:0,bgcolor:"#333333",bordercolor:"#333333",radius:t.chart.gaugeouterradius};Ext.each(r,function(a){if(a.id==e)return Ext.applyIf(i,a),Ext.iterate(i,function(e,t){JE.isNotEmpty(a[e])&&(i[e]=a[e])}),!1}),t.dials.dial.push(i)})},buildChart:function(e,t){var a={bgcolor:"#FFFFFF",canvasbgcolor:"#FFFFFF",canvasbordercolor:"#FFFFFF",showvalues:"0",showborder:"0",showalternatehgridcolor:"0",plotgradientcolor:"",showplotborder:"0",use3dlighting:"0",unescapeLinks:"0",formatNumberScale:"0",formatNumber:"0",exportEnabled:"1",exportDialogMessage:JE.getLocalLang("core.jechartview").exportDialogMessage,exportAtClient:"0",exportShowMenuItem:"0",palettecolors:"#008ee4,#f8bd19,#6baa01,#9b59b6,#e44a00,#d35400,#bdc3c7,#95a5a6,#34495e,#1abc9c"},i=Ext.clone(Ext.value(t.chart,{}));i.pyaxisname=i.yaxisname,i.yaxismaxvalue=i.pyaxismaxvalue,i.yaxisminvalue=i.pyaxisminvalue,delete(i=Ext.apply(i,Ext.decode(Ext.value(i.otherCfg,"{}")))).trendLines,delete i.otherCfg;var r={};return Ext.iterate(i,function(e,t){JE.isNotEmpty(t)&&(r[e]=t)}),r=Ext.applyIf(r,a)},buildStyles:function(e,t){},buildTrendlines:function(e,t){if(Ext.isEmpty(t.chart)||Ext.isEmpty(t.chart.trendLines))return{};var a=Ext.decode(t.chart.trendLines),i={},r=[],o=[],c=e.store;return Ext.each(a,function(e){var s={},t=e.vline;delete e.vline,Ext.iterate(e,function(e,t){JE.isNotEmpty(t)&&(s[e]=t)});Ext.each(["start","end"],function(e){var t=s[e+"GS"],a=Ext.value(s[e+"value"],""),i=s[e+"Format"],r=[];if(JE.isNotEmpty(t)){var o=a.split("."),l="S"==o[0]?"seriesname":"label",n=o[1];c.each(function(e){!Ext.isEmpty(a)&&e.data[l]!=n||r.push(Number(e.data.value))}),a="count"==t?r.length:Ext.Array[t](r),JE.isNotEmpty(i)&&(a=Ext.util.Format.number(a,i)),s[e+"value"]=a,delete s[e+"GS"],delete s[e+"Format"]}}),s.displayvalue=JE.toXT(s.displayvalue,s),s.tooltext=JE.toXT(s.tooltext,s),("1"==t?o:r).push(s)}),0<r.length&&(i.trendlines=[{line:r}]),0<o.length&&(i.vtrendlines=[{line:o}]),i},buildLabels:function(e,t,a){var i=e.dsCfg[t],r=i.split(".")[0],o=e.ds[r],l=i.split(".")[1],n=[],s=!1;if(JE.isEmpty(i))return n;var c="series"==t?"seriesname":t,d=(e.dsCfg.data||"").split(".")[0];if(o&&o.code!=d){a=o.load();Ext.each(a,function(e){var t={};t[c]=e[Ext.value(l,"name")],n.push(t)})}else if("DIC"==r){var u=JE.getDicItems(l);Ext.each(u,function(e){var t={};t[c]=e.text,t.dicData=e,n.push(t)})}else if("seriesname"==c)if(1<i.split(",").length)Ext.each(i.split(","),function(e){var t={};t[c]=e.split(".")[1],n.push(t)});else if("columns"==l){var E=Ext.isEmpty(e.dsCfg.labelField)?e.dsCfg.label:e.dsCfg.labelField;E=E.split(".")[1],Ext.each(Ext.value(o.config.fields,[]),function(e){if(e!=E){var t={};t[c]=e,n.push(t)}})}else s=!0;else s=!0;if(s){var p={};Ext.each(a,function(e){var t={},a=t[c]=e[l];p[a]||(n.push(t),p[a]=a)})}return n},buildStore:function(t,e){var a=e.labelList,i=e.seriesList,c=e.data,d=e.dataField,u=e.labelField,E=e.seriesField,r=e.dsCfg;JE.isNotEmpty(r.labelField)&&(u=r.labelField.split(".")[1]),JE.isNotEmpty(r.seriesField)&&(E=r.seriesField.split(".")[1]),JE.isEmpty(i)&&i.push({});var p=t.hasListener("labelclick"),f=Ext.create("Ext.data.Store",{fields:["id","label","value","seriesname","renderas","link","bean"],data:[]});return Ext.each(i,function(n){var s=n.seriesname;n.data=[],Ext.each(a,function(i){var r,o=i.label,l=0;Ext.each(c,function(e){var t=e[u],a=e[E];if(t=i.dicData&&i.dicData.code==t?i.dicData.text:t,a=n.dicData&&n.dicData.code==a?n.dicData.text:a,JE.isEmpty(d)){if(t==o)return l=JE.toNum(e[s]),r=Ext.clone(e),!1}else if(t==o&&a==s)return l=JE.toNum(e[d]),r=Ext.clone(e),!1});var e={id:JE.uuid(),value:l,label:o,bean:r};s&&(e.seriesname=s),p&&(e.link="j-JE.ChartUtil.labelClick-"+t.id+","+e.id),f.add(e),n.data.push(e)})}),f},buildDataSet:function(e,t){var a=t.ds,i=Ext.applyIf(t.dsCfg,{label:"",data:"",series:""}),r=i.label,o=i.data,l=i.series,n=o.split(".")[1],s=r.split(".")[1],c=l.split(".")[1],d=a[o.split(".")[0]].load(t.params),u=this.buildLabels(t,"label",d),E=this.buildLabels(t,"series",d),p=this.buildStore(e,{labelList:u,seriesList:E,data:d,dataField:n,labelField:s,seriesField:c,dsCfg:i}),f={},m=this.getChartCfgs(t.type);if(m.MS||m.Stacked||m.Scroll||m.DY){f.categories=[{category:u}];var g=Ext.decode(Ext.value(i.seriesCfg,"[]"));JE.isNotEmpty(g)&&Ext.each(E,function(t){Ext.each(g,function(e){t.seriesname==e.name&&(JE.isNotEmpty(e.color)&&(t.color=e.color),JE.isNotEmpty(e.type)&&(t.renderas=e.type),JE.toBool(e.rightY)&&(t.parentyaxis="S"),JE.toBool(e.showValues)&&(t.showvalues=e.showValues))})}),f.dataset=E}else{d=E[0].data;if(Ext.isEmpty(i.labelOrder)||d.sort(function(e,t){return"ASC"==i.labelOrder?Ext.value(e.value,0)-Ext.value(t.value,0):Ext.value(t.value,0)-Ext.value(e.value,0)}),t.type.replaceAll("Pareto","")!=t.type&&JE.isNotEmpty(t.chart.palettecolors)){var h=0,x=t.chart.palettecolors.split(","),y=x.length;Ext.each(d,function(e){h==y&&(h=0);var t=x[h];t&&(e.color=t),h++})}f.data=d,f.seriesname=n}return e.store=p,f},getChartsTypes:function(){var l=[],e=[];return Ext.each([{text:"柱状图",iconCls:"jeicon jeicon-chart-histogram",code:"column_",children:[{code:"Column2D",text:"2D"},{code:"MSColumn2D",text:"2D多数据集"},{code:"StackedColumn2D",text:"2D堆叠"},{code:"ScrollColumn2D",text:"2D滚动"},{code:"ScrollStackedColumn2D",text:"2D堆叠滚动"},{code:"Column3D",text:"3D"},{code:"MSColumn3D",text:"3D多数据集"},{code:"StackedColumn3D",text:"3D堆叠图"}]},{text:"折线图",code:"line_",iconCls:"jeicon jeicon-line-graph",children:[{code:"Line",text:"2D"},{code:"MSLine",text:"2D多数据集"},{code:"ScrollLine2D",text:"2D滚动"}]},{text:"面积图",code:"area_",iconCls:"jeicon jeicon-area-chart",children:[{code:"Area2D",text:"2D"},{code:"MSArea",text:"2D多数据集"},{code:"ScrollArea2D",text:"2D滚动"},{code:"StackedArea2D",text:"2D堆叠"}]},{text:"条形图",code:"bar_",iconCls:"jeicon jeicon-bar-chart",children:[{code:"Bar2D",text:"2D"},{code:"MSBar2D",text:"2D多数据集"},{code:"StackedBar2D",text:"2D堆叠"},{code:"MSBar3D",text:"3D多数据集"},{code:"StackedBar3D",text:"3D堆叠"}]},{text:"饼图",iconCls:"jeicon jeicon-pie-chart",code:"pie_",children:[{code:"Pie2D",text:"2D"},{code:"Doughnut2D",text:"2D环形图"},{code:"Pie3D",text:"3D"},{code:"Doughnut3D",text:"3D环形图"}]},{text:"组合图",code:"combi_",iconCls:"jeicon jeicon-combination-chart-tow",children:[{code:"MSCombi2D",text:"2D"},{code:"MSCombiDY2D",text:"2D双纵轴"},{code:"ScrollCombi2D",text:"2D滚动"},{code:"ScrollCombiDY2D",text:"2D滚动双纵轴"},{code:"MSCombi3D",text:"3D"}]},{text:"帕累托图",iconCls:"jeicon jeicon-chart-histogram-up",code:"pareto_",children:[{code:"Pareto2D",text:"2D"},{code:"Pareto3D",text:"3D"}]},{text:"雷达图",code:"Radar",iconCls:"jeicon jeicon-radar-chart",disabled:"0"},{text:"锥形图",code:"Pyramid",iconCls:"jeicon jeicon-cone-chart",disabled:"0"},{text:"仪表盘",code:"AngularGauge",iconCls:"jeicon jeicon-dashboard",disabled:"0"}],function(i){var r=i.text,o={id:i.code,code:i.code,text:i.text,expandable:!0,iconCls:i.iconCls,iconClss:i.iconCls,leaf:"0"==i.disabled,disabled:Ext.value(i.disabled,"1"),children:[]};"Radar"==i.code&&(i.MS=!0),Ext.each(i.children,function(e){var t=Ext.clone(e);Ext.apply(t,{type:r,TD:!1,MS:!1,Stacked:!1,Scroll:!1});var a=t.code;a.replace("MS","")!=a&&(t.MS=!0),a.replace("3D","")!=a&&(t.TD=!0),a.replace("Stacked","")!=a&&(t.Stacked=!0,t.MS=!0),a.replace("Scroll","")!=a&&(t.Scroll=!0),a.replace("DY","")!=a&&(t.DY=!0,t.MS=!0),a.replace("Combi","")!=a&&(t.Combi=!0,t.MS=!0),l.push(t),t.id=t.code,t.leaf=!0,t.iconClss=i.iconCls,o.children.push(t)}),e.push(o)}),e},getChartCfgs:function(e){var t={type:e,TD:!1,MS:!1,Stacked:!1,Scroll:!1};return"Radar"==e&&(t.MS=!0),e.replace("MS","")!=e&&(t.MS=!0),e.replace("3D","")!=e&&(t.TD=!0),e.replace("Stacked","")!=e&&(t.Stacked=!0),e.replace("Scroll","")!=e&&(t.Scroll=!0),e.replace("DY","")!=e&&(t.DY=!0),t},labelClick:function(e){var t=e.split(",")[0],a=e.split(",")[1],i=Ext.getCmp(t);if(i&&i.hasListener("labelclick")){var r=i.store.getById(a),o=r?r.data:{};i.fireEvent("labelclick",i,o,i.chart)}},loadSwf:function(e,t){var a=JE.buildCdnUrl("/static/ux/chart/FusionCharts/"+e+".swf");return t&&(a=JE.buildCdnUrl("/static/ux/chart/FusionCharts/fusionChartsCracker.swf?chartUrl="+a)),a},buildChartFile:function(){}}),Ext.define("JE.util.Common",{requestParams:{},browser:{isFocus:!0,title:"",noticeTitle:"",noticeTitleFn:void 0,focus:function(e){JE.browser.isFocus=!0,document.title=JE.browser.title,JE.browser.noticeTitleFn&&JE.browser.noticeTitleFn.clear()},blur:function(e){JE.browser.isFocus=!1}},currentUser:{},cacheFunc:{},nopermCacheFunc:{},staticCacheFunc:{},systemConfig:{},proConfig:{},helpMsg:{},jsEditor:{},dicListData:{},dicInfoData:{},userStaticData:{MENU:"",FUNC:{},PERM:{}},staticBeanInfo:{KEY_TABLE_CODE:"$TABLE_CODE$",KEY_ROWSET:"$ROWSET$",KEY_PAGE_COUNT:"$P_COUNT$",KEY_ALL_COUNT:"$A_COUNT$",KEY_COLUMNS:"$A_COLUMENS$",KEY_ROW_NUM:"$ROW_NUM$",KEY_SQL:"$SQL$",KEY_SELECT:"$SELECT$",KEY_WHERE:"$WHERE$",KEY_GROUP:"$GROUP$",KEY_ORDER:"$ORDER$",KEY_PK_CODE:"$PK_CODE$",KEY_TABLE_COLUMNS:"$TABLECOLUMNS$",KEY_TABLE_KEYS:"$TABLEKEYS$",KEY_LONG_FIELD:"$LONG$",KEY_DUPCODE:"$DUPCODE$",KEY_DOC_INFO:"$DOC_INFO$",PARAM_IS_DBMAP:"isDBMap",DEF_ALL_FIELDS:"ALL_FIELDS",DEF_PK_FIELDS:"PK_FIELDS",DEF_NPK_FIELDS:"NPK_FIELDS",KEY_VALUE_NULL:"~$￥$~::~￥$￥~",KEY_VALUE_ZERO:"~￥$￥~::~$￥$~"},initTheme:function(){var e=JE.USER,a=[window._JE_SYS_THEME_HEADER||"blue",window._JE_SYS_THEME_LEFTMENU||"black",window._JE_SYS_THEME_TOPMENU||"blue"];if(!Ext.isEmpty(e.theme)){var i=e.theme.split(",");Ext.each(a,function(e,t){a[t]=i[t]||e})}JE.changeTheme(a[0]),JE.changeTheme(a[1],!1,"leftMenu")},initCommon:function(e){var i=this;if(window.onerror=JE.error,JE.requestParams=Ext.urlDecode(window.location.search),Ext.Ajax.on({beforerequest:function(e,t){var a;(new RegExp("[.](js|css|json|html)","g").test(t.url)&&(t.method="GET",t.disableCaching=!1),t.url=JE.buildCdnUrl(JE.getUrlMaps(t.url)||t.url),t.headers=Ext.value(t.headers,{}),t.headers["Platform-Agent"]="AppleWebKit/537.36 (KHTML, like Gecko)",t.headers.authorization=Ext.util.Cookies.get("authorization"),t.headers.cachekey=t.params&&t.params.funcCode||"",JE.isEmpty(t.headers.authorization))?JE.logout(!0):"1"==i.systemConfig.JE_SYS_ENCRYPT&&(t.params?a=JE.DES(t.params):t.isUpload&&(a=JE.DES(t.form)),a&&(t.params||t.isUpload)&&(t.headers[a.code]=a.value))},requestcomplete:function(e,t,a){t.timedout?JE.msg("请求超时！"):JE.systemError(t.responseText)||(Ext.isObject(t.responseText)?"UNKOWN_LOGINUSER"==t.responseText.code&&JE.logout(!0):0==t.responseText.indexOf("\x3c!-- LOGIN --\x3e")||t.responseXML&&t.responseXML.URL&&-1!=t.responseXML.URL.lastIndexOf("/login.jsp")?(t.responseText='{success:false,obj:"logout!"}',JE.logout(!0)):-1!=t.responseText.indexOf('"UNKOWN_LOGINUSER"')&&JE.logout(!0))},requestexception:function(e,t,a){t.timedout?JE.msg("请求超时！"):Ext.isObject(t.responseText)?"UNKOWN_LOGINUSER"==t.responseText.code&&JE.logout(!0):0==t.responseText.indexOf("\x3c!-- LOGIN --\x3e")||t.responseXML&&t.responseXML.URL&&-1!=t.responseXML.URL.lastIndexOf("/login.jsp")?(t.responseText='{success:false,obj:"logout!"}',JE.logout(!0)):-1!=t.responseText.indexOf('"UNKOWN_LOGINUSER"')&&JE.logout(!0)}}),Ext.create("JE.util.VTypes").init(),Ext.create("JE.util.OverrideUtil").init(),JE.loadI18NScript(),JE.ajax({url:"/je/rbac/onLineUser/doLoginLog",params:{loginType:"PC"},async:!0}),JE.systemConfig=JE.ajax({url:JE.getUrlMaps("je.core.sys.config","loadSysVariables")}).obj,document.title=JE.systemConfig.JE_SYS_TITLE,i.USER||(i.currentUser=i.USER=JE.ajax({url:JE.getUrlMaps("je.core.rbac.user","getCurrentUserInfo")})),JE.initJSandCSS(),JE.WebSocket.init(),i.initTheme(),JE.CoreUtil.initUSInfo(),JE.systemConfig._JE_SAAS_CP={},"1"==JE.systemConfig.JE_SYSMODE&&!JE.currentUser.saas){var t=JE.ajax({url:JE.getUrlMaps("je.core.saasYh","loadUseCp")});Ext.each(t,function(e){JE.systemConfig._JE_SAAS_CP[e.JE_SAAS_CP_ID]={id:e.JE_SAAS_CP_ID,name:e.CPYH_CPMC,state:e.CPYH_AZZT_CODE}})}function a(){return"确认退出?"}function r(){return"谢谢光临"}JE.isEmpty(JE.requestParams.funcCode)&&(JE.loadModelFields(JE.systemConfig.JE_SYS_MULTIMODELS),JE.ajax({url:JE.getUrlMaps("je.core.dd.dd","initLoad"),params:{tableCode:"JE_CORE_DICTIONARY",limit:-1},async:!0,success:function(e){var t=Ext.decode(Ext.value(e.responseText,"{}")).rows;Ext.each(t,function(e){JE.dicInfoData[e.DICTIONARY_DDCODE]=e})}})),JE.updateMessageCount(),JE.loadAlertScript(),Ext.create("Ext.util.KeyMap",{target:Ext.getBody(),key:Ext.EventObject.BACKSPACE,fn:function(e,t){var a=t||window.event,i=a.target||a.srcElement,r=i.type||i.getAttribute("type"),o=i.readOnly,l=i.disabled;o=null!=o&&o,l=null==l||l,"password"==r||"text"==r||"textarea"==r?1!=o&&1!=l||t.stopEvent():"true"!=i.contentEditable&&t.stopEvent()}}),"1"===JE.systemConfig.IS_SHOW_LEAVE_TIP&&setTimeout(function(){window.onbeforeunload=a,window.onunload=r},1e3),window.history&&window.history.pushState&&(window.onpopstate=function(){window.history.pushState("forward",null,""),window.history.forward(1)},window.history.pushState("forward",null,""),window.history.forward(1)),JE.browser.title=document.title,window.onfocus=document.onfocusin=JE.browser.focus,window.onblur=document.onfocusout=JE.browser.blur,JE.requestParams.funcCode||(JE.CALENDAR_HOLIDAYS={},JE.ajax({url:JE.getUrlMaps("je.core.load"),params:{tableCode:"JE_SYS_HOLIDAYS",limit:-1},async:!0,success:function(e){var t=Ext.decode(Ext.value(e.responseText,"{}")).rows;Ext.each(t,function(e){if(JE.isNotEmpty(e.HOLIDAYS_YEAR)){var t=e.HOLIDAYS_YEAR,i={};Ext.iterate(Ext.decode(Ext.value(e.HOLIDAYS_INFO,"{}")),function(e,t){var a=[];Ext.each(Ext.decode(Ext.value(t,"[]")),function(e){JE.isNotEmpty(e.value)&&a.push(e.value+"  "+e.code)}),i[e]=a}),JE.CALENDAR_HOLIDAYS[t]=i}})}}),JE.USER.funcConfig&&(JE.ajax({url:JE.getUrlMaps("je.core.load"),params:{tableCode:"JE_CORE_HELPMSG",orderSql:"order by HELPMSG_TYPE",limit:-1},async:!0,success:function(e){var t=Ext.decode(Ext.value(e.responseText,"{}")).rows;Ext.each(t,function(e){i.helpMsg[e.HELPMSG_TYPE]||(i.helpMsg[e.HELPMSG_TYPE]={}),i.helpMsg[e.HELPMSG_TYPE][e.HELPMSG_CODE]=e.HELPMSG_MSG,"otherconfig"==e.HELPMSG_TYPE&&(i.helpMsg.otherconfigData=i.helpMsg.otherconfigData||{},i.helpMsg.otherconfigData[e.HELPMSG_CODE]=Ext.decode(e.HELPMSG_SJ||"[]"))})}}),JE.ajax({url:JE.getUrlMaps("je.core.load"),params:{tableCode:"JE_CORE_VIEWEVENTS",orderSql:"order by VIEWEVENTS_TYPE,SY_ORDERINDEX",limit:-1},async:!0,success:function(e){var t=Ext.decode(Ext.value(e.responseText,"{}")).rows;Ext.each(t,function(e){i.jsEditor[e.VIEWEVENTS_TYPE_CODE]||(i.jsEditor[e.VIEWEVENTS_TYPE_CODE]=[]),i.jsEditor[e.VIEWEVENTS_TYPE_CODE].push({name:e.VIEWEVENTS_NAME,code:e.VIEWEVENTS_CODE,func:e.VIEWEVENTS_FUNC})})}})))}}),Ext.define("JE.util.DataUtil",{modelFields:new Ext.util.MixedCollection,fieldsUrl:JE.getUrlMaps("je.core.doact","getModelFields"),refreshModel:function(e,t){var a=this.getModel(e,!0);t.setFields(this.modelFields.get(a))},getTreeModel:function(e){var t={modelName:"com.je.core.entity.extjs.JSONTreeNode",excludes:"checked"};return 1==e&&delete t.excludes,JE.getModel(t)},getModel:function(e,t){var a=Ext.isEmpty(e.modelName)&&!Ext.isEmpty(e.tableName)?"dynabean."+e.tableName:e.modelName;e.doTree&&(a+="_tree"),Ext.isEmpty(e.excludes)||(a+="_excludes_"+e.excludes);var i=Ext.ModelManager.getModel(a);if(t&&(Ext.ModelManager.unregister(i),i=void 0),!i){var r=(e=Ext.value(e,{})).fields;Ext.isEmpty(r)&&(r=this.getFields(e,t)),Ext.each(r,function(e){-1!=["int","float"].indexOf(e.type)&&(e.useNull=!0)}),a=Ext.value(a,JE.uuid());Ext.define(a,{extend:"Ext.data.Model",idProperty:Ext.value(e.id,"id"),fields:r})}return a},getFields:function(e,t){var a=this,i=Ext.value(e.excludes,"").split(","),r={modelName:Ext.value(e.modelName,""),tableName:Ext.value(e.tableName,""),doTree:Ext.value(e.doTree,!1)},o=r.modelName;if(Ext.isEmpty(r.modelName)&&!Ext.isEmpty(r.tableName)&&(o="dynabean."+r.tableName),o+=r.doTree?"_tree":"",t&&a.modelFields.removeAtKey(o),!a.modelFields.containsKey(o)){var l=JE.ajax({url:a.fieldsUrl,params:r});a.modelFields.add(o,l)}var n=a.modelFields.get(o),s=[];return Ext.isEmpty(i)?s=n:Ext.each(n,function(e){-1==i.indexOf(e.name)&&s.push(e)}),s},loadModelFields:function(e){if(!JE.isEmpty(e)){Ext.isString(e)&&(e=e.split(","));var a=this,t=[];Ext.each(e,function(e){!JE.isNotEmpty(e)||a.modelFields.containsKey(e)||a.modelFields.containsKey("dynabean."+e)||(2<JE.split(e,".").length?t.push({modelName:e,tableName:"",doTree:!1}):t.push({modelName:"",tableName:e,doTree:!1}))}),JE.isEmpty(t)||JE.ajax({url:JE.getUrlMaps("je.core.doact","loadMultiModels"),params:{strData:JE.toStr(t)},async:!0,success:function(e){var t=Ext.decode(Ext.value(e.responseText,"{}"));Ext.iterate(t,function(e,t){a.modelFields.containsKey(e)||a.modelFields.add(e,t)})}})}},getStore:function(e){var t=Ext.value(e.params,{});if("tree"==e.type)return t=Ext.apply({tableCode:e.tableName,excludes:1!=e.multi?"checked":""},t),Ext.create("Ext.data.TreeStore",{defaultRootId:"ROOT",sorters:[{property:"SY_ORDERINDEX",direction:"ASC"}],model:JE.getTreeModel(e.multi),proxy:{type:"ajax",method:"POST",actionMethods:{create:"POST",read:"POST",update:"POST",destroy:"POST"},extraParams:t,url:Ext.value(e.url,JE.getUrlMaps("je.core.getTree")),reader:"json"},autoLoad:e.autoLoad});t=Ext.apply({tableCode:e.tableName},t);var a=Ext.value(e.action,JE.getUrlMaps("je.core")),i=JE.getActionUrls(a);return Ext.create("Ext.data.Store",{pageSize:Ext.value(e.pageSize,30),remoteSort:!0,actUrls:i,autoLoad:e.autoLoad,sqls:Ext.value(e.sqls,{}),model:JE.getModel({fields:e.fields,doTree:e.doTree,id:e.id,tableName:e.tableName,entityName:e.entityName,excludes:e.excludes}),proxy:{type:"ajax",method:"POST",async:Ext.value(e.async,!0),url:Ext.value(e.url,i.load),actionMethods:{create:"POST",read:"POST",update:"POST",destroy:"POST"},extraParams:t,reader:{type:"json",root:"rows",totalProperty:"totalCount"},writer:{type:"json"}}})},summaryType:function(e,t,a){var i={};return this.gridObj&&(i=this.gridObj.getColumn(t)),JE.getSummary(this,e,t,a,i)},getSummary:function(e,t,a,i,r,o){o=o||r.summary;var l="";if(1==i)return l=JE.getAllSummary({tableCode:e.proxy.extraParams.tableCode,whereSql:e.proxy.extraParams.whereSql,type:o,field:a});switch(o){case"count":return t.length;case"min":return e.getMin(t,a);case"max":return e.getMax(t,a);case"sum":return e.getSum(t,a);case"average":return e.getAverage(t,a);case"msg":case"zdy":return l}},getPageSummary:function(e,t){switch(e=Ext.value(e,[]),t){case"count":return e.length;case"min":return Ext.Array.min(e);case"max":return Ext.Array.max(e);case"sum":return Ext.Array.sum(e);case"average":var a=0<e.length?e.length:1;return Ext.Array.sum(e)/a}return""},getAllSummary:function(a,e){var i=[],r=[],o={};return Ext.each(a.types,function(e,t){-1!=["count","min","max","sum","average"].indexOf(e)&&(e="average"==e?"avg":e,i.push(e),r.push(a.fields[t]))}),0<r.length&&(a.types=i.join(","),a.fields=r.join(","),o=JE.ajax({url:JE.getUrlMaps("je.core.develop.funcInfo","doSummary"),params:a}),Ext.iterate(o,function(e,t){o[e]=JE.isEmpty(t)?0:t})),o}}),Ext.define("JE.util.DateUtil",{parseDateTime:function(e){return Ext.Date.parse(e,"Y-m-d H:i:s")},parseDate:function(e,t){var a="Y-m-d";return Ext.isEmpty(t)||(a=t),Ext.Date.parse(e,a)},formatDateTime:function(e){return Ext.Date.format(e,"Y-m-d H:i:s")},formatDate:function(e,t){var a="Y-m-d";return Ext.isEmpty(t)||(a=t),Ext.Date.format(e,a)},getBetweenArray:function(e,t,a,i,r){var o=this,l=1;i&&(l=1*i);var n=new Array;"0"==e&&(e=new Date);var s=o.parseDateTime(o.getDate(Ext.Date.clone(e),t)),c=s,d=e;for(s.getTime()>e.getTime()&&(c=e,d=s);c.getTime()<=d.getTime();)switch(a){case"y":n.push(o.formatDate(c,Ext.value(r,"Y"))),c.setYear(c.getYear()+l);break;case"m":n.push(o.formatDate(c,Ext.value(r,"Y-m"))),c.setMonth(c.getMonth()+l);break;case"w":n.push(o.formatDate(c,Ext.value(r,"Y-m-d"))),c.setDate(c.getDate()+7*l);break;case"d":n.push(o.formatDate(c,Ext.value(r,"Y-m-d"))),c.setDate(c.getDate()+l);break;case"h":n.push(o.formatDate(c,Ext.value(r,"Y-m-d H"))),c.setHours(c.getHours()+l);break;case"i":n.push(o.formatDate(c,Ext.value(r,"Y-m-d H:i"))),c.setMinutes(c.getMinutes()+l);break;case"s":n.push(o.formatDate(c,Ext.value(r,"Y-m-d H:i:s"))),c.setSeconds(c.getSeconds()+l)}return n},getBetweenArrayByDate:function(e,t,a,i,r,o){var l=this,n=1;r&&(n=1*r);var s=e,c=t;o="Y-m-d H:i:s";"date"==i?o="Y-m-d":"datemonth"==i&&(o="Y-m"),"string"==Ext.typeOf(e)&&(s=l.parseDate(e,o)),"string"==Ext.typeOf(t)&&(c=l.parseDate(t,o));var d=new Array,u=c,E=s;for(c.getTime()>s.getTime()&&(u=s,E=c);u.getTime()<=E.getTime();)switch(a){case"y":d.push(l.formatDate(u,Ext.value(o,"Y"))),u.setYear(u.getYear()+n);break;case"m":d.push(l.formatDate(u,Ext.value(o,"Y-m"))),u.setMonth(u.getMonth()+n);break;case"w":d.push(l.formatDate(u,Ext.value(o,"Y-m-d"))),u.setDate(u.getDate()+7*n);break;case"d":d.push(l.formatDate(u,Ext.value(o,"Y-m-d"))),u.setDate(u.getDate()+n);break;case"h":d.push(l.formatDate(u,Ext.value(o,"Y-m-d H"))),u.setHours(u.getHours()+n);break;case"i":d.push(l.formatDate(u,Ext.value(o,"Y-m-d H:i"))),u.setMinutes(u.getMinutes()+n);break;case"s":d.push(l.formatDate(u,Ext.value(o,"Y-m-d H:i:s"))),u.setSeconds(u.getSeconds()+n)}return d},getDate:function(a,e,t){"0"==a&&(a=new Date);var i="Y-m-d H:i:s";return"date"==t?i="Y-m-d":"datemonth"==t&&(i="Y-m"),Ext.each(e.split(","),function(e){var t=1*e.substring(0,e.length-1);switch(e.substring(e.length-1)){case"y":a.setYear(a.getYear()+t);break;case"m":a.setMonth(a.getMonth()+t);break;case"w":a.setDate(a.getDate()+7*t);break;case"d":a.setDate(a.getDate()+t);break;case"h":a.setHours(a.getHours()+t);break;case"i":a.setMinutes(a.getMinutes()+t);break;case"s":a.setSeconds(a.getSeconds()+t)}}),this.formatDate(a,i)},getWeekInfoOfMonth:function(e,t){var a=new Date;(a=Ext.Date.clearTime(a)).setDate(1),a.setYear(e),a.setMonth(t-1);var i=Ext.Date.getLastDateOfMonth(a);i=Ext.Date.clearTime(i);var r=new Array;for(a.setDate(a.getDate()-1);a.getTime()<i.getTime();){a.setDate(a.getDate()+1);var o={date:a.getDate()};switch(a.getDay()){case 0:o.week="日";break;case 1:o.week="一";break;case 2:o.week="二";break;case 3:o.week="三";break;case 4:o.week="四";break;case 5:o.week="五";break;case 6:o.week="六"}r.push(o)}return r},getWeekDates:function(e){var t=new Date;t=Ext.Date.clearTime(t);var a=null;a=Ext.isEmpty(e)?Ext.Date.getWeekOfYear(t):e;var i=Ext.Date.getWeekOfYear(t);t.setDate(t.getDate()+7*(a-i));for(var r=t.getDay(),o=[],l=1;l<=7;l++){var n=Ext.Date.clone(t);n.setDate(n.getDate()-(r-l)),o.push(this.formatDate(n))}return o},humanityDate:function(e){if(!e)return null;var t=new Date,a=Ext.Date.getDayOfYear(t),i=Ext.Date.getWeekOfYear(t),r=t.getMonth()+1,o=Ext.Date.getDayOfYear(e),l=Ext.Date.getWeekOfYear(e),n=e.getMonth()+1,s=JE.DATE.formatDate(e,"H:i"),c=JE.DATE.formatDate(e,"j日H:i"),d=JE.DATE.formatDate(e,"D H:i"),u=JE.DATE.formatDate(e,"Y/m/d");return a-o==0?s:a-o==1?"昨天"+s:l==i?d:n==r?"本月"+c:u},diffDays:function(e,t){var a=Ext.Date.clearTime,i=a(t,!0).getTime()-a(e,!0).getTime();return Math.ceil(i/864e5)},copyTime:function(e,t){var a=Ext.Date.clone(t);return a.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),a},compare:function(e,t,a){return!0!==a&&((e=Ext.Date.clone(e)).setMilliseconds(0),(t=Ext.Date.clone(t)).setMilliseconds(0)),t.getTime()-e.getTime()},isMidnight:function(e){return 0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()},isMidnight:function(e){return 0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()},maxOrMin:function(e){for(var t=e?0:Number.MAX_VALUE,a=0,i=arguments[1],r=i.length;a<r;a++)t=Math[e?"max":"min"](t,i[a].getTime());return new Date(t)},max:function(){return this.maxOrMin.apply(this,[!0,arguments])},min:function(){return this.maxOrMin.apply(this,[!1,arguments])},today:function(){return Ext.Date.clearTime(new Date)},add:function(e,t){if(!t)return e;var a=Ext.Date,i=a.add,r=a.clone(e);return t.years&&(r=i(r,a.YEAR,t.years)),t.months&&(r=i(r,a.MONTH,t.months)),t.weeks&&(t.days=(t.days||0)+7*t.weeks),t.days&&(r=i(r,a.DAY,t.days)),t.hours&&(r=i(r,a.HOUR,t.hours)),t.minutes&&(r=i(r,a.MINUTE,t.minutes)),t.seconds&&(r=i(r,a.SECOND,t.seconds)),t.millis&&(r=i(r,a.MILLI,t.millis)),t.clearTime?a.clearTime(r):r}}),Ext.define("JE.util.DevelopUtil",{singleton:!0}),Ext.define("JE.util.DwrMsgUtil",{showMsg:function(e){var t=JE.toObj(e)||{},a=t.context;Ext.isEmpty(t.showConfig)||(a=new Ext.XTemplate(t.showConfig).apply(t));JE.notice(a,t.title),t.wsConfig&&JE.sendWsSysMsg(t.wsConfig),t.login||window.jsCallback||JE.desktopNotice(t.title,JE.local.lang.core.util.DwrMsgUtil.noticeTitle)},showBatchMsg:function(e){var t=JE.toObj(e)||{},a=(t.totalCount,""),i=null,r=!1;Ext.each(t.rows,function(e){var t=e.context;i=e.title,Ext.isEmpty(e.showConfig)||(t=new Ext.XTemplate(e.showConfig).apply(e));a+=t+="<br/><br/><hr/>",r=e.login});var o={type:"msg",beanId:"",msg:a,title:i,see:"1",msgId:"",read:"0"};JE.sendWsSysMsg(o),JE.notice(a,i),r||window.jsCallback||JE.desktopNotice(i,JE.local.lang.core.util.DwrMsgUtil.noticeTitle)},showWfBatchMsg:function(e){var t=JE.toObj(e)||{},a=t.totalCount,i=JE.getLocalLang("core.util.DwrMsgUtil");if(1<a){var r=new Array,o=!1;Ext.each(t.rows,function(e){r.push(e.bean.SY_PIID),o=e.login}),window._crm_home_showworkflow?JE.notice(JE.format(i.taskNotice,a)+'<a href="javascript:void(0)" onclick="_crm_home_showworkflow();">'+i.taskNoticeDo+"</a>",i.taskNoticeTitle):JE.notice(JE.format(i.taskNotice,a)+'<a href="javascript:void(0)" onclick="JE.showIddt(\''+i.funcTitle+"','JE.sys.workflowfunc.controller.WorkflowFuncCtr','workflowfunc.mainview',{piids:'"+r.join(",")+"'});\">"+i.taskNoticeDo+"</a>",i.taskNoticeTitle,0);var l={type:"batchwf",beanId:r.join(","),msg:JE.format(i.taskNotice,a),title:i.taskNoticeTitle,see:"1",msgId:"",read:"0"};JE.sendWsSysMsg(l),o||window.jsCallback||JE.desktopNotice(JE.format(i.taskNoLoginNotice,a),i.taskNoLoginNoticeTitle)}else{var n=t.rows[0],s=n.context;if(!Ext.isEmpty(n.showConfig))s=new Ext.XTemplate(n.showConfig).apply(n);JE.notice(s,n.title),n.wsConfig&&JE.sendWsSysMsg(n.wsConfig),n.login||window.jsCallback||JE.desktopNotice(n.title,i.taskNoLoginNoticeTitle)}},refreshCurrentInfo:function(e){var t=JE.toObj(e)||{},a=JE.toObj(t.context)||{},i=Ext.getCmp("_jewestview");i&&i.refreshUserInfo(a),JE.isNotEmpty(JE.systemConfig.SYS_WF)&&JE.loadBadge(JE.systemConfig.SYS_WF)},doPushInfo:function(e){var t=JE.toObj(e)||{},a=JE.toObj(Ext.value(t.context,"[]"));window._crm_home_refreshBadge&&window._crm_home_refreshBadge(a),Ext.each(a,function(e){if("WF"==e.type){if(e.num)e.numObj;e.refresh}else"MSG"==e.type||"POSTIL"==e.type||"CALENDAR"==e.type||"BUBBLE"==e.type||"TRANSACTION"==e.type||e.type})},updateMessageCount:function(e){JE.defer(function(){if(Ext.get("___userMsg")){var e=JE.ajax({url:JE.getUrlMaps("je.core.load"),params:{tableCode:"JE_SYS_USERMSG",whereSql:" AND USERMSG_JSR_ID='"+JE.currentUser.userId+"' AND USERMSG_YD='0' ",orderSql:"",queryFields:"JE_SYS_USERMSG_ID",limit:-1}}),t=e&&e.rows?e.rows:JE.error("数据获取失败！"),a=Ext.value(t,[]).length;return Ext.get("___userMsg").dom.innerHTML=a,!1}},10)},refreshUpgradeInfo:function(e){var t=(JE.toObj(e)||{}).context,a=Ext.getCmp("jeupgradewindow");a&&a.down("displayfield[name=upgradeInfo]").setValue(t)},updateUpgradeProcess:function(e){var t=JE.toObj(e)||{},a=Ext.getCmp("_upgradeprocesswin"),i=t.title,r=JE.toObj(t.context)||{},o=r.count,l=r.index;if(a?a.show():a=JE.win({title:"升级进度",useButton:!1,id:"_upgradeprocesswin",autoShow:!0,width:480,height:130,maximizable:!1,closable:!0,layout:"column",items:[{columnWidth:1,height:40,name:"msg",padding:"1 5 1 5",xtype:"displayfield"},{columnWidth:1,name:"process",hideTrigger:!0,xtype:"barfield",padding:"1 5 1 5",configInfo:",1-99~orange,100-100~green"}]}),"start"==i)msg="开始升级，共"+o+"个升级包...",a.down("displayfield[name=msg]").setValue(msg),a.down("barfield[name=process]").setValue(1*Ext.Number.toFixed(100*Ext.Number.toFixed(l/o,2),0));else if("run"==i){var n="下载";"upgrade"==r.type&&(n="升级"),msg="正在"+n+"第"+l+"个升级包...",a.down("displayfield[name=msg]").setValue(msg),a.down("barfield[name=process]").setValue(1*Ext.Number.toFixed(100*Ext.Number.toFixed(l/o,2),0))}else"end"==i&&a.close()},showExpressMsg:function(e){},uploadAppProcess:function(e){var t="__appuploadwin",a=Ext.getCmp(t),i=JE.toObj(e)||{};a?a.body.dom.innerHTML+=i.context:JE.win({id:t,bodyPadding:10,title:"APP升级",width:300,height:500,autoScroll:!0,autoShow:!0,showFn:function(e){e.body.dom.innerHTML+=i.context}})},updateClusterFileSyncProcess:function(e){var t=JE.toObj(e)||{},a=Ext.getCmp("_upgradeClusterFileSyncWin"),i=t.title,r=JE.toObj(t.context)||{},o=r.sourceIp,l=r.targetIp;r.sourceDir,r.targetDir,r.syncMsg,r.count,r.index;a?a.show():a=JE.win({title:"集群文件同步进度",useButton:!1,id:"_upgradeClusterFileSyncWin",autoShow:!0,width:800,height:300,maximizable:!1,closable:!0,layout:"column",items:[{columnWidth:1,height:40,name:"msg",padding:"1 5 1 5",xtype:"displayfield"}]}),"start"==i&&(msg="开始从服务器"+o+"同步文件/目录到服务器"+l+"...",a.down("displayfield[name=msg]").setValue(msg))},refreshClusterFileSyncProcess:function(e){var t=(JE.toObj(e)||{}).context,a=Ext.getCmp("_upgradeClusterFileSyncWin");if(a){var i=a.down("displayfield[name=msg]");t=i.getValue()+"<br/>"+t,i.setValue(t)}},doWsMsg:function(e,t){if("see"==e){if("wf"==t.type){var a=t.funcCode,i=t.beanId;if(JE.isNotEmpty(i)&&JE.isNotEmpty(a)){var r=JE.getFuncView(a,"form");if(r){var o=r.up("window");o&&o.close()}JE.showFunc(a,{info:{useWFLog:!0},id:i,useChild:!0,readOnly:!1,type:"form"})}}else if("batchwf"==t.type){var l=JE.getLocalLang("core.util.DwrMsgUtil");JE.showIddt(l.funcTitle,"JE.sys.workflowfunc.controller.WorkflowFuncCtr","workflowfunc.mainview",{piids:t.beanId})}}else if("read"==e){var n=t.msgId;if(JE.isNotEmpty(n))JE.ajax({url:JE.getUrlMaps("je.core.update"),params:{tableCode:"JE_SYS_USERMSG",JE_SYS_USERMSG_ID:n,USERMSG_YD:"1"}}).success&&JE.updateMessageCount()}},sendWsSysMsg:function(e){var t=JE.toStr(e)||{};try{jsCallback.showMsg(t)}catch(e){}},sendWsMsg:function(e,t,a){var i={};i.type=e,i.id=t,i.msgContent=a,i=JE.toStr(i);try{jsCallback.showMsg(i)}catch(e){}}}),Ext.define("JE.util.OpenFileUtil",{doAct:function(e,t,a){var i={},r="",o={},l={};if(Ext.isObject(t)){r=(i=t).funcCode;var n=JE.getFuncData(r).basicFields[i.field],s=i.beanId;o=JE.toObj(n.otherConfig);var c=JE.getFuncView(r,"grid");c&&(l=c.store.getById(s).data)}else{if(!(n=Ext.getCmp(t))||Ext.isEmpty(n.baseFile.path))return;jQuery.powerTip.hide(n.inputEl.dom),i=n.baseFile,r=n.funcCode,l=n.up("form").getValues(),o=n.otherConfig}var d=i.name,u=i.path,E={filePath:i.path,editable:"0",history:"0",qianzhang:"0",taohong:"0"};if(JE.isNotEmpty(o)){var p=Ext.decode(o.pageOfficeData);p&&(E=Ext.apply({filePath:i.path,editable:p.editable,history:p.history}),["taohong","qianzhang"].forEach(function(t){if(JE.isNotEmpty(p[t]))if("role"==p[t].type){var e=JE.USER.roleCodes.split(","),a=p[t].config.code.split(",");e.forEach(function(e){-1!=a.indexOf(e)&&("taohong"===t?E.taohong="1":"qianzhang"===t&&(E.qianzhang="1"))})}else if("field"==p[t].type){var i=p[t].config.field;l[i]==JE.USER.userId&&("taohong"===t?E.taohong="1":"qianzhang"===t&&(E.qianzhang="1"))}else if("self"==p[t].type){l.SY_CREATEUSERID==JE.USER.userId&&("taohong"===t?E.taohong="1":"qianzhang"===t&&(E.qianzhang="1"))}}))}if(JE.File.checkFilePerm&&0==JE.File.checkFilePerm(e,[i],r))return;if("download"==e)if(0==u.indexOf("http://"))window.open(u);else{var f=JE.getUrlMaps("je.core.doc.document","download"),m="";JE.isNotEmpty(a)&&(m="&beanTableCode="+a);var g=f+"?ieFlag="+(Ext.isIE?"1":"0")+"&enCode=1&fileName="+encodeURIComponent(d)+m+"&path="+u;window.open(g)}else if("preview"==e){var h=JE.systemConfig.JE_SYS_DOCFILETYPE,x=Ext.decode(h),y=u.lastIndexOf(".")+1,v=u.substring(y,u.length).toLowerCase();for(var b in x)if(-1!=$.inArray(v,x[b].value.split(","))){if("office"==x[b].code||"pdf"==x[b].code){if("1"!=JE.systemConfig.JE_SYS_PAGEOFFICE)return JE.alert("未启动pageoffice插件!"),!1;JE.File.office(E)}else JE.File.openFileByPath(u,d,!0,null,null,"","",a);break}}else"savedoc"==e&&JE.File.addDocFiles(u,d)},openFileByExtension:function(e,t,a,i){var r=e.get("DOCUMENTATION_ADDRESS"),o=e.get("DOCUMENTATION_TEXT"),l=e.get("JE_SYS_DOCUMENTATION_ID");this.openFileByPath(r,o,t,a,{},i,l)},openFileByPath:function(o,e,t,a,i,l,r,n){var s,c=JE.getLocalLang("core.util.OpenFileUtil"),d=JE.systemConfig.JE_SYS_DOCFILETYPE,u=Ext.decode(d),E=o.lastIndexOf(".")+1,p=o.substring(E,o.length).toLowerCase();for(var f in s=0==o.indexOf("http://")||0==o.indexOf("https://")?o:JE.getFileUrl(o,null,l,r,n),u)if(-1!=$.inArray(p,u[f].value.split(","))){var m,g;if("picture"==u[f].code){JE.loadScript(["/static/ux/Picasa/Picasa.js","/static/ux/Picasa/Picasa.css"]);var h=new Picasa,x=[],y=0,v=0;return a&&0<a.length?Ext.Array.each(a,function(e){var t=e.path,a=JE.getFileUrl(t,null,l,e.id,n);a=0==t.indexOf("http://")||0==t.indexOf("https://")?t:JE.getFileUrl(t,null,l,e.id,n);var i=e.name,r=t.split(".").pop();Ext.Array.contains(["jpg","jpeg","png","bmp","gif"],r)&&(t==o&&(y=v),x.push($("<div filetype='jpg' name='"+i+"' picasa='"+a+"' thumb='"+a+"' PicasaNo='"+v+++"'>")[0]))}):x.push($("<div filetype='jpg' name='"+e+"' picasa='"+s+"' thumb='"+s+"' PicasaNo='0'>")[0]),h.init(x),h.initData(),void setTimeout(function(){h.display(x[y])},200)}if("flash"==u[f].code)g={width:"50%",height:"50%",maximized:!0,html:m='<embed src="'+s+'" type="application/x-shockwave-flash" allowscriptaccess="always" wmode="opaque" width="100%" height="100%"></embed>'};else if("audio"==u[f].code){JE.loadScript("/static/ux/cmpplayer/cmp.js");var b={name:c.audio,src:s,type:p};g={width:590,height:410,html:m=CMP.create("cmp","100%","100%",JE.getStaticUrl("JE.common.file.cmp","swf"),b)}}else if("video"==u[f].code){JE.loadScript("/static/ux/cmpplayer/cmp.js");b={name:c.video,src:s,type:p};g={width:590,height:410,html:m=CMP.create("cmp","100%","100%",JE.getStaticUrl("JE.common.file.cmp","swf"),b)}}else if("video5"==u[f].code)g={width:380,height:410,html:m='<video src="'+s+'" width="100%" height="100%" autoplay="autoplay" controls="controls" preload="preload"></video>'};else if("pdf"==u[f].code)g={width:"50%",height:"50%",maximized:!0,html:m='<object data="'+s+'" type="application/pdf" width="100%" height="100%"></object>'};else if("html"==u[f].code)g={width:"50%",height:"50%",maximized:!0,html:m='<iframe width="100%" height="100%" src="'+s+'"/>'};else if("office"==u[f].code){if(0==o.indexOf("http://"))window.open(o);else{var C=JE.getUrlMaps("je.core.doc.document","download"),w="";JE.isNotEmpty(n)&&(w="&beanTableCode="+n);var J=C+"?ieFlag="+(Ext.isIE?"1":"0")+"&enCode=1&fileName="+encodeURIComponent(e)+w+"&path="+o;window.open(J)}return}else if("cad"==u[f].code)m='<object id = "viewer"',m+='classid   =   "clsid:A662DA7E-CCB7-4743-B71A-D817F6D575DF"',m+='CODEBASE="http://www.autodesk.com/global/expressviewer/installer/ExpressViewerSetup.cab"',m+=' width="100%" height="100%" border="2">',g={width:"50%",height:"50%",maximized:!0,html:m+='<param name = "Src" value= "'+s+'"></object>'};else if("txt"==u[f].code){if(m=JE.ajax({url:JE.getUrlMaps("je.core.doc.fileview","loadFileData"),params:{path:o,type:l,pkValue:r,beanTableCode:n}}).obj.data,g={width:"50%",height:"50%",overflowY:"hidden"},t)g.html='<textarea style="width:100%;height:100%;" readonly>'+m+"</textarea>";else{var S=Ext.create("JE.core.view.CodeEditor",{value:m,saveFn:function(e){var t=JE.ajax({url:JE.getUrlMaps("je.core.doc.fileview","saveFile"),params:{path:o,fileContent:e}});t.success?JE.msg(t.obj):JE.alert(t.obj)},useHelp:!1});g.items=[S]}}else if("eml"==u[f].code){var T;if((T=JE.ajax({url:JE.getUrlMaps("je.core.doc.fileview","loadEmlData"),params:{path:o,beanTableCode:n}})).success)return JE.initCtr("JE.sys.email.controller.EmailMainCtr"),void Ext.create("JE.sys.email.util.Util").editEmail({},"read",{title:c.email,data:T.obj,email:{}});JE.alert(T.obj)}return g=Ext.applyIf({title:c.openFileByPathTitle,resizable:!0,modal:!0,layout:"fit",maximizable:!0,autoScroll:!0,bodyStyle:"background-color:#ffffff;"},g),void Ext.create("Ext.window.Window",g).show()}JE.msg("该格式暂不支持...")},office:function(e){var t=e.filePath.substring(e.filePath.lastIndexOf("."),e.filePath.length);".xls"!=(t=t.toLowerCase())&&".xlsx"!=t||(e.history="0",e.taohong="0",e.qianzhang="0",e.editable="0");var a={userName:JE.currentUser.username,userId:JE.currentUser.userId,path:e.filePath,jeFileType:"",jeFileSaveType:"",history:e.history||"0",taohong:e.taohong||"0",qianzhang:e.qianzhang||"0",readOnly:("1"===e.editable?"0":"1")||"1"},i=JE.ajax({url:"/je/doc/document/openPageOffice",params:{path:e.filePath}});i.success&&(a.jeFileType=i.obj.jeFileType,a.jeFileSaveType=i.obj.jeFileSaveType),POBrowser.openWindowModeless("static/ux/pageoffice/pageoffice.html?t="+(new Date).getTime(),"width=1200px;height=900px;",JSON.stringify(a))},addDocBatchFiles:function(r){var o=JE.getLocalLang("core.util.OpenFileUtil");JE.selectWin({parent:null,parentType:"self",title:o.addDocBatchFilesTitle,configInfo:"JE_SYS_DOCUMENTATION",whereSql:" AND SY_CREATEUSER='"+JE.currentUser.userCode+"' AND DOCUMENTATION_FILEMODE='USER'",type:"tree",treeConfig:{rootVisible:!0,listeners:{afterrender:function(e){var t=e.getRootNode();t.set("text",o.rootText),t.set("iconCls","jeicon jeicon-folders"),t.commit()}}},callback:function(e,t){if(e){if(!e[0])return JE.alert(o.moveFolder),!1;var a=e[0],i=JE.ajax({url:JE.getUrlMaps("je.core.doc.documentation","doSaveFile"),params:{strData:JE.toStr(r),tableCode:"JE_SYS_DOCUMENTATION",DOCUMENTATION_FILEMODE:"USER",SY_PATH:a.getPath(),SY_LAYER:a.get("layer")+1,SY_PARENT:a.get("id"),SY_NODETYPE:"LEAF",DOCUMENTATION_FILEMODE:"USER"}});if(!i.success)return JE.alert(i.obj),!1;JE.msg(i.obj)}}})},addDocFiles:function(e,t){this.addDocBatchFiles([{name:t,path:e}])},downloadFile:function(e,t,a){var i=JE.ajax({url:JE.getUrlMaps("je.core.getInfoById"),params:{tableCode:e,pkValue:t}});if(0!=i.success){var r=i[a];if(JE.isNotEmpty(r)){var o=r.split("*"),l=JE.getUrlMaps("je.core.doc.document","downloadUrl");window.open(l+"?ieFlag="+(Ext.isIE?"1":"0")+"&enCode=1&fileName="+encodeURIComponent(o[0])+"&path="+o[1])}else JE.alert("未找到附件信息!")}else JE.alert("未找到数据!")}}),Ext.define("JE.util.OverrideUtil",{obj:{"Ext.form.field.Text":{getErrors:function(e){var t=this.callParent(arguments);return JE.isEmpty(t)&&!this.allowBlank&&(JE.isEmpty(e)||Ext.isString(e)&&JE.isEmpty(e.trim()))&&t.push(this.blankText),t}},"Ext.Loader":{getPath:function(e){var t="",a=(e=e.trim()).split("?")[0].split("."),i=a[a.length-1].toLocaleLowerCase();if(-1!=["js","css"].indexOf(i))t=e;else{var r="",o=this.config.paths,l=this.getPrefix(e);if(0<l.length){if(l===e)return o[l];r=o[l],e=e.substring(l.length+1)}0<r.length&&(-1!=["JE","PRO"].indexOf(r)&&(r="/"+r),r+="/"),t=r.replace(/\/\.\//g,"/")+e.replace(/\./g,"/")+".js"}return t=JE.buildCdnUrl(t)},injectScriptElement:function(e,t,a,i,r){function o(){s||(s=!0,n.onload=n.onreadystatechange=n.onerror=null,"number"==typeof c.scriptChainDelay?defer(t,c.scriptChainDelay,i):t.call(i),l.cleanupScriptElement(n,!1===c.preserveScripts,c.garbageCollect))}var l=this,n=document.createElement("script"),s=!1,c=l.config;return n.type="text/javascript",n.onerror=function(e){defer(a,1,i),l.cleanupScriptElement(n,!1===c.preserveScripts,c.garbageCollect)},(r=r||c.scriptCharset)&&(n.charset=r),"addEventListener"in n?n.onload=o:"readyState"in n?n.onreadystatechange=function(){"loaded"!=this.readyState&&"complete"!=this.readyState||o()}:n.onload=o,-1!=e.indexOf(".css")?((n=document.createElement("link")).rel="stylesheet",n.href=e):n.src=e,(l.documentHead||document.getElementsByTagName("head")[0]).appendChild(n),n},loadScriptFile:function(e,t,a,i,r){var o=this;if(o.isFileLoaded[e])return o;var l,n,s,c=o.getConfig(),d=e+(c.disableCaching?"?"+c.disableCachingParam+"="+Ext.Date.now():""),u=!1,E="",p=JE.getOnlineInfo("cdn"),f=JE.getOnlineInfo("hash_map");if((p&&0==e.indexOf(p)||f)&&(d=e),i=i||o,o.isLoading=!0,r){l="undefined"!=typeof XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");try{l.open("GET",d,!1),l.send(null)}catch(e){u=!0}if(n=1223===l.status?204:0!==l.status||"file:"!=(self.location||{}).protocol&&"ionp:"!=(self.location||{}).protocol?l.status:200,(u=u||0===n)&&!isPhantomJS)a.call(o,"Failed loading synchronously via XHR: '"+e+"'; It's likely that the file is either being loaded from a different domain or from the local file system whereby cross origin requests are not allowed due to security reasons. Use asynchronous loading with Ext.require instead.",r);else if(200<=n&&n<300||304===n||isPhantomJS){Ext.isIE||(E="\n//@ sourceURL="+e);var m=o.documentHead||document.getElementsByTagName("head")[0],g=l.responseText+E;if(-1!=e.indexOf(".css"))Ext.util.CSS.createStyleSheet(g,e);else{var h=document.createElement("script");h.language="javascript",h.type="text/javascript",h.defer=!0,h.id=e,h.text=g,m.appendChild(h)}t.call(i)}else a.call(o,"Failed loading synchronously via XHR: '"+e+"'; please verify that the file exists. XHR status code: "+n,r);l=null}else s=function(){a.call(i,"Failed loading '"+e+"', please verify that the file exists",r)},o.scriptElements[e]=o.injectScriptElement(d,t,s,i)}},"Ext.selection.DataViewModel":{onItemClick:function(e,t,a,i,r){if(JE.isNotEmpty(e.itemTargetSelector)&&r&&!r.getTarget(e.itemTargetSelector,3))return;this.selectWithEvent(t,r||{})}},"Ext.form.field.Base":{afterRender:function(){var a=this;a.callParent(arguments),a.inputEl&&a.inputEl.on("focus",function(e,t){a.readOnly&&(t.readOnly=a.readOnly)})}},"Ext.form.field.Display":{getDisplayValue:function(){var e=this.callParent(arguments);return JE.isEmpty(e)&&(e="&nbsp;"),e}},"Ext.layout.container.Card":{setActiveItem:function(e){var t=this.owner,a=this.activeItem;this.callParent(arguments)&&t.fireEvent("activechange",t,e,a)}},"Ext.layout.container.Box":{calculateParallel:function(e,t,a){var i=this.callParent(arguments);if("plus"==JE.getTheme()&&"hbox"==this.type){for(var r=e.childItems,o=r.length,l=-1,n=o-1;0<=n;n--){if("tbfill"==this.owner.items.get(n).xtype){l=n;break}}if(-1<l)for(n=l+1;n<o;n++){childContext=r[n];var s=JE.toNum(childContext.getProp(t.x))+2;childContext.setProp(t.x,s)}}return i}},"Ext.view.BoundList":{renderTpl:["{%","var me=values.$comp, headerToolbar=me.headerToolbar;","if (headerToolbar) {","headerToolbar.ownerLayout = me.componentLayout;","Ext.DomHelper.generateMarkup(headerToolbar.getRenderTree(), out);","}","%}",'<div id="{id}-listEl" class="{baseCls}-list-ct ',Ext.dom.Element.unselectableCls,'" style="overflow:auto"></div>',"{%","var me=values.$comp, pagingToolbar=me.pagingToolbar;","if (pagingToolbar) {","pagingToolbar.ownerLayout = me.componentLayout;","Ext.DomHelper.generateMarkup(pagingToolbar.getRenderTree(), out);","}","%}",{disableFormats:!0}],initComponent:function(){this.headerTpl&&(this.headerToolbar=this.createHeaderToolbar()),this.callParent(arguments)},createHeaderToolbar:function(){return Ext.widget("box",{id:this.id+"-header-toolbar",cls:"x-boundlist-header",ownerCt:this,ownerLayout:this.getComponentLayout(),html:this.headerTpl,height:this.headerHeight||30})},createPagingToolbar:function(){return Ext.widget("uxpagingtoolbar",{id:this.id+"-paging-toolbar",pageSize:this.pageSize,store:this.store,border:!1,ownerCt:this,useTheme:!0,displayInfo:!1,height:this.pageHeight||30,ownerLayout:this.getComponentLayout()})},getRefItems:function(){var e=this.callParent(arguments);return this.headerToolbar&&e.push(this.headerToolbar),e},finishRenderChildren:function(){this.callParent(arguments),this.headerToolbar&&this.headerToolbar.finishRender()},refresh:function(){var e=this;e.callParent(arguments);var t=e.headerToolbar;e.rendered&&t&&t.rendered&&!e.preserveScrollOnRefresh&&e.el.insertFirst(t.el)}},"Ext.layout.component.BoundList":{beginLayout:function(e){this.callParent(arguments);var t=this.owner.headerToolbar;t&&(e.headerToolbarContext=e.context.getCmp(t))},getLayoutItems:function(){var e=this.owner.headerToolbar,t=this.callParent(arguments);return e&&t.push(e),t},publishInnerHeight:function(e,t){var a=e.toolbarContext,i=e.headerToolbarContext,r=0;if(a&&(r=a.getProp("height")),i){var o=i.getProp("height");void 0===r?r=o:void 0!==o&&(r+=o)}void 0===r?this.done=!1:e.listContext.setHeight(t-e.getFrameInfo().height-r)},calculateOwnerHeightFromContentHeight:function(e){var t=this.callParent(arguments),a=e.headerToolbarContext;return a&&(t+=a.getProp("height")),t}},"Ext.data.proxy.Ajax":{actionMethods:{create:"POST",read:"POST",update:"POST",destroy:"POST"},doRequest:function(e,t,a){var i=this.getWriter(),r=this.buildRequest(e);return e.allowWrite()&&(r=i.write(r)),Ext.apply(r,{async:this.async,binary:this.binary,headers:this.headers,timeout:this.timeout,scope:this,callback:this.createRequestCallback(r,e,t,a),method:this.getMethod(r),disableCaching:!1}),Ext.Ajax.request(r),r}},"Ext.menu.Item":{removable:!1,removableCls:"x-menu-item-removable",removeHandler:Ext.emptyFn,initComponent:function(){var e=this;e.removable&&(e.cls=Ext.value(e.cls,"")+" "+e.removableCls),e.callParent(arguments)},afterRender:function(){var t=this;t.callParent(arguments);var e=document.createElement("i");e.setAttribute("class","fa fa-close removable"),(e=t.getEl().appendChild(e)).on("click",function(e){e.stopPropagation(),t.removeHandler(t)})}},"Ext.panel.Header":{adjustTitlePosition:function(){var e,t=this.titleCmp;!Ext.isIE9m&&t&&(e=t.el).setStyle("left",e.getWidth()/2+"px")},initIconCmp:function(){var e,t=this,a=[t.headerCls+"-icon",t.baseCls+"-icon",t.iconCls];t.glyph&&a.push(t.baseCls+"-glyph"),e={focusable:!1,src:Ext.BLANK_IMAGE_URL,cls:a,baseCls:t.baseCls+"-icon",id:t.id+"-iconEl",iconCls:t.iconCls,glyph:t.glyph,style:t.ownerCt.iconStyle},t.iconCmp=Ext.create("Ext.Component",e)}},"Ext.grid.ColumnManager":{getHeaderIndex:function(e){return e.isGroupHeader&&(e=e.down(":not([isGroupHeader])"),Ext.isEmpty(e))?0:Ext.Array.indexOf(this.getColumns(),e)}},"Ext.grid.ColumnComponentLayout":{publishOwnerHeight:function(e,t){var a=this.owner;if(this.callParent(arguments),!a.el.hasCls("sch-simple-timeaxis")){var i=a.titleEl.getHeight(),r=a.textEl.getHeight();-1==a.text.indexOf("<br>")&&-1==a.text.indexOf("<br/>")||(a.textEl.setStyle("height","auto"),r=a.textEl.getHeight());var o=Math.floor((i-r)/2),l=i-r-o;o<=i-r?(e.titleContext.setProp("padding-top",o),e.titleContext.setProp("padding-bottom",l)):e.titleContext.setProp("padding-top",0)}},publishInnerHeight:function(e,t){if(t){var a,i,r,o,l=this.owner,n=t-e.getBorderInfo().height,s=n;if(l.noWrap||e.hasDomProp("width")){var c=l.useField||"uxcheckcolumn"==l.xtype&&1==l.enableEdit;if(e.hasRawContent||c){if(i=s,a=l.textEl.getHeight())if(-1!=l.textEl.dom.innerHTML.indexOf("<br>")||-1!=l.textEl.dom.innerHTML.indexOf("<br/>")?(l.textEl.setStyle("height","auto"),a=l.textEl.getHeight()):s>l.titleEl.getHeight()&&l.titleEl.setStyle("height","auto"),0<(s-=a)){var d=0;o=t-a-(r=Math.floor(s/2)),c?(l.items.each(function(e){d+=e.getHeight()}),r-=d/2,o-=d/2,e.setProp("innerHeight",d,!1)):(d=0,e.titleContext.setProp("height","auto")),l.readOnly&&c&&(i+=d),r<=i-d-a&&(r.toString().includes(".")&&(r=parseInt(r)+1,o=parseInt(o)),e.titleContext.setProp("padding-top",r),e.titleContext.setProp("padding-bottom",o))}else e.titleContext.setProp("padding-top",0)}else i=l.titleEl.getHeight(),e.setProp("innerHeight",n-i,!1);(Ext.isIE6||Ext.isIEQuirks)&&e.triggerContext&&e.triggerContext.setHeight(i)}else this.done=!1}}},"Ext.data.Store":{constructor:function(e){this.addEvents("loadrecords"),this.callParent(arguments)},loadRecords:function(e,t){this.fireEvent("loadrecords",this,e),this.callParent(arguments)},group:function(e,t,a){e==this.groupField&&(t=Ext.value(t,this.groupDir)),this.callParent([e,t,a])}},"Ext.dom.Element":{getOffsetsTo:function(e){var t=this.getXY(),a=Ext.fly(e.el||e,"_internal").getXY();t[0],a[0];return[0,t[1]-a[1]]},scrollByEl:function(e,t){this.scrollBy(e.getOffsetsTo(this),Ext.value(t,!0))}},"Ext.form.FieldSet":{basicColor:void 0,borderColor:void 0,borderTopColor:void 0,titleColor:void 0,titleBgColor:void 0,bgColor:void 0,initComponent:function(){var e=this;"plus"==JE.getTheme()&&(e.style=Ext.value(e.style,""),e.titleStyle=Ext.value(e.titleStyle,""),e.legendStyle=Ext.value(e.legendStyle,""),JE.isNotEmpty(e.basicColor)&&(e.borderColor=e.borderTopColor=e.titleBgColor=e.basicColor,JE.isEmpty(e.titleColor)&&(e.titleColor="#ffffff")),JE.isNotEmpty(e.borderColor)&&(e.style+="border-color:"+e.borderColor+" !important;",e.legendStyle+="border-bottom-color:"+e.borderColor+";"),JE.isNotEmpty(e.borderTopColor)&&(e.style+="border-top-color:"+e.borderTopColor+" !important;"),JE.isNotEmpty(e.titleColor)&&(e.titleStyle="color:"+e.titleColor+";"),JE.isNotEmpty(e.titleBgColor)&&(e.legendStyle+="background-color:"+e.titleBgColor+";")),JE.isNotEmpty(e.bgColor)&&(e.style+="background-color:"+e.bgColor+";"),e.callParent(arguments)},createLegendCt:function(){var e=this.callParent(arguments);return e.style=this.legendStyle,e},createTitleCmp:function(){var e=this,t={xtype:"component",html:e.title,cls:e.baseCls+"-header-text",id:e.id+"-legendTitle",style:e.titleStyle};return e.collapsible&&e.toggleOnTitleClick&&(t.listeners={click:{element:"el",scope:e,fn:e.toggle}},t.cls+=" "+e.baseCls+"-header-text-collapsible"),e.titleCmp=Ext.widget(t)},createToggleCmp:function(){var e=this;return e.toggleCmp=Ext.widget({xtype:"tool",height:15,width:15,type:"toggle",handler:e.toggle,id:e.id+"-legendToggle",scope:e,style:e.titleStyle}),e.toggleCmp}},"Ext.grid.plugin.RowExpander":{setup:function(e,t){var a=1;try{Ext.Array.each(this.grid.plugins,function(e){e.hiddenFoldTool&&(a=0)})}catch(e){}this.self.prototype.setup.apply(this,arguments),this.grid.ownerLockable||(t.rowBodyColspan-=a)},bindView:function(e){this.hiddenFoldTool||(this.expandOnEnter&&e.on("itemkeydown",this.onKeyDown,this),this.expandOnDblClick&&e.on("itemdblclick",this.onDblClick,this))},getHeaderConfig:function(){var n=this;return{width:24,lockable:!1,sortable:!1,resizable:!1,draggable:!1,hideable:!1,menuDisabled:!0,tdCls:Ext.baseCSSPrefix+"grid-cell-special je-grid-cell-row-expander",innerCls:Ext.baseCSSPrefix+"grid-cell-inner-row-expander",renderer:function(e,t){return n.grid.ownerLockable||(t.tdAttr+=' rowspan="2"',n.hiddenFoldTool&&(t.tdAttr="style='display:none;'")),'<div class="'+Ext.baseCSSPrefix+'grid-row-expander"></div>'},processEvent:function(e,t,a,i,r,o,l){if("mousedown"==e&&o.getTarget(".x-grid-row-expander"))return n.toggleRow(i,l),n.selectRowOnExpand}}}},"Ext.layout.container.Column":{beginLayoutCycle:function(e){this.callParent(arguments),0<this.owner.layoutMinWidth&&this.outerCt.setStyle("width",this.owner.layoutMinWidth+24+"px")},renderTpl:["{% if (!(Ext.isIEQuirks || Ext.isIE7m)) { %}",'<span id="{ownerId}-outerCt" style="display:table;">','<div id="{ownerId}-innerCt" style="','<tpl if="Ext.isChrome">display: flex;flex-wrap: wrap;<tpl else>display:table-cell;height:100%;</tpl>','vertical-align:top;{%this.renderPadding(out, values)%}" class="{innerCtCls}">',"{%this.renderBody(out,values)%}","</div>","</span>","{% } else if (values.shrinkWrapWidth) { %}",'<table id="{ownerId}-outerCt" class="'+Ext.plainTableCls+'">',"<tr>",'<td id="{ownerId}-innerCt" style="vertical-align:top;padding:0;','{%this.renderPadding(out, values)%}" class="{innerCtCls}">',"{%this.renderBody(out,values)%}",'<div id="{ownerId}-clearEl" class="',Ext.baseCSSPrefix,'clear"','role="presentation"></div>',"</td>","</tr>","</table>","{% } else { %}",'<div id="{ownerId}-outerCt" style="zoom:1;{%this.renderPadding(out, values)%}">','<div id="{ownerId}-innerCt" style="zoom:1;height:100%;" class="{innerCtCls}">',"{%this.renderBody(out,values)%}",'<div id="{ownerId}-clearEl" class="',Ext.baseCSSPrefix,'clear"','role="presentation"></div>',"</div>","</div>","{% values.$layout.isShrinkWrapTpl = false %}","{% } %}"]},"Ext.grid.column.Column":{renderTpl:'<div id="{id}-titleEl" {tipMarkup} class="'+Ext.baseCSSPrefix+'column-header-inner" style="{henderInnerStyle}"><span id="{id}-textEl" class="'+Ext.baseCSSPrefix+'column-header-text{childElCls} {titleCls}" style="{titleStyle}">{text}</span><tpl if="!menuDisabled"><div id="{id}-triggerEl" class="'+Ext.baseCSSPrefix+'column-header-trigger{childElCls}"></div></tpl></div>{%this.renderContainer(out,values)%}',initRenderData:function(){return Ext.applyIf(this.callParent(arguments),{titleStyle:this.titleStyle,titleCls:this.titleCls,henderInnerStyle:this.henderInnerStyle})},toggleSortState:function(){var e,t=this;if(t.sortable&&(t.possibleSortStates=["ASC","DESC",null],e=(Ext.Array.indexOf(t.possibleSortStates,t.sortState)+1)%t.possibleSortStates.length,t.setSortState(t.possibleSortStates[e]),!t.possibleSortStates[e])){var a=t.up("tablepanel"),i=a.store;a.ownerLockable&&i.isNodeStore&&(i=a.ownerLockable.lockedGrid.store),i.sorters.clear(),i.load()}},initComponent:function(){this.addEvents("linkclick","beforeedit","edit"),this.callParent(arguments)}},"Ext.tree.Column":{cellTpl:['<tpl for="lines">','<img src="{parent.blankUrl}" class="{parent.childCls} {parent.elbowCls}-img ','{parent.elbowCls}-<tpl if=".">line<tpl else>empty</tpl>"/>',"</tpl>",'<tpl if="!hideElbow">','<tpl if="expandable">','<div src="{blankUrl}" class="{childCls} {elbowCls}-img {elbowCls}','<tpl if="isLast">-end</tpl><tpl if="expandable">-plus {expanderCls}</tpl>"></div>',"<tpl else>",'<img src="{blankUrl}" class="{childCls} {elbowCls}-img {elbowCls}','<tpl if="isLast">-end</tpl><tpl if="expandable">-plus {expanderCls}</tpl>"/>',"</tpl>","</tpl>",'<tpl if="checked !== null">','<div type="button" role="checkbox" <tpl if="checked">aria-checked="true" </tpl>','class="{childCls} {checkboxCls}<tpl if="checked"> {checkboxCls}-checked</tpl>"></div>',"</tpl>",'<tpl if="!hideIcon">','<div src="{blankUrl}" class="{childCls} {baseIconCls} ','{baseIconCls}-<tpl if="leaf">leaf<tpl else>parent</tpl> {iconCls}"','<tpl if="icon">style="background-image:url({icon})"</tpl>></div>',"</tpl>",'<tpl if="href">','<a href="{href}" target="{hrefTarget}" class="{textCls} {childCls}">{value}</a>',"<tpl else>",'<span class="{textCls} {childCls}">{value}</span>',"</tpl>"],treeRenderer:function(e,t,a,i,r,o,l){var n,s=this,c=a.get("cls"),d=s.origRenderer,u=a.data,E=a.parentNode,p=l.rootVisible,f=[],m=l.panel.nodeRenderer,g=Ext.value(l.panel.hideNodeIcon,!1),h=Ext.value(l.panel.hideNodeElbow,!1);for(m&&(e=m.apply(s.origScope,arguments)),c&&(t.tdCls+=" "+c);E&&(p||0<E.data.depth);)n=E.data,f[p?n.depth:n.depth-1]=n.isLast?0:1,E=E.parentNode;return s.getTpl("cellTpl").apply({record:a,baseIconCls:s.iconCls,iconCls:u.iconCls,icon:u.icon,checkboxCls:s.checkboxCls,checked:u.checked,elbowCls:s.elbowCls,expanderCls:s.expanderCls,textCls:s.textCls,leaf:u.leaf,expandable:a.isExpandable(),isLast:u.isLast,blankUrl:Ext.BLANK_IMAGE_URL,href:u.href,hrefTarget:u.hrefTarget,lines:f,metaData:t,hideIcon:g,hideElbow:h,childCls:s.getChildCls?s.getChildCls()+" ":"",value:d?d.apply(s.origScope,arguments):e})}},"Ext.view.Table":{getRecord:function(e){if(e=this.getNode(e)){var t=e.getAttribute("data-recordIndex");if(t&&-1<(t=parseInt(t,10))){var a=this.store.data.getAt(t),i=this.store.data.get(e.getAttribute("data-recordId"));return Ext.value(i,a)}return this.dataSource.data.get(e.getAttribute("data-recordId"))}},onCellClick:function(e,t,a,i,r,o){var l=this.getHeaderByCell(e),n=a.get(l.dataIndex);if(l.hasListener("linkclick")&&(l.rendererText||!Ext.isEmpty(n)&&o.getTarget(".link-text",3)))l.fireEvent("linkclick",l,n,a,this.panel);else if(l.useMark){var s=Ext.get(e).down(".je-field-markfield-view");JEMarkField.showMark(a,s,this.panel)}else if(l.usePostil){var c=this.panel.funcData.info,d=a.get(c.pkName);JE.CoreUtil.showPostil({funcCode:c.funcCode,pkValue:d,record:a})}},renderCell:function(e,t,a,i,r){var o,l,n=this,s=n.selModel,c=n.cellValues,d=c.classes,u=t.data[e.dataIndex],E=n.cellTpl;c.record=t,c.column=e,c.recordIndex=a,c.columnIndex=i,c.cellIndex=i,c.align=e.align,c.tdCls=e.tdCls,c.innerCls=e.innerCls,c.style=c.tdAttr="",c.unselectableAttr=n.enableTextSelection?"":'unselectable="on"',e.rowIndex=a,c.tdAttr=JE.buildRendererTDStyle(e),e.renderer&&e.renderer.call?(o=e.renderer.call(e.scope||n.ownerCt,u,c,t,a,i,n.dataSource,n),c.css&&(t.cssWarning=!0,c.tdCls+=" "+c.css,delete c.css)):o=u,c.value=null==o||""===o?"&#160;":o,d[1]=Ext.baseCSSPrefix+"grid-cell-"+e.getItemId(),l=2,e.tdCls&&(d[l++]=e.tdCls),n.markDirty&&t.isModified(e.dataIndex)&&(d[l++]=n.dirtyCls),e.isFirstVisible&&(d[l++]=n.firstCls),e.isLastVisible&&(d[l++]=n.lastCls),n.enableTextSelection||(d[l++]=Ext.baseCSSPrefix+"unselectable"),d[l++]=c.tdCls,s&&s.isCellSelected&&s.isCellSelected(n,a,i)&&(d[l++]=n.selectedCellCls),d.length=l,c.tdCls=d.join(" "),E.applyOut(c,r),c.column=null}},"Ext.view.TableLayout":{setColumnWidths:function(e){return!this.owner.body.dom||this.callParent(arguments)}},"Ext.grid.feature.Grouping":{onColumnMove:function(){var e,t,a,i,r,o,l=this.view.store;if(l.isGrouped())for(a=(e=l.getGroups()).length,t=0;t<a;t++)r=(i=e[t]).children[0],o=i.children[i.children.length-1],l.fireEvent("update",l,r,"edit",null),o!==r&&l.fireEvent("update",l,o,"edit",null)},groupTpl:["{%","var me = this.groupingFeature;","if (me.disabled) {","values.needsWrap = false;","} else {","me.setupRowData(values.record, values.recordIndex, values);","values.needsWrap = !me.disabled && (values.isFirstRow || values.summaryRecord);","}","%}",'<tpl if="needsWrap">','<tr data-boundView="{view.id}" data-recordId="{record.internalId}" data-recordIndex="{[values.isCollapsedGroup ? -1 : values.recordIndex]}"','class="{[values.itemClasses.join(" ")]} '+Ext.baseCSSPrefix+'grid-wrap-row<tpl if="!summaryRecord"> '+Ext.baseCSSPrefix+'grid-group-row</tpl>">','<td class="'+Ext.baseCSSPrefix+'group-hd-container" colspan="{columns.length}">','<tpl if="isFirstRow">',"{%",'var groupTitleStyle = (!values.view.lockingPartner || (values.view.ownerCt === values.view.ownerCt.ownerLockable.lockedGrid) || (values.view.lockingPartner.headerCt.getVisibleGridColumns().length === 0)) ? "" : "visibility:hidden";',"%}",'<div id="{groupId}" class="'+Ext.baseCSSPrefix+'grid-group-hd {collapsibleCls}" tabIndex="0">','<div class="'+Ext.baseCSSPrefix+'grid-group-title" style="{[groupTitleStyle]}">','{[values.groupHeaderTpl.apply(values.groupInfo, parent) || "&#160;"]}',"</div>","</div>","</tpl>",'<tpl if="summaryRecord || !isCollapsedGroup">','<table class="',Ext.baseCSSPrefix,"{view.id}-table ",Ext.baseCSSPrefix,"grid-table",'<tpl if="summaryRecord"> ',Ext.baseCSSPrefix,'grid-table-summary</tpl>"','border="0" cellspacing="0" cellpadding="0" style="width:100%">',"{[values.view.renderColumnSizer(out)]}",'<tpl if="!isCollapsedGroup">',"{%","values.itemClasses.length = 0;","this.nextTpl.applyOut(values, out, parent);","%}","</tpl>",'<tpl if="summaryRecord">',"{%me.outputSummaryRecord(values.summaryRecord, values, out);%}","</tpl>","</table>","</tpl>","</td>","</tr>","<tpl else>","{%this.nextTpl.applyOut(values, out, parent);%}","</tpl>",{priority:200,syncRowHeights:function(e,t){e=Ext.fly(e,"syncDest"),t=Ext.fly(t,"sycSrc");var a,i,r,o,l=this.owner,n=e.down(l.eventSelector,!0),s=e.down(l.summaryRowSelector,!0);n&&(a=t.down(l.eventSelector,!0))&&(n.style.height=a.style.height="",(r=n.offsetHeight)>(o=a.offsetHeight)?Ext.fly(a).setHeight(r):r<o&&Ext.fly(n).setHeight(o)),s&&(i=t.down(l.summaryRowSelector,!0))&&(s.style.height=i.style.height="",(r=s.offsetHeight)>(o=i.offsetHeight)?Ext.fly(i).setHeight(r):r<o&&Ext.fly(s).setHeight(o))},syncContent:function(e,t){e=Ext.fly(e,"syncDest"),t=Ext.fly(t,"sycSrc");var a=this.owner,i=e.down(a.eventSelector,!0),r=t.down(a.eventSelector,!0),o=e.query(a.summaryRowSelector),l=t.query(a.summaryRowSelector);i&&r&&Ext.fly(i).syncContent(r),JE.isNotEmpty(o)&&JE.isNotEmpty(l)&&Ext.each(o,function(e,t){Ext.fly(e).syncContent(l[t])})}}],populateRecord:function(e){for(var t,a,i,r=this.grid.ownerLockable?this.grid.ownerLockable.view:this.view,o=this.view.store,l=r.headerCt.getGridColumns(),n=l.length,s=1,c=[],d=0;d<s;d++){var u=e.getAggregateRecord();for(u.beginEdit(),t=0;t<n;++t){i=(a=l[t]).dataIndex||a.id;var E="";if(JE.isNotEmpty(a.summary)){var p=JE.decode(a.summary);s=p.length,E=JE.getSummary(o,e.records,a.dataIndex,!1,a,p[d].code)}u.set(i,E)}u.set("summary__index",d),u.endEdit(!0),u.commit(),c.push(u)}return e.aggregate=c,e.aggregate.isSummary=!0,c},outputSummaryRecord:function(e,t,a){var i,r,o=t.view,l=o.rowValues,n=t.columns||o.headerCt.getVisibleGridColumns(),s=n.length,c=this;for(i=0;i<s;i++)(r=n[i]).savedRenderer=r.renderer,r.summaryRenderer?r.renderer=r.summaryRenderer:r.summaryType||(r.renderer=Ext.emptyFn),r.dataIndex||(r.dataIndex=r.id);for(e=Ext.isArray(e)?e:[e],Ext.each(e,function(e){values={view:o,record:e,rowStyle:"",rowClasses:[c.summaryRowCls],itemClasses:[],recordIndex:-1,rowId:o.getRowId(e),columns:n},o.rowValues=values,o.self.prototype.rowTpl.applyOut(values,a)}),o.rowValues=l,i=0;i<s;i++)(r=n[i]).renderer=r.savedRenderer,r.savedRenderer=null}},"Ext.grid.feature.Summary":{getAllSummary:function(e,t,a,i){var r=i.records;if(t&&Ext.isFunction(t))return e.getAggregate(t,null,r,[a,!0])},renderTFoot:function(t,a){var e=t.view,i=e.findFeature("summary");i.showSummaryRow&&(a.push("<tfoot>"),Ext.each(i.createSummaryRecords(e,!1),function(e){i.outputSummaryRecord(e,t,a)}),a.push("</tfoot>"))},createSummaryRecords:function(i,r){var o=this,l=o[r?"summaryAllRecords":"summaryRecords"]=[],e=i.headerCt.getVisibleGridColumns(),n=(e.length,[]),s=[],c=[],d=[];return Ext.each(e,function(e){if(e.dataIndex||(e.dataIndex=e.id),JE.isNotEmpty(e.summary)){n.push(e),s.push(e.dataIndex);var t=JE.decode(e.summary),a=Ext.value(JE.decode(e.summaryFormat,!0),[]);Ext.each(t,function(e,t){c[t]=Ext.value(c[t],[]),c[t].push(e.code),d[t]=Ext.value(d[t],[]),d[t].push(a[t])})}}),0<n.length&&Ext.each(c,function(e,t){var a={types:e,formats:d[t],id:t,fields:s,columns:n};l.push(o.createSummaryRecord(i,r,a))}),l},createSummaryRecord:function(i,r,o){var l,e=i.headerCt.getVisibleGridColumns(),n={records:i.store.getRange()},t=(e.length,0==r?"":"All"),a=i.id+"-summary"+t+"-record-"+o.id,s=new i.store.model(null,a);return s.allRecord=0!=r,s.beginEdit(),Ext.each(o.columns,function(e,t){var a="";a=r?(Ext.isEmpty(l)&&(l=JE.getAllSummary({tableCode:i.store.proxy.extraParams.tableCode,whereSql:i.store.proxy.extraParams.whereSql,types:o.types,fields:o.fields})),l[e.dataIndex]):JE.getSummary(i.store,n.records,e.dataIndex,r,e,o.types[t]),a=isNaN(a)?0:a,s.set(e.dataIndex,a)}),s.set("summary__index",o.id),s.endEdit(!0),s.commit(!0),s.isSummary=!0,s},onStoreUpdate:function(e,t,a){var r=this,o=r.view;if(o.rendered){var i=[{name:"summaryRecords",all:!1},{name:"summaryAllRecords",all:!0}],l=[],n=[];if(0==(!(o.store.totalCount<=o.store.pageSize)&&r.useSummaryAll)&&i.pop(),e&&e.isStore&&(r.firstSummary?delete r.firstSummary:Ext.each(i,function(e){r.createSummaryRecords(o,e.all)})),Ext.each(i,function(e,a){if(Ext.isEmpty(r[e.name])&&(r.createSummaryRecords(o,e.all),r.firstSummary=!0),n[a]=[],l[a]=[],Ext.each(r[e.name],function(e,t){n[a].push(o.createRowElement(e,-1))}),0==a?r.showSummaryRow?Ext.each(r[e.name],function(e){var t=r.view.getNode(e);JE.isNotEmpty(t)&&l[a].push(t)}):0==r.useSummaryAll&&r.dock&&(l[a]=r.summaryBar.el.query("."+r.summaryRowCls)):1==a&&r.dock&&0!=r.useSummaryAll&&(l[a]=r.summaryBar.el.query("."+r.summaryRowCls)),JE.isNotEmpty(l[a])){var t=l[a][0],i=t.parentNode;Ext.each(n[a],function(e){i.insertBefore(e,t)}),Ext.each(l[a],function(e){i.removeChild(e)})}}),!Ext.isEmpty(l)){var s=r.lockingPartner;s&&s.grid.rendered&&!r.calledFromLockingPartner&&(s.calledFromLockingPartner=!0,s.onStoreUpdate(),s.calledFromLockingPartner=!1)}r.dock&&r.onColumnHeaderLayout()}},init:function(t){var a=this,i=a.view;a.superclass.init.call(a,t),a.dock&&(t.headerCt.on({afterlayout:a.onStoreUpdate,scope:a}),t.on({beforerender:function(){var e=["x-grid-table",a.summaryTableCls];i.columnLines&&(e[e.length]=i.ownerCt.colLinesCls),a.summaryBar=Ext.create("Ext.Component",{childEls:["innerCt"],gridView:t.view,renderTpl:['<div id="{id}-innerCt">','<table cellPadding="0" cellSpacing="0" class="'+e.join(" ")+'" style="table-layout: fixed;">','<tr class="'+a.summaryRowCls+'"></tr>',"</table>","</div>"],style:"overflow:hidden",itemId:"summaryBar",cls:[a.dockedSummaryCls,a.dockedSummaryCls+"-"+a.dock],xtype:"component",dock:a.dock,hidden:!0,weight:1e7}),t.addDocked(a.summaryBar)},afterrender:function(){t.body.addCls(a.panelBodyCls+a.dock),i.mon(i.el,{scroll:a.onViewScroll,scope:a}),a.onStoreUpdate()},single:!0}),t.headerCt.afterComponentLayout=Ext.Function.createSequence(t.headerCt.afterComponentLayout,function(){a.summaryBar.innerCt.setWidth(this.getFullWidth()+Ext.getScrollbarSize().width),a.summaryBar.innerCt.dom.style.paddingRight=Ext.getScrollbarSize().width+"px"})),a.showSummaryRow&&a.view.addFooterFn(a.renderTFoot),t.on({columnmove:a.onStoreUpdate,scope:a}),i.mon(i.store,{update:a.onStoreUpdate,datachanged:a.onStoreUpdate,load:function(e){var t=!(e.totalCount<=i.store.pageSize)&&a.useSummaryAll;a.summaryBar&&a.summaryBar.setVisible(t)},scope:a})}},"Ext.form.Basic":{getFields:function(){var e=this;return Ext.isEmpty(e.monitor)&&e.owner&&(e.monitor=e.owner.monitor),e.monitor&&(e.owner&&e.owner.funcData?e.monitor.selector="[isFormField][formCode="+e.owner.funcData.info.funcCode+"_form]":e.monitor.selector="[isFormField]"),e.callParent()},setValues:function(e,t){return this.callParent(arguments),this.owner&&this.owner.fireEvent("setvalues",this.owner,e,t),this},setItemsReadOnly:function(t){this.getFields().each(function(e){e.initialConfig.readOnly&&e.initialConfig.readOnly==e.readOnly||e.initialConfig.hidden||e.setReadOnly(t)})},getChanges:function(r){var o=new Ext.util.MixedCollection;return this.getFields().each(function(e){if((r||!e.isHidden())&&e.isDirty()){var t=e.getValue(),a=e.originalValue;if("uxfilefield"!=e.xtype){var i={};-1!=["cgroup","rgroup","cbbfield","yesnofield"].indexOf(e.xtype)?(i._newVal=t,i._oldVal=a,t=e.getText(t),a=e.getText(a)):"numberfield"==e.xtype&&(t=Ext.value(t,0),a=Ext.value(a,0)),t!=a&&(Ext.apply(i,{name:e.getName(),text:e.fieldLabel,newVal:t,oldVal:a,initialConfig:e.initialConfig}),o.add(i))}}}),o},doAction:function(e,t){return Ext.isString(e)&&(e=Ext.ClassManager.instantiateByAlias("formaction."+e,Ext.apply({},t,{form:this}))),!1!==this.fireEvent("beforeaction",this,e)&&(this.beforeAction(e),this.owner.funcData?e.run():Ext.defer(e.run,100,e)),this}},"Ext.layout.component.field.Trigger":{beginLayoutFixed:function(e,t,a){"100%"==e.target.width&&(t=100,a="%"),this.callParent([e,t,a])},updateEditState:function(){var e,t,a=this,i=a.owner,r=i.inputEl,o=Ext.baseCSSPrefix+"trigger-noedit";e=a.owner.readOnly?(r.addCls(o),!(t=!0)):(t=a.owner.editable?(r.removeCls(o),!1):(r.addCls(o),!0),!a.owner.hideTrigger),Ext.isEmpty(i.funcCode)?i.triggerCell.setDisplayed(e):i.triggerCell.setStyle("opacity",a.owner.readOnly?"0.5":"1"),r.dom.readOnly=t}},"Ext.form.field.Trigger":{hideTrigger1:!0,setReadOnly:function(e){var t=this;Ext.isEmpty(t.funcCode)||(t.readOnly=e,t.triggerCell&&t.triggerCell.setStyle("opacity",t.readOnly?"0.5":"1")),t.callParent(arguments),1!=t.editable&&t.inputEl&&(t.inputEl.dom.readOnly=!0)},getTriggerMarkup:function(){var e=this.hideTrigger;Ext.isEmpty(this.funcCode)&&(e=this.hideTrigger||this.readOnly);var t,a=this,i=0,r=a.triggerBaseCls,o=[],l=Ext.dom.Element.unselectableCls,n="width:"+a.triggerWidth+"px;"+(e?"display:none;":this.readOnly?"opacity:0.5;":""),s=a.extraTriggerCls+" "+Ext.baseCSSPrefix+"trigger-cell "+l;for(a.trigger1Cls||(a.trigger1Cls=a.triggerCls),i=0;(t=a["trigger"+(i+1)+"Cls"])||i<1;i++){var c="";a["hideTrigger"+(i+1)]&&(c+="display:none;"),0<a["trigger"+(i+1)+"Width"]&&(c+="width:"+a["trigger"+(i+1)+"Width"]+"px;"),o.push({tag:"td",valign:"top",cls:s,style:n+c,cn:{cls:[Ext.baseCSSPrefix+"trigger-index-"+i,r,t].join(" "),role:"button"}})}return o[0].cn.cls+=" "+r+"-first",Ext.DomHelper.markup(o)},getTriggerWidth:function(){var e=this,t=0;if(e.triggerWrap&&!e.hideTrigger&&!e.readOnly)for(var a=0;a<e.triggerEl.getCount();a++){var i=e["hideTrigger"+(a+1)],r=e["trigger"+(a+1)+"Width"];i||(t+=0<r?r:e.triggerWidth)}return t},initEvents:function(){var e=this;e.callParent(),!e.editable&&e.enableClick&&e.mon(e.inputEl,"click",function(){e.readOnly||e.disabled||JE.isNotEmpty(e.value)||e.onTrigger2Click&&e.onTrigger2Click()},e)}},"Ext.form.action.Action":{createCallback:function(){var e=this.callParent(arguments);return Ext.apply(e,{async:Ext.value(this.async,!0)})}},"Ext.data.Connection":{upload:function(r,e,t,o){var l=this;r=Ext.getDom(r),o=o||{};function a(e,t){var a=!0;s=document.createElement("input"),Ext.fly(s).set({type:"hidden",value:t,name:e});for(var i=0;i<r.length;i++)if(r[i].name==e)return void(a=!1);a&&r.appendChild(s),m.push(s)}function n(){for(p=0;p<m.length;p++)Ext.removeNode(m[p])}var s,i,c,d,u,E,p,f=Ext.id(),m=[],g="multipart/form-data",h={target:r.target,method:r.method,encoding:r.encoding,enctype:r.enctype,action:r.action};if(Ext.fly(r).set({target:f,method:"POST",enctype:g,encoding:g,action:e||h.action}),t)for(d in i=Ext.Object.fromQueryString(t)||{})if(i.hasOwnProperty(d))if(c=i[d],Ext.isArray(c))for(u=c.length,E=0;E<u;E++)a(d,c[E]);else a(d,c);var x={url:"url",type:"method",headers:"headers",async:"async",timeout:"timeout"},y={success:function(e){var t={responseText:e,responseXML:null},a=o.success;l.fireEvent("requestcomplete",l,t,o),JE.systemError(e)||(Ext.callback(a,o.scope,[t,o]),Ext.callback(o.callback,o.scope,[o,!0,t]),n())},error:function(e,t,a){var i={responseText:'{success:false,message:"'+t+'"}',responseXML:null},r=o.failure;l.fireEvent("requestcomplete",l,i,o),Ext.callback(r,o.scope,[i,o]),Ext.callback(o.callback,o.scope,[o,!1,i]),n()}};for(var v in x)x[v]&&(y[v]=o[v]);$(r).ajaxSubmit(y)}},"Ext.grid.column.Action":{defaultRenderer:function(e,t,a,i,r,o,l){var n,s,c,d,u,E=this,p=Ext.baseCSSPrefix,f=E.origScope||E,m=E.items,g=m.length,h=0;s=Ext.isFunction(E.origRenderer)&&E.origRenderer.apply(f,arguments)||"",t.tdCls+=" "+Ext.baseCSSPrefix+"action-col-cell";for(var x=[];h<g;h++){c=(n=m[h]).disabled||!!n.isDisabled&&n.isDisabled.call(n.scope||f,l,i,r,n,a),d=n.tooltip||(n.getTip?n.getTip.apply(n.scope||f,arguments):null),u=n.tooltipType||"qtip",n.hasActionConfiguration||(n.stopSelection=E.stopSelection,n.disable=Ext.Function.bind(E.disableAction,E,[h],0),n.enable=Ext.Function.bind(E.enableAction,E,[h],0),n.hasActionConfiguration=!0);var y=Ext.value(n.style,""),v=n.getStyle||E.getItemStyle;v&&(Ext.isString(v)&&(v=JE.eval(v)),y=v.apply(n.scope||f,arguments)||y),E.funcColumn&&JE.isNotEmpty(d)&&JE.isEmpty(n.icon)&&JE.isEmpty(n.iconCls)?(y+=n.fontStyle||n.iconStyle,x.push('<div style="'+y+'" class="'+p+"action-col-text "+p+"action-col-"+String(h)+" "+(c?p+"item-disabled":" ")+" je-button-actioncolumn "+(Ext.isFunction(n.getClass)?n.getClass.apply(n.scope||f,arguments):"")+'" >'+d+"</div>")):(d=c?null:d,JE.isNotEmpty(n.icon)&&(y+="background-image:url("+n.icon+")"),JE.isNotEmpty(n.iconStyle)&&(y+=n.iconStyle),x.push('<div role="button" alt="'+(n.altText||E.altText)+'" style="'+y+'" class="'+p+"action-col-icon "+p+"action-col-"+String(h)+" "+(c?p+"item-disabled":" ")+" "+(Ext.isFunction(n.getClass)?n.getClass.apply(n.scope||f,arguments):n.iconCls||E.iconCls||"")+'"'+(d?("title"==u?" title":" data-qtip")+'="'+d+'"':"")+" ></div>"))}return s+=x.join('<div class="x-action-col-split" style="color:#AAAAAA">'+(E.splitStr||"|")+"</div>","")}},"Ext.grid.header.Container":{getMenuItems:function(){var e=this.callParent(arguments);return e.push("-"),e.push({itemId:"updateItem",text:JE.local.lang.core.util.OverrideUtil.gridHeaderUpdateItem,iconCls:"jeicon jeicon-form-editing",handler:this.onUpdateItemClick,scope:this}),e},onUpdateItemClick:function(){var e=this.getMenu().activeHeader;e.updateColumnData&&e.updateColumnData()},showMenuBy:function(e,t){var a,i,r=this.getMenu(),o=r.down("#ascItem"),l=r.down("#descItem"),n=r.down("#updateItem"),s=r.down("#groupMenuItem"),c=r.down("#groupToggleMenuItem");r.activeHeader=r.ownerButton=t,t.setMenuActive(!0),a=t.sortable?"enable":"disable",o&&o[a](),l&&l[a]();var d=!1;this.grid.funcData?d=this.grid.readOnly:this.grid.ownerCt&&this.grid.ownerCt.funcData&&(d=this.grid.ownerCt.readOnly),i=(this.grid.updateButton||1!=d)&&t.enableUpdate&&"actioncolumn"!=t.xtype?"show":"hide",n&&(n.previousSibling()[i](),n[i]()),s&&s[t.enableGroup?"show":"hide"](),c&&c[!Ext.isEmpty(this.view.store.groupField)?"enable":"disable"]();r.showBy(e)}},"Ext.menu.Item":{initComponent:function(){this.addEvents("beforeclick"),this.callParent(arguments)},onClick:function(e){var t=this,a=t.clickHideDelay;t.href||e.stopEvent(),t.disabled||(t.hideOnClick&&(a?t.deferHideParentMenusTimer=Ext.defer(t.deferHideParentMenus,a,t):t.deferHideParentMenus()),!1!==t.fireEvent("beforeclick",t,e)&&(Ext.callback(t.handler,t.scope||t,[t,e]),t.fireEvent("click",t,e),t.hideOnClick||t.focus()))},renderTpl:['<tpl if="plain">',"{text}","<tpl else>",'<a id="{id}-itemEl"',' class="'+Ext.baseCSSPrefix+'menu-item-link{childElCls}"',' href="{href}"','<tpl if="hrefTarget"> target="{hrefTarget}"</tpl>',' hidefocus="true"',' unselectable="on"','<tpl if="tabIndex">',' tabIndex="{tabIndex}"',"</tpl>",">",'<div role="img" id="{id}-iconEl" class="'+Ext.baseCSSPrefix+"menu-item-icon {iconCls}",'{childElCls} {glyphCls}" style="<tpl if="icon">background-image:url({icon});</tpl> <tpl if="iconStyle">{iconStyle}</tpl>','<tpl if="glyph && glyphFontFamily">font-family:{glyphFontFamily};</tpl>">','<tpl if="glyph">&#{glyph};</tpl>',"</div>",'<span id="{id}-textEl" class="'+Ext.baseCSSPrefix+'menu-item-text" unselectable="on">{text}</span>','<img id="{id}-arrowEl" src="{blank}" class="{arrowCls}','{childElCls}"/>',"</a>","</tpl>"],beforeRender:function(){this.callParent(arguments),this.renderData.iconStyle=this.iconStyle}},"Ext.button.Button":{initComponent:function(){this.addEvents("beforeclick","afterclick"),this.callParent(arguments)},fireHandler:function(e){var t=this,a=t.handler;JE.doButtonLog(t),!1!==t.fireEvent("beforeclick",t,e)&&!1!==t.fireEvent("click",t,e)&&(a&&a.call(t.scope||t,t,e),0!=t.allowAfterClick&&t.fireEvent("afterclick",t,e))},renderTpl:['<span id="{id}-btnWrap" class="{baseCls}-wrap','<tpl if="splitCls"> {splitCls}</tpl>','{childElCls}" unselectable="on">','<span id="{id}-btnEl" class="{baseCls}-button">','<span id="{id}-btnInnerEl" class="{baseCls}-inner {innerCls}','{childElCls}" style="{textStyle}" unselectable="on">',"{text}","</span>",'<span role="img" id="{id}-btnIconEl" class="{baseCls}-icon-el {iconCls}','{childElCls} {glyphCls}" unselectable="on" style="{iconStyle}','<tpl if="iconUrl">background-image:url({iconUrl});</tpl>','<tpl if="glyph && glyphFontFamily">font-family:{glyphFontFamily};</tpl>">','<tpl if="glyph">&#{glyph};</tpl>',"</span>","</span>","</span>",'<tpl if="closable">','<span id="{id}-closeEl" class="{baseCls}-close-btn" title="{closeText}" tabIndex="0"></span>',"</tpl>"],getTemplateArgs:function(){var e=this.callParent(arguments);return e.textStyle=Ext.value(this.textStyle,""),e.iconStyle=Ext.value(this.iconStyle,""),e}},"Ext.tab.Panel":{initComponent:function(){var e=this,t=" je-tabpanel-body";if(e.bodyCls=Ext.isEmpty(e.bodyCls)?t:e.bodyCls+t,-1!=["top","bottom"].indexOf(e.tabPosition)){e.tabBar=Ext.value(e.tabBar,{}),e.tabBar.defaults=Ext.value(e.tabBar.defaults,{});var a=Ext.value(e.tabBar.height,34);Ext.apply(e.tabBar,{height:e.plain?a-2:a}),Ext.apply(e.tabBar.defaults,{height:Ext.value(e.tabBar.defaults.height,a-4)})}e.callParent(arguments)},setItemVisible:function(e,t,a){var i=this;if(1==i.tabBar.hidden)i.setVisible(t);else{var r,o=e;t||(r=e.tab.next("tab[hidden=false]")||e.tab.prev("tab[hidden=false]"))&&(o=r.card),e.tab.setVisible(t),a&&("first"==a?i.items.each(function(e){if(!e.tab.isHidden())return o=e,!1}):a.ownerCt==i&&(o=a)),i.setActiveTab(o),t?i.isHidden()&&i.show():r||i.hide()}}},"Ext.grid.CellEditor":{alignment:"tl-tl?"},"Ext.form.field.HtmlEditor":{fontFamilies:["黑体","微软雅黑","宋体","楷体","幼圆"]},"Ext.grid.plugin.CellEditing":{beforeEdit:function(e){if(this.disabled)return!1;var t=e.column;return t?t.fireEvent("beforeedit",t,e):void 0},onEditComplete:function(e,t,a){var i,r=this,o=r.getActiveColumn(),l=r.context;if(o){if(i=l.record,r.setActiveEditor(null),r.setActiveColumn(null),r.setActiveRecord(null),l.value=t,!r.validateEdit())return;i.isEqual(t,a)||i.set(o.dataIndex,t),l.view.focus(!1,!0),o.fireEvent("edit",o,l),r.fireEvent("edit",r,l),r.editing=!1}},showEditor:function(e,t,a){var i=this,r=t.record,o=t.column,l=i.grid.getSelectionModel(),n=l.getCurrentPosition();n&&n.view;i.setEditingContext(t),i.setActiveEditor(e),i.setActiveRecord(r),i.setActiveColumn(o),!l.selectByPosition||n&&n.column===t.colIdx&&n.row===t.rowIdx||l.selectByPosition({row:t.rowIdx,column:t.colIdx,view:i.view}),e.alignment="c-c",e.startEdit(i.getCell(r,o),a,t),i.editing=!0,i.scroll=i.view.el.getScroll()}},"Ext.tree.View":{treeRowTpl:["{%","this.processRowValues(values);","this.nextTpl.applyOut(values, out, parent);",'delete values.rowAttr["data-qtip"];','delete values.rowAttr["data-qtitle"];',"%}",{priority:10,processRowValues:function(e){var t=e.record,a=e.view,i=t.get("qtip"),r=t.get("qtitle");e.rowAttr={},r?e.rowAttr.title=r:i&&(e.rowAttr["data-qtip"]=i),t.isExpanded()&&e.rowClasses.push(a.expandedCls),t.isLeaf()&&e.rowClasses.push(a.leafCls),t.isLoading()&&e.rowClasses.push(a.loadingCls)}}],refresh:function(){var e=this;if(e.callParent(arguments),e.el&&!e.all.getCount()&&e.headerCt&&e.headerCt.tooNarrow){var t=e.el.child("div");t&&t.remove()}},treeCheckNodeCls:function(e,t){var a=this,i=a.indexOf(e);t?(a.getSelectionModel().selected.add(e),a.addRowCls(i,a.selectedItemCls)):(a.getSelectionModel().selected.remove(e),a.removeRowCls(i,[a.selectedItemCls,a.focusedItemCls]))},setNodeChecked:function(e,t){var a=Ext.get(this.getNode(e));if(e.data.checked=t,a){var i=a.down(".x-tree-checkbox");i&&i[t?"addCls":"removeCls"](Ext.baseCSSPrefix+"tree-checkbox-checked")}},eachChild:function(e,t){var a=this;e.expand(!1,function(){e.eachChild(function(e){null!==e.get("checked")&&(a.setNodeChecked(e,t),a.treeCheckNodeCls(e,t)),a.eachChild(e,t)})})},eachParent:function(e,t){e.isRoot()||1!=t||(Ext.isEmpty(e.get("checked"))||(this.setNodeChecked(e,t),this.treeCheckNodeCls(e,t)),this.eachParent(e.parentNode,t))},deselectParent:function(e){var t=e.parentNode;if(!this.panel.type&&t&&!t.isRoot()&&"ROOT"==t.get("parent")){var a=!1;t.eachChild(function(e){if(1==e.get("checked"))return!(a=!0)}),a||this.getSelectionModel().deselect(t)}},onRowSelect:function(e,t){var a=this,i=a.panel;if(a.callParent(arguments),1==i.funcTree){var r=a.getRecord(a.getNode(e));r&&null!=r.get("checked")&&(a.setNodeChecked(r,!0),t||("T"!=i.selectType&&"A"!=i.selectType||a.eachChild(r,!0),"D"!=i.selectType&&"A"!=i.selectType||a.eachParent(r,!0)))}},onRowDeselect:function(e,t){var a=this,i=a.panel;if(a.callParent(arguments),1==i.funcTree){var r=a.getRecord(a.getNode(e));r&&null!=r.get("checked")&&(a.setNodeChecked(r,!1),t||("T"!=i.selectType&&"A"!=i.selectType||a.eachChild(r,!1),a.deselectParent(r)))}},afterRender:function(){var e=this;e.callParent(arguments),1==e.panel.funcTree&&e.el.un("click",e.onCheckboxChange,e)}},"Ext.grid.plugin.HeaderResizer":{onHeaderCtMouseMove:function(e,t){var a,i,r,o,l,n,s=this;s.headerCt.dragging?s.activeHd&&(s.activeHd.el.dom.style.cursor="",delete s.activeHd):(i=e.getTarget("."+s.colHeaderCls,10,!0))&&((r=Ext.getCmp(i.id)).isOnLeftEdge(e)?(o=r.previousNode("gridcolumn:not([hidden]):not([isGroupHeader])"))&&(n=s.headerCt.up("tablepanel"),(l=o.up("tablepanel"))===n||n.ownerCt.isXType("tablepanel")&&n.ownerCt.view.lockedGrid===l||(o=null)):o=r.isOnRightEdge(e)?r:null,o?(o.isGroupHeader&&(o=(a=o.getGridColumns())[a.length-1]),!o||o.fixed||!1===o.resizable||s.disabled||(s.activeHd=o,r.el.dom.style.cursor=s.eResizeCursor,r.triggerEl&&(r.triggerEl.dom.style.cursor=s.eResizeCursor))):(r.el.dom.style.cursor="",r.triggerEl&&(r.triggerEl.dom.style.cursor=""),s.activeHd=null))}},"Ext.data.PageMap":{getRange:function(e,t){return Ext.isNumber(e)&&Ext.isNumber(t)&&(e<0&&(e=0),t<0&&(t=0)),this.callParent(arguments)}},"Ext.selection.Model":{getSelection:function(){var e=this.callParent(arguments),r=this.store,o=[];return Ext.each(e,function(e){var t;if(r.treeStore)t=r.treeStore.tree.nodeHash[e.internalId];else if(r.buffered){var a=parseInt(e.index/r.pageSize)+1,i=e.index%r.pageSize;t=r.data.get(a)[i]}else t=r.data.get(e.internalId);t&&o.push(t)}),o}},"Ext.container.AbstractContainer":{getCmp:function(e){return this.getComponent(e)}},"Ext.panel.Panel":{getDockedCmp:function(e){return this.getDockedComponent(e)}},"Ext.Component":{initComponent:function(){this.addEvents("boxrefresh"),this.callParent(arguments)},update:function(){this.callParent(arguments),this.getEl()&&this.fireEvent("boxrefresh",this)},onKeyDown:function(e){var t,a,i,r;if(e.getKey()==Ext.EventObject.TAB&&(t=e.shiftKey,i=(a=this.el.query(":focusable"))[0],r=a[a.length-1],i&&r&&e.target===(t?i:r))){e.stopEvent();try{(t?r:i).focus(!1,!0)}catch(e){console.log(e.message)}}}},"Ext.layout.component.field.Field":{beginLayoutFixed:function(e,t,a){t+a=="100%"&&(a=t="");this.callParent([e,t,a])},labelStrategies:function(){var e={prepare:function(e,t){var a=t.labelCls+"-"+t.labelAlign,i=t.labelEl;i&&i.addCls(a)},getHeight:function(){return 0},finishedLayout:Ext.emptyFn};return{base:e,top:Ext.applyIf({getHeight:function(e){var t=e.labelContext,a=t.props,i=a.height;return void 0===i&&(a.height=i=t.el.parent().getHeight()),i}},e),left:e,right:e}}()},"Ext.form.CheckboxGroup":{containerElCls:"checkboxgroup-container"},"Ext.form.field.Checkbox":{fieldSubTpl:["<tpl if=\"iconCls && (iconAlign=='left' || iconAlign=='top')\">",'<div class="{iconCls} x-form-cb-iconcls <tpl if="iconAlign==\'top\'">top</tpl>"></div>',"</tpl>","<tpl if=\"boxLabel && boxLabelAlign == 'before'\">","{beforeBoxLabelTpl}",'<label id="{cmpId}-boxLabelEl" {boxLabelAttrTpl} class="{boxLabelCls} {boxLabelCls}-{boxLabelAlign}" for="{id}">',"{beforeBoxLabelTextTpl}","{boxLabel}","{afterBoxLabelTextTpl}","</label>","{afterBoxLabelTpl}","</tpl>",'<div type="{inputTypeAttr}" id="{id}" {inputAttrTpl}','<tpl if="tabIdx"> tabIndex="{tabIdx}"</tpl>','<tpl if="disabled"> disabled="disabled"</tpl>','<tpl if="fieldStyle"> style="{fieldStyle}"</tpl>','<tpl if="ariaAttrs"> {ariaAttrs}</tpl>',' class="{fieldCls} {typeCls} {inputCls} {childElCls}" autocomplete="off" hidefocus="true" ></div>',"<tpl if=\"boxLabel && boxLabelAlign == 'after'\">","{beforeBoxLabelTpl}",'<label id="{cmpId}-boxLabelEl" {boxLabelAttrTpl} class="{boxLabelCls} {boxLabelCls}-{boxLabelAlign}" for="{id}">',"{beforeBoxLabelTextTpl}","{boxLabel}","{afterBoxLabelTextTpl}","</label>","{afterBoxLabelTpl}","</tpl>","<tpl if=\"iconCls && (iconAlign=='right' || iconAlign=='bottom')\">","<tpl if=\"iconAlign=='bottom'\">","</br>","</tpl>",'<div class="{iconCls} x-form-cb-iconcls" ></div>',"</tpl>",{disableFormats:!0,compiled:!0}],subTplInsertions:["beforeBoxLabelTpl","afterBoxLabelTpl","beforeBoxLabelTextTpl","afterBoxLabelTextTpl","boxLabelAttrTpl","inputAttrTpl","iconAlign","iconCls"],afterRender:function(){var e=this;e.callParent(arguments),e.boxLabelEl&&"switch"!=e.inputType&&e.boxLabelEl.on("click",e.onBoxClick,e)}}},init:function(){var me=this;Ext.iterate(me.obj,function(key,val){Ext.override(eval(key),val)});var field={initComponent:function(){var a=this;if(a.addEvents("setvalue","linkclick","labellinkclick"),"numberfield"==a.xtype&&1!=a.hideTrigger&&(a.clearButton=!1),0!=a.clearButton&&"text"==a.inputType&&(a.plugins=["clearbutton"],"textfield"!=a.xtype&&"textarea"!=a.xtype||!a.column||delete a.plugins),JE.isNotEmpty(a.unitListTpl)&&(a.unitListTpl=Ext.isString(a.unitListTpl)?JE.decode(a.unitListTpl):a.unitListTpl,Ext.each(a.unitListTpl,function(e){e.id=e.id||JE.uuid()})),JE.isNotEmpty(a.labelColor)&&(a.labelStyle=Ext.value(a.labelStyle,"")+"color:"+a.labelColor+";"),JE.isNotEmpty(a.fieldColor)&&(a.fieldStyle=Ext.value(a.fieldStyle,"")+"color:"+a.fieldColor+";"),!Ext.isEmpty(a.regex)&&Ext.isString(a.regex))try{a.regex=new RegExp(a.regex)}catch(e){JE.error("NaN字段:"+a.fieldLabel+"("+a.name+")</br>正则表达式:"+a.regex)}"textarea"==a.xtype&&(a.height=Ext.value(a.height,80),a.useFieldContainer&&JE.isNotEmpty(a.fieldLabel)&&"top"==a.labelAlign&&(a.height-="plus"==JE.getTheme()?34:28)),a.callParent(),Ext.isIE&&"fieldset"!=a.xtype&&a.on("resize",function(){var e=a.getEl().down(".je-field-label");-1!=["left","right"].indexOf(a.labelAlign)&&e&&e.setStyle("height",e.parent().getBox().height+"px");var t=a.getEl().down(".je-field-unittpl .unittpl-inner");t&&t.setStyle("height",t.parent().getBox().height+"px")})},setRawValue:function(){this.callParent(arguments),this.fireEvent("setvalue",this,this.value)},dirtyCls:Ext.baseCSSPrefix+"form-dirty",onDirtyChange:function(e){this.inputEl&&!this.isHidden()&&1==this.useDirty&&this.inputEl[e?"addCls":"removeCls"](this.dirtyCls)},setReadOnly:function(e){"x-form-field-notop"==this.fieldCls&&this.inputEl&&this.inputEl[e?"addCls":"removeCls"]("x-form-field-bottom"),this.callParent(arguments)},setAllowBlank:function(e,t){var a=this;a.allowBlank=e,0!=t&&a.validate&&a.validate();var i=a.getEl();a.useFieldContainer&&(i=a.ownerCt.getEl()),i[0==e?"addCls":"removeCls"]("je-field-required")},labelableRenderTpl:["<tpl if=\"labelAlign=='top'\">",'<tr role="presentation" class="{inputRowCls}">','<td role="presentation" class="je-field-label-top" colspan="2" id="{id}-labelCell" style="{labelCellStyle}" {labelCellAttrs}>',"{beforeLabelTpl}",'<div class="je-field-label" role="presentation" id="{id}-labelCell" style="{labelCellStyle}">','<label id="{id}-labelEl" {labelAttrTpl}<tpl if="bindLabel"><tpl if="inputId"> for="{inputId}"</tpl></tpl> class="{labelCls}"','<tpl if="labelStyle"> style="{labelStyle}"</tpl>',' unselectable="on"',">","{beforeLabelTextTpl}",'<tpl if="helpTpl"><i class="je-field-helptpl jeicon jeicon-question-circle"></i></tpl>','<tpl if="allowBlank==false"><span class="je-field-required-tpl"></span></tpl>','<tpl if="fieldLabel">{fieldLabel}<span class="je-field-label-separator">{labelSeparator}</span></tpl>',"{afterLabelTextTpl}","</label>","</div>","{afterLabelTpl}","</td>","{[this.getUnitTplTd(values)]}","</tr>","</tpl>",'<tr role="presentation" id="{id}-inputRow" <tpl if="inFormLayout">id="{id}"</tpl> class="{inputRowCls}">','<tpl if="labelOnLeft">','<td role="presentation" id="{id}-labelCell" style="{labelCellStyle}" {labelCellAttrs}>',"{beforeLabelTpl}",'<div class="je-field-label">','<label id="{id}-labelEl" {labelAttrTpl}<tpl if="bindLabel"><tpl if="inputId"> for="{inputId}"</tpl></tpl> class="{labelCls}"','<tpl if="labelStyle"> style="{labelStyle}"</tpl>',' unselectable="on"',">","{beforeLabelTextTpl}",'<tpl if="helpTpl"><i class="je-field-helptpl jeicon jeicon-question-circle"></i></tpl>','<tpl if="allowBlank==false"><span class="je-field-required-tpl"></span></tpl>','<tpl if="fieldLabel">{fieldLabel}<span class="je-field-label-separator">{labelSeparator}</span></tpl>',"{afterLabelTextTpl}","</label>","</div>","{afterLabelTpl}","</td>","</tpl>",'<td {fieldTdAttr} style = "{fieldBodyStyle}" role="presentation" class="{baseBodyCls} {fieldBodyCls} {extraFieldBodyCls} <tpl if="labelAlign==\'top\' && !hideLabel">je-field-label-top</tpl>"  id="{id}-bodyEl" colspan="{bodyColspan}" role="presentation">',"{beforeBodyEl}","{beforeSubTpl}","{[values.$comp.getSubTplMarkup(values)]}","{afterSubTpl}","<tpl if=\"msgTarget==='side'\">","{afterBodyEl}","</td>","<td role=\"presentation\" id=\"{id}-sideErrorCell\" vAlign=\"{[values.labelAlign==='top' && !values.hideLabel ? 'bottom' : 'middle']}\" style=\"{[values.autoFitErrors ? 'display:none' : '']}\" width=\"{errorIconWidth}\">",'<div role="presentation" id="{id}-errorEl" class="{errorMsgCls}" style="display:none"></div>',"</td>","<tpl elseif=\"msgTarget=='under'\">",'<div role="presentation" id="{id}-errorEl" class="{errorMsgClass}" colspan="2" style="display:none"></div>',"{afterBodyEl}","</td>","</tpl>",'<tpl if="unitListTpl">',"{% ","var width = 0,tpls=[],fieldId=values.id;","Ext.each(values.unitListTpl,function(obj){","\tif(JE.isNotEmpty(obj.text)){",'\tvar style="";',"\tif(JE.isNotEmpty(obj.handler)){",'\t\tstyle+="color: blue;cursor: pointer;";',"\t}","\tif(JE.isNotEmpty(obj.color)){",'\t\tstyle+="color:"+obj.color+";";',"\t}",'\tif(obj.bold == "1"){','\t\tstyle+="font-weight:bold;";',"\t}",'\tvar span = "<span id=\'"+fieldId+"_"+obj.id+"\' style=\'"+style+"\'>"+obj.text+"</span>";',"\ttpls.push(span);","   var _width = obj.text.strLen()*7;","\tif(JE.toNum(obj.width)>0){_width = JE.toNum(obj.width);}","   width += _width+7;","\t}","});","%}","{% ","if(width>0){%}",'<td class="je-field-unittpl" width = {[width]} ><div class="unittpl-inner" style="{unitTplStyle}">{[tpls.join("&nbsp;")]}</div></td>',"{%}%}",'<tpl elseif="unitTpl">',"{% ","var length = values.unitTpl.strLen(),width = length*7+(length<5?10:0);","if(values.unitTplWidth>0){width = values.unitTplWidth;}","%}",'<td class="je-field-unittpl" width = {[width]}><div class="unittpl-inner" style="{unitTplStyle}">{unitTpl}</div></td>',"</tpl>","</tr>",{disableFormats:!0,getUnitTplTd:function(e){var a=0;if(JE.isNotEmpty(e.unitListTpl))Ext.each(e.unitListTpl,function(e){if(JE.isNotEmpty(e.text)){var t=7*e.text.strLen();0<JE.toNum(e.width)&&(t=JE.toNum(e.width)),a+=t+7}});else if(e.unitTpl){var t=e.unitTpl.strLen();a=7*t+(t<5?10:0)}return 0<a?'<td width="'+a+'"></td>':""}}],getLabelableRenderData:function(){var e=this,t=e.callParent();return t.labelCellStyle+=Ext.value(e.labelBodyStyle,""),t.fieldBodyStyle=Ext.value(e.fieldBodyStyle,""),t.fieldTdAttr=Ext.value(e.fieldTdAttr,""),t.bindLabel=Ext.value(e.bindLabel,!1),t.helpTpl=Ext.value(e.helpTpl,""),JE.isNotEmpty(e.unitTpl)&&(t.unitTpl=Ext.value(e.unitTpl,""),t.unitTplWidth=JE.toNum(e.unitTplWidth),t.unitTplStyle=Ext.value(e.unitTplStyle,""),JE.isNotEmpty(e.unitTplHandler)&&(t.unitTplStyle+="cursor: pointer;")),JE.isNotEmpty(e.unitListTpl)&&(t.unitListTpl=e.unitListTpl),t},afterRender:function(){var t=this;if(t.callParent(),t.funcId&&"fieldcontainer"!=t.xtype&&(t.formObj=t.up("jeformview")),t.inputEl){var e=t.inputEl.dom;"TEXTAREA"===e.nodeName&&e.addEventListener&&(JE.loadScript("/static/ux/tabIndent.js"),tabIndent.render(t.inputEl.dom)),t.hasListener("linkclick")&&("TEXTAREA"===e.nodeName||"INPUT"===e.nodeName&&"text"==e.getAttribute("type"))&&(t.inputEl.setStyle({textDecoration:"underline",color:"blue",cursor:"pointer"}),t.inputEl.on("click",function(){t.fireEvent("linkclick",t)}))}t.hideLabel&&t.getEl().addCls("je-field-hidelabel"),t.labelEl&&(t.hideLabelText&&t.labelEl.addCls("je-field-hidelabeltext"),t.hasListener("labellinkclick")&&(t.labelEl.setStyle({textDecoration:"underline",color:"blue",cursor:"pointer"}),t.labelEl.on("click",function(){t.fireEvent("labellinkclick",t)})),"top"!=t.labelAlign&&t.getEl().hasCls("je-field-tablestyle")&&t.on("boxready",function(e){var t=e.labelEl.parent(),a=t.parent();t.setHeight(a.getHeight())}),JE.isNotEmpty(t.helpTpl)&&t.labelEl.on("click",function(e){e.getTarget(".je-field-helptpl",1)&&(t.hasListener("fieldhelp")?t.fireEvent("fieldhelp",t):JE.win({title:t.fieldLabel,width:660,height:400,buttonAlign:"center",autoScroll:!0,bodyStyle:"line-height:1.5;",html:t.helpTpl.replaceAll("\n","<br/>"),bodyPadding:"10",buttons:[{text:"关闭",cls:"btn JEPLUS_B_L10",width:100,handler:function(e){e.up("window").close()}}],autoShow:!0}),e.stopEvent())})),t.setAllowBlank&&t.setAllowBlank(t.allowBlank,!1),JE.isNotEmpty(t.unitListTpl)?Ext.each(t.unitListTpl,function(e){JE.isNotEmpty(e.handler)&&Ext.get(t.id+"_"+e.id).on("click",function(){e.readOnly&&t.readOnly||JE.eval(e.handler)(t)})}):JE.isNotEmpty(t.unitTpl)&&(t.unitTplEl=t.getEl().down(".je-field-unittpl .unittpl-inner"),JE.isNotEmpty(t.unitTplHandler)&&t.unitTplEl.on("click",function(){t.unitTplHandler(t)})),(JE.isNotEmpty(t.unitListTpl)||JE.isNotEmpty(t.unitTpl))&&t.on("boxready",function(e){var t=e.getEl().down(".je-field-unittpl .unittpl-inner");if(t){var a=t.parent();t.setHeight(a.getHeight()),a.prev().addCls("je-field-unittpl-prev")}})},commitChange:function(){this.resetOriginalValue()},reset:function(){var e=this;e.beforeReset(),e.setValue(JE.toDefVal(e.initialConfig.value)),e.clearInvalid(),delete e.wasValid},childEls:["labelCell","labelEl","bodyEl","sideErrorCell","errorEl","inputRow","requiredEl"]};Ext.override(Ext.form.field.Base,field),field.childEls=["containerEl","requiredEl"],delete field.initComponent,delete field.setValue,delete field.commitChange,field.initComponent=function(){var a=this;JE.isNotEmpty(a.labelColor)&&(a.labelStyle=Ext.value(a.labelStyle,"")+"color:"+a.labelColor+";"),JE.isNotEmpty(a.fieldColor)&&(a.fieldStyle=Ext.value(a.fieldStyle,"")+"color:"+a.fieldColor+";"),JE.isNotEmpty(a.unitListTpl)&&(a.unitListTpl=Ext.isString(a.unitListTpl)?JE.decode(a.unitListTpl):a.unitListTpl,Ext.each(a.unitListTpl,function(e){e.id=e.id||JE.uuid()})),a.callParent(),Ext.isIE&&"fieldset"!=a.xtype&&a.on("resize",function(){var e=a.getEl().down(".je-field-label");-1!=["left","right"].indexOf(a.labelAlign)&&e&&e.setStyle("height",e.parent().getBox().height+"px");var t=a.getEl().down(".je-field-unittpl .unittpl-inner");t&&t.setStyle("height",t.parent().getBox().height+"px")})},Ext.override(Ext.form.FieldContainer,field),String.prototype.strLen=function(){for(var e=0,t=0;t<this.length;t++)255<this.charCodeAt(t)||this.charCodeAt(t)<0?e+=2:e++;return e},autoAddEllipsis=function(e,t){var a=cutString(e,t),i=a.cutflag,r=a.cutstring;return"1"==i?r+"...":r},cutString=function(e,t){var a,i=e.length,r="1",o=0,l=!1;if(i<=t/2&&(a=e,l=!0),!l)for(var n=0;n<i;n++){if(isFull(e.charAt(n))?o+=2:o+=1,t<o){a=e.substring(0,n),l=!0;break}if(o==t){a=e.substring(0,n+1),l=!0;break}}return l||(a=e,l=!0),a.length==i&&(r="0"),{cutstring:a,cutflag:r}},isFull=function(e){return 128<e.charCodeAt(0)},String.prototype.ellipsis=function(e){return autoAddEllipsis(this,2*e)},String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"gm"),t)},String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")},String.prototype.ltrim=function(){return this.replace(/(^\s*)/g,"")},String.prototype.rtrim=function(){return this.replace(/(\s*$)/g,"")},Array.prototype.indexOf=function(e){for(var t=-1,a=0;a<this.length;++a)this[a]==e&&(t=a);return t}}}),Ext.define("JE.util.PinYinUtil",{toPinYin:function(e,t){if(!e)return"";for(var a={a:"啊阿锕",ai:"埃挨哎唉哀皑癌蔼矮艾碍爱隘诶捱嗳嗌嫒瑷暧砹锿霭",an:"鞍氨安俺按暗岸胺案谙埯揞犴庵桉铵鹌顸黯",ang:"肮昂盎",ao:"凹敖熬翱袄傲奥懊澳坳拗嗷噢岙廒遨媪骜聱螯鏊鳌鏖",ba:"芭捌扒叭吧笆八疤巴拔跋靶把耙坝霸罢爸茇菝萆捭岜灞杷钯粑鲅魃",bai:"白柏百摆佰败拜稗薜掰鞴",ban:"斑班搬扳般颁板版扮拌伴瓣半办绊阪坂豳钣瘢癍舨",bang:"邦帮梆榜膀绑棒磅蚌镑傍谤蒡螃",bao:"苞胞包褒雹保堡饱宝抱报暴豹鲍爆勹葆宀孢煲鸨褓趵龅",bo:"剥薄玻菠播拨钵波博勃搏铂箔伯帛舶脖膊渤泊驳亳蕃啵饽檗擘礴钹鹁簸跛",bei:"杯碑悲卑北辈背贝钡倍狈备惫焙被孛陂邶埤蓓呗怫悖碚鹎褙鐾",ben:"奔苯本笨畚坌锛",beng:"崩绷甭泵蹦迸唪嘣甏",bi:"逼鼻比鄙笔彼碧蓖蔽毕毙毖币庇痹闭敝弊必辟壁臂避陛匕仳俾芘荜荸吡哔狴庳愎滗濞弼妣婢嬖璧贲畀铋秕裨筚箅篦舭襞跸髀",bian:"鞭边编贬扁便变卞辨辩辫遍匾弁苄忭汴缏煸砭碥稹窆蝙笾鳊",biao:"标彪膘表婊骠飑飙飚灬镖镳瘭裱鳔",bie:"鳖憋别瘪蹩鳘",bin:"彬斌濒滨宾摈傧浜缤玢殡膑镔髌鬓",bing:"兵冰柄丙秉饼炳病并禀邴摒绠枋槟燹",bu:"捕卜哺补埠不布步簿部怖拊卟逋瓿晡钚醭",ca:"擦嚓礤",cai:"猜裁材才财睬踩采彩菜蔡",can:"餐参蚕残惭惨灿骖璨粲黪",cang:"苍舱仓沧藏伧",cao:"操糙槽曹草艹嘈漕螬艚",ce:"厕策侧册测刂帻恻",ceng:"层蹭噌",cha:"插叉茬茶查碴搽察岔差诧猹馇汊姹杈楂槎檫钗锸镲衩",chai:"拆柴豺侪茈瘥虿龇",chan:"搀掺蝉馋谗缠铲产阐颤冁谄谶蒇廛忏潺澶孱羼婵嬗骣觇禅镡裣蟾躔",chang:"昌猖场尝常长偿肠厂敞畅唱倡伥鬯苌菖徜怅惝阊娼嫦昶氅鲳",chao:"超抄钞朝嘲潮巢吵炒怊绉晁耖",che:"车扯撤掣彻澈坼屮砗",chen:"郴臣辰尘晨忱沉陈趁衬称谌抻嗔宸琛榇肜胂碜龀",cheng:"撑城橙成呈乘程惩澄诚承逞骋秤埕嵊徵浈枨柽樘晟塍瞠铖裎蛏酲",chi:"吃痴持匙池迟弛驰耻齿侈尺赤翅斥炽傺墀芪茌搋叱哧啻嗤彳饬沲媸敕胝眙眵鸱瘛褫蚩螭笞篪豉踅踟魑",chong:"充冲虫崇宠茺忡憧铳艟",chou:"抽酬畴踌稠愁筹仇绸瞅丑俦圳帱惆溴妯瘳雠鲋",chu:"臭初出橱厨躇锄雏滁除楚础储矗搐触处亍刍憷绌杵楮樗蜍蹰黜",chuan:"揣川穿椽传船喘串掾舛惴遄巛氚钏镩舡",chuang:"疮窗幢床闯创怆",chui:"吹炊捶锤垂陲棰槌",chun:"春椿醇唇淳纯蠢促莼沌肫朐鹑蝽",chuo:"戳绰蔟辶辍镞踔龊",ci:"疵茨磁雌辞慈瓷词此刺赐次荠呲嵯鹚螅糍趑",cong:"聪葱囱匆从丛偬苁淙骢琮璁枞",cu:"凑粗醋簇猝殂蹙",cuan:"蹿篡窜汆撺昕爨",cui:"摧崔催脆瘁粹淬翠萃悴璀榱隹",cun:"村存寸磋忖皴",cuo:"撮搓措挫错厝脞锉矬痤鹾蹉躜",da:"搭达答瘩打大耷哒嗒怛妲疸褡笪靼鞑",dai:"呆歹傣戴带殆代贷袋待逮怠埭甙呔岱迨逯骀绐玳黛",dan:"耽担丹单郸掸胆旦氮但惮淡诞弹蛋亻儋卩萏啖澹檐殚赕眈瘅聃箪",dang:"当挡党荡档谠凼菪宕砀铛裆",dao:"刀捣蹈倒岛祷导到稻悼道盗叨啁忉洮氘焘忑纛",de:"德得的锝",deng:"蹬灯登等瞪凳邓噔嶝戥磴镫簦",di:"堤低滴迪敌笛狄涤翟嫡抵底地蒂第帝弟递缔氐籴诋谛邸坻莜荻嘀娣柢棣觌砥碲睇镝羝骶",dian:"颠掂滇碘点典靛垫电佃甸店惦奠淀殿丶阽坫埝巅玷癜癫簟踮",diao:"碉叼雕凋刁掉吊钓调轺铞蜩粜貂",die:"跌爹碟蝶迭谍叠佚垤堞揲喋渫轶牒瓞褶耋蹀鲽鳎",ding:"丁盯叮钉顶鼎锭定订丢仃啶玎腚碇町铤疔耵酊",dong:"东冬董懂动栋侗恫冻洞垌咚岽峒夂氡胨胴硐鸫",dou:"兜抖斗陡豆逗痘蔸钭窦窬蚪篼酡",du:"都督毒犊独读堵睹赌杜镀肚度渡妒芏嘟渎椟橐牍蠹笃髑黩",duan:"端短锻段断缎彖椴煅簖",dui:"堆兑队对怼憝碓",dun:"墩吨蹲敦顿囤钝盾遁炖砘礅盹镦趸",duo:"掇哆多夺垛躲朵跺舵剁惰堕咄哚缍柁铎裰踱",e:"蛾峨鹅俄额讹娥恶厄扼遏鄂饿噩谔垩垭苊莪萼呃愕屙婀轭曷腭硪锇锷鹗颚鳄",en:"恩蒽摁唔嗯",er:"而儿耳尔饵洱二贰迩珥铒鸸鲕",fa:"发罚筏伐乏阀法珐垡砝",fan:"藩帆番翻樊矾钒繁凡烦反返范贩犯饭泛蘩幡犭梵攵燔畈蹯",fang:"坊芳方肪房防妨仿访纺放匚邡彷钫舫鲂",fei:"菲非啡飞肥匪诽吠肺废沸费芾狒悱淝妃绋绯榧腓斐扉祓砩镄痱蜚篚翡霏鲱",fen:"芬酚吩氛分纷坟焚汾粉奋份忿愤粪偾瀵棼愍鲼鼢",feng:"丰封枫蜂峰锋风疯烽逢冯缝讽奉凤俸酆葑沣砜",fu:"佛否夫敷肤孵扶拂辐幅氟符伏俘服浮涪福袱弗甫抚辅俯釜斧脯腑府腐赴副覆赋复傅付阜父腹负富讣附妇缚咐匐凫郛芙苻茯莩菔呋幞滏艴孚驸绂桴赙黻黼罘稃馥虍蚨蜉蝠蝮麸趺跗鳆",ga:"噶嘎蛤尬呷尕尜旮钆",gai:"该改概钙盖溉丐陔垓戤赅胲",gan:"干甘杆柑竿肝赶感秆敢赣坩苷尴擀泔淦澉绀橄旰矸疳酐",gang:"冈刚钢缸肛纲岗港戆罡颃筻",gong:"杠工攻功恭龚供躬公宫弓巩汞拱贡共蕻廾咣珙肱蚣蛩觥",gao:"篙皋高膏羔糕搞镐稿告睾诰郜蒿藁缟槔槁杲锆",ge:"哥歌搁戈鸽胳疙割革葛格阁隔铬个各鬲仡哿塥嗝纥搿膈硌铪镉袼颌虼舸骼髂",gei:"给",gen:"根跟亘茛哏艮",geng:"耕更庚羹埂耿梗哽赓鲠",gou:"钩勾沟苟狗垢构购够佝诟岣遘媾缑觏彀鸲笱篝鞲",gu:"辜菇咕箍估沽孤姑鼓古蛊骨谷股故顾固雇嘏诂菰哌崮汩梏轱牯牿胍臌毂瞽罟钴锢瓠鸪鹄痼蛄酤觚鲴骰鹘",gua:"刮瓜剐寡挂褂卦诖呱栝鸹",guai:"乖拐怪哙",guan:"棺关官冠观管馆罐惯灌贯倌莞掼涫盥鹳鳏",guang:"光广逛犷桄胱疒",gui:"瑰规圭硅归龟闺轨鬼诡癸桂柜跪贵刽匦刿庋宄妫桧炅晷皈簋鲑鳜",gun:"辊滚棍丨衮绲磙鲧",guo:"锅郭国果裹过馘蠃埚掴呙囗帼崞猓椁虢锞聒蜮蜾蝈",ha:"哈",hai:"骸孩海氦亥害骇咴嗨颏醢",han:"酣憨邯韩含涵寒函喊罕翰撼捍旱憾悍焊汗汉邗菡撖阚瀚晗焓颔蚶鼾",hen:"夯痕很狠恨",hang:"杭航沆绗珩桁",hao:"壕嚎豪毫郝好耗号浩薅嗥嚆濠灏昊皓颢蚝",he:"呵喝荷菏核禾和何合盒貉阂河涸赫褐鹤贺诃劾壑藿嗑嗬阖盍蚵翮",hei:"嘿黑",heng:"哼亨横衡恒訇蘅",hong:"轰哄烘虹鸿洪宏弘红黉讧荭薨闳泓",hou:"喉侯猴吼厚候后堠後逅瘊篌糇鲎骺",hu:"呼乎忽瑚壶葫胡蝴狐糊湖弧虎唬护互沪户冱唿囫岵猢怙惚浒滹琥槲轷觳烀煳戽扈祜鹕鹱笏醐斛",hua:"花哗华猾滑画划化话劐浍骅桦铧稞",huai:"槐徊怀淮坏还踝",huan:"欢环桓缓换患唤痪豢焕涣宦幻郇奂垸擐圜洹浣漶寰逭缳锾鲩鬟",huang:"荒慌黄磺蝗簧皇凰惶煌晃幌恍谎隍徨湟潢遑璜肓癀蟥篁鳇",hui:"灰挥辉徽恢蛔回毁悔慧卉惠晦贿秽会烩汇讳诲绘诙茴荟蕙哕喙隳洄彗缋珲晖恚虺蟪麾",hun:"荤昏婚魂浑混诨馄阍溷缗",huo:"豁活伙火获或惑霍货祸攉嚯夥钬锪镬耠蠖",ji:"击圾基机畸稽积箕肌饥迹激讥鸡姬绩缉吉极棘辑籍集及急疾汲即嫉级挤几脊己蓟技冀季伎祭剂悸济寄寂计记既忌际妓继纪居丌乩剞佶佴脔墼芨芰萁蒺蕺掎叽咭哜唧岌嵴洎彐屐骥畿玑楫殛戟戢赍觊犄齑矶羁嵇稷瘠瘵虮笈笄暨跻跽霁鲚鲫髻麂",jia:"嘉枷夹佳家加荚颊贾甲钾假稼价架驾嫁伽郏拮岬浃迦珈戛胛恝铗镓痂蛱笳袈跏",jian:"歼监坚尖笺间煎兼肩艰奸缄茧检柬碱硷拣捡简俭剪减荐槛鉴践贱见键箭件健舰剑饯渐溅涧建僭谏谫菅蒹搛囝湔蹇謇缣枧柙楗戋戬牮犍毽腱睑锏鹣裥笕箴翦趼踺鲣鞯",jiang:"僵姜将浆江疆蒋桨奖讲匠酱降茳洚绛缰犟礓耩糨豇",jiao:"蕉椒礁焦胶交郊浇骄娇嚼搅铰矫侥脚狡角饺缴绞剿教酵轿较叫佼僬茭挢噍峤徼姣纟敫皎鹪蛟醮跤鲛",jie:"窖揭接皆秸街阶截劫节桔杰捷睫竭洁结解姐戒藉芥界借介疥诫届偈讦诘喈嗟獬婕孑桀獒碣锴疖袷颉蚧羯鲒骱髫",jin:"巾筋斤金今津襟紧锦仅谨进靳晋禁近烬浸尽卺荩堇噤馑廑妗缙瑾槿赆觐钅锓衿矜",jing:"劲荆兢茎睛晶鲸京惊精粳经井警景颈静境敬镜径痉靖竟竞净刭儆阱菁獍憬泾迳弪婧肼胫腈旌",jiong:"炯窘冂迥扃",jiu:"揪究纠玖韭久灸九酒厩救旧臼舅咎就疚僦啾阄柩桕鹫赳鬏",ju:"鞠拘狙疽驹菊局咀矩举沮聚拒据巨具距踞锯俱句惧炬剧倨讵苣苴莒掬遽屦琚枸椐榘榉橘犋飓钜锔窭裾趄醵踽龃雎鞫",juan:"捐鹃娟倦眷卷绢鄄狷涓桊蠲锩镌隽",jue:"撅攫抉掘倔爵觉决诀绝厥劂谲矍蕨噘崛獗孓珏桷橛爝镢蹶觖",jun:"均菌钧军君峻俊竣浚郡骏捃狻皲筠麇",ka:"喀咖卡佧咔胩",ke:"咯坷苛柯棵磕颗科壳咳可渴克刻客课岢恪溘骒缂珂轲氪瞌钶疴窠蝌髁",kai:"开揩楷凯慨剀垲蒈忾恺铠锎",kan:"刊堪勘坎砍看侃凵莰莶戡龛瞰",kang:"康慷糠扛抗亢炕坑伉闶钪",kao:"考拷烤靠尻栲犒铐",ken:"肯啃垦恳垠裉颀",keng:"吭忐铿",kong:"空恐孔控倥崆箜",kou:"抠口扣寇芤蔻叩眍筘",ku:"枯哭窟苦酷库裤刳堀喾绔骷",kua:"夸垮挎跨胯侉",kuai:"块筷侩快蒯郐蒉狯脍",kuan:"宽款髋",kuang:"匡筐狂框矿眶旷况诓诳邝圹夼哐纩贶",kui:"亏盔岿窥葵奎魁傀馈愧溃馗匮夔隗揆喹喟悝愦阕逵暌睽聩蝰篑臾跬",kun:"坤昆捆困悃阃琨锟醌鲲髡",kuo:"括扩廓阔蛞",la:"垃拉喇蜡腊辣啦剌摺邋旯砬瘌",lai:"莱来赖崃徕涞濑赉睐铼癞籁",lan:"蓝婪栏拦篮阑兰澜谰揽览懒缆烂滥啉岚懔漤榄斓罱镧褴",lang:"琅榔狼廊郎朗浪莨蒗啷阆锒稂螂",lao:"捞劳牢老佬姥酪烙涝唠崂栳铑铹痨醪",le:"勒乐肋仂叻嘞泐鳓",lei:"雷镭蕾磊累儡垒擂类泪羸诔荽咧漯嫘缧檑耒酹",ling:"棱冷拎玲菱零龄铃伶羚凌灵陵岭领另令酃塄苓呤囹泠绫柃棂瓴聆蛉翎鲮",leng:"楞愣",li:"厘梨犁黎篱狸离漓理李里鲤礼莉荔吏栗丽厉励砾历利傈例俐痢立粒沥隶力璃哩俪俚郦坜苈莅蓠藜捩呖唳喱猁溧澧逦娌嫠骊缡珞枥栎轹戾砺詈罹锂鹂疠疬蛎蜊蠡笠篥粝醴跞雳鲡鳢黧",lian:"俩联莲连镰廉怜涟帘敛脸链恋炼练挛蔹奁潋濂娈琏楝殓臁膦裢蠊鲢",liang:"粮凉梁粱良两辆量晾亮谅墚椋踉靓魉",liao:"撩聊僚疗燎寥辽潦了撂镣廖料蓼尥嘹獠寮缭钌鹩耢",lie:"列裂烈劣猎冽埒洌趔躐鬣",lin:"琳林磷霖临邻鳞淋凛赁吝蔺嶙廪遴檩辚瞵粼躏麟",liu:"溜琉榴硫馏留刘瘤流柳六抡偻蒌泖浏遛骝绺旒熘锍镏鹨鎏",long:"龙聋咙笼窿隆垄拢陇弄垅茏泷珑栊胧砻癃",lou:"楼娄搂篓漏陋喽嵝镂瘘耧蝼髅",lu:"芦卢颅庐炉掳卤虏鲁麓碌露路赂鹿潞禄录陆戮垆摅撸噜泸渌漉璐栌橹轳辂辘氇胪镥鸬鹭簏舻鲈",lv:"驴吕铝侣旅履屡缕虑氯律率滤绿捋闾榈膂稆褛",luan:"峦孪滦卵乱栾鸾銮",lue:"掠略锊",lun:"轮伦仑沦纶论囵",luo:"萝螺罗逻锣箩骡裸落洛骆络倮荦摞猡泺椤脶镙瘰雒",ma:"妈麻玛码蚂马骂嘛吗唛犸嬷杩麽",mai:"埋买麦卖迈脉劢荬咪霾",man:"瞒馒蛮满蔓曼慢漫谩墁幔缦熳镘颟螨鳗鞔",mang:"芒茫盲忙莽邙漭朦硭蟒",meng:"氓萌蒙檬盟锰猛梦孟勐甍瞢懵礞虻蜢蠓艋艨黾",miao:"猫苗描瞄藐秒渺庙妙喵邈缈缪杪淼眇鹋蜱",mao:"茅锚毛矛铆卯茂冒帽貌贸侔袤勖茆峁瑁昴牦耄旄懋瞀蛑蝥蟊髦",me:"么",mei:"玫枚梅酶霉煤没眉媒镁每美昧寐妹媚坶莓嵋猸浼湄楣镅鹛袂魅",men:"门闷们扪玟焖懑钔",mi:"眯醚靡糜迷谜弥米秘觅泌蜜密幂芈冖谧蘼嘧猕獯汨宓弭脒敉糸縻麋",mian:"棉眠绵冕免勉娩缅面沔湎腼眄",mie:"蔑灭咩蠛篾",min:"民抿皿敏悯闽苠岷闵泯珉",ming:"明螟鸣铭名命冥茗溟暝瞑酩",miu:"谬",mo:"摸摹蘑模膜磨摩魔抹末莫墨默沫漠寞陌谟茉蓦馍嫫镆秣瘼耱蟆貊貘",mou:"谋牟某厶哞婺眸鍪",mu:"拇牡亩姆母墓暮幕募慕木目睦牧穆仫苜呒沐毪钼",na:"拿哪呐钠那娜纳内捺肭镎衲箬",nai:"氖乃奶耐奈鼐艿萘柰",nan:"南男难囊喃囡楠腩蝻赧",nao:"挠脑恼闹孬垴猱瑙硇铙蛲",ne:"淖呢讷",nei:"馁",nen:"嫩能枘恁",ni:"妮霓倪泥尼拟你匿腻逆溺伲坭猊怩滠昵旎祢慝睨铌鲵",nian:"蔫拈年碾撵捻念廿辇黏鲇鲶",niang:"娘酿",niao:"鸟尿茑嬲脲袅",nie:"捏聂孽啮镊镍涅乜陧蘖嗫肀颞臬蹑",nin:"您柠",ning:"狞凝宁拧泞佞蓥咛甯聍",niu:"牛扭钮纽狃忸妞蚴",nong:"脓浓农侬",nu:"奴努怒呶帑弩胬孥驽",nv:"女恧钕衄",nuan:"暖",nuenue:"虐",nue:"疟谑",nuo:"挪懦糯诺傩搦喏锘",ou:"哦欧鸥殴藕呕偶沤怄瓯耦",pa:"啪趴爬帕怕琶葩筢",pai:"拍排牌徘湃派俳蒎",pan:"攀潘盘磐盼畔判叛爿泮袢襻蟠蹒",pang:"乓庞旁耪胖滂逄",pao:"抛咆刨炮袍跑泡匏狍庖脬疱",pei:"呸胚培裴赔陪配佩沛掊辔帔淠旆锫醅霈",pen:"喷盆湓",peng:"砰抨烹澎彭蓬棚硼篷膨朋鹏捧碰坯堋嘭怦蟛",pi:"砒霹批披劈琵毗啤脾疲皮匹痞僻屁譬丕陴邳郫圮鼙擗噼庀媲纰枇甓睥罴铍痦癖疋蚍貔",pian:"篇偏片骗谝骈犏胼褊翩蹁",piao:"飘漂瓢票剽嘌嫖缥殍瞟螵",pie:"撇瞥丿苤氕",pin:"拼频贫品聘拚姘嫔榀牝颦",ping:"乒坪苹萍平凭瓶评屏俜娉枰鲆",po:"坡泼颇婆破魄迫粕叵鄱溥珀钋钷皤笸",pou:"剖裒踣",pu:"扑铺仆莆葡菩蒲埔朴圃普浦谱曝瀑匍噗濮璞氆镤镨蹼",qi:"期欺栖戚妻七凄漆柒沏其棋奇歧畦崎脐齐旗祈祁骑起岂乞企启契砌器气迄弃汽泣讫亟亓圻芑萋葺嘁屺岐汔淇骐绮琪琦杞桤槭欹祺憩碛蛴蜞綦綮趿蹊鳍麒",qia:"掐恰洽葜",qian:"牵扦钎铅千迁签仟谦乾黔钱钳前潜遣浅谴堑嵌欠歉佥阡芊芡荨掮岍悭慊骞搴褰缱椠肷愆钤虔箝",qiang:"枪呛腔羌墙蔷强抢嫱樯戗炝锖锵镪襁蜣羟跫跄",qiao:"橇锹敲悄桥瞧乔侨巧鞘撬翘峭俏窍劁诮谯荞愀憔缲樵毳硗跷鞒",qie:"切茄且怯窃郄唼惬妾挈锲箧",qin:"钦侵亲秦琴勤芹擒禽寝沁芩蓁蕲揿吣嗪噙溱檎螓衾",qing:"青轻氢倾卿清擎晴氰情顷请庆倩苘圊檠磬蜻罄箐謦鲭黥",qiong:"琼穷邛茕穹筇銎",qiu:"秋丘邱球求囚酋泅俅氽巯艽犰湫逑遒楸赇鸠虬蚯蝤裘糗鳅鼽",qu:"趋区蛆曲躯屈驱渠取娶龋趣去诎劬蕖蘧岖衢阒璩觑氍祛磲癯蛐蠼麴瞿黢",quan:"圈颧权醛泉全痊拳犬券劝诠荃獾悛绻辁畎铨蜷筌鬈",que:"缺炔瘸却鹊榷确雀阙悫",qun:"裙群逡",ran:"然燃冉染苒髯",rang:"瓤壤攘嚷让禳穰",rao:"饶扰绕荛娆桡",ruo:"惹若弱",re:"热偌",ren:"壬仁人忍韧任认刃妊纫仞荏葚饪轫稔衽",reng:"扔仍",ri:"日",rong:"戎茸蓉荣融熔溶容绒冗嵘狨缛榕蝾",rou:"揉柔肉糅蹂鞣",ru:"茹蠕儒孺如辱乳汝入褥蓐薷嚅洳溽濡铷襦颥",ruan:"软阮朊",rui:"蕊瑞锐芮蕤睿蚋",run:"闰润",sa:"撒洒萨卅仨挲飒",sai:"腮鳃塞赛噻",san:"三叁伞散彡馓氵毵糁霰",sang:"桑嗓丧搡磉颡",sao:"搔骚扫嫂埽臊瘙鳋",se:"瑟色涩啬铩铯穑",sen:"森",seng:"僧",sha:"莎砂杀刹沙纱傻啥煞脎歃痧裟霎鲨",shai:"筛晒酾",shan:"珊苫杉山删煽衫闪陕擅赡膳善汕扇缮剡讪鄯埏芟潸姗骟膻钐疝蟮舢跚鳝",shang:"墒伤商赏晌上尚裳垧绱殇熵觞",shao:"梢捎稍烧芍勺韶少哨邵绍劭苕潲蛸笤筲艄",she:"奢赊蛇舌舍赦摄射慑涉社设厍佘猞畲麝",shen:"砷申呻伸身深娠绅神沈审婶甚肾慎渗诜谂吲哂渖椹矧蜃",sheng:"声生甥牲升绳省盛剩胜圣丞渑媵眚笙",shi:"师失狮施湿诗尸虱十石拾时什食蚀实识史矢使屎驶始式示士世柿事拭誓逝势是嗜噬适仕侍释饰氏市恃室视试谥埘莳蓍弑唑饣轼耆贳炻礻铈铊螫舐筮豕鲥鲺",shou:"收手首守寿授售受瘦兽扌狩绶艏",shu:"蔬枢梳殊抒输叔舒淑疏书赎孰熟薯暑曙署蜀黍鼠属术述树束戍竖墅庶数漱恕倏塾菽忄沭涑澍姝纾毹腧殳镯秫鹬",shua:"刷耍唰涮",shuai:"摔衰甩帅蟀",shuan:"栓拴闩",shuang:"霜双爽孀",shui:"谁水睡税",shun:"吮瞬顺舜恂",shuo:"说硕朔烁蒴搠嗍濯妁槊铄",si:"斯撕嘶思私司丝死肆寺嗣四伺似饲巳厮俟兕菥咝汜泗澌姒驷缌祀祠锶鸶耜蛳笥",song:"松耸怂颂送宋讼诵凇菘崧嵩忪悚淞竦",sou:"搜艘擞嗽叟嗖嗾馊溲飕瞍锼螋",su:"苏酥俗素速粟僳塑溯宿诉肃夙谡蔌嗉愫簌觫稣",suan:"酸蒜算",sui:"虽隋随绥髓碎岁穗遂隧祟蓑冫谇濉邃燧眭睢",sun:"孙损笋荪狲飧榫跣隼",suo:"梭唆缩琐索锁所唢嗦娑桫睃羧",ta:"塌他它她塔獭挞蹋踏闼溻遢榻沓",tai:"胎苔抬台泰酞太态汰邰薹肽炱钛跆鲐",tan:"坍摊贪瘫滩坛檀痰潭谭谈坦毯袒碳探叹炭郯蕈昙钽锬覃",tang:"汤塘搪堂棠膛唐糖傥饧溏瑭铴镗耥螗螳羰醣",thang:"倘躺淌",theng:"趟烫",tao:"掏涛滔绦萄桃逃淘陶讨套挑鼗啕韬饕",te:"特",teng:"藤腾疼誊滕",ti:"梯剔踢锑提题蹄啼体替嚏惕涕剃屉荑悌逖绨缇鹈裼醍",tian:"天添填田甜恬舔腆掭忝阗殄畋钿蚺",tiao:"条迢眺跳佻祧铫窕龆鲦",tie:"贴铁帖萜餮",ting:"厅听烃汀廷停亭庭挺艇莛葶婷梃蜓霆",tong:"通桐酮瞳同铜彤童桶捅筒统痛佟僮仝茼嗵恸潼砼",tou:"偷投头透亠",tu:"凸秃突图徒途涂屠土吐兔堍荼菟钍酴",tuan:"湍团疃",tui:"推颓腿蜕褪退忒煺",tun:"吞屯臀饨暾豚窀",tuo:"拖托脱鸵陀驮驼椭妥拓唾乇佗坨庹沱柝砣箨舄跎鼍",wa:"挖哇蛙洼娃瓦袜佤娲腽",wai:"歪外",wan:"豌弯湾玩顽丸烷完碗挽晚皖惋宛婉万腕剜芄苋菀纨绾琬脘畹蜿箢",wang:"汪王亡枉网往旺望忘妄罔尢惘辋魍",wei:"威巍微危韦违桅围唯惟为潍维苇萎委伟伪尾纬未蔚味畏胃喂魏位渭谓尉慰卫倭偎诿隈葳薇帏帷崴嵬猥猬闱沩洧涠逶娓玮韪軎炜煨熨痿艉鲔",wen:"瘟温蚊文闻纹吻稳紊问刎愠阌汶璺韫殁雯",weng:"嗡翁瓮蓊蕹",wo:"挝蜗涡窝我斡卧握沃莴幄渥杌肟龌",wu:"巫呜钨乌污诬屋无芜梧吾吴毋武五捂午舞伍侮坞戊雾晤物勿务悟误兀仵阢邬圬芴庑怃忤浯寤迕妩骛牾焐鹉鹜蜈鋈鼯",xi:"昔熙析西硒矽晰嘻吸锡牺稀息希悉膝夕惜熄烯溪汐犀檄袭席习媳喜铣洗系隙戏细僖兮隰郗茜葸蓰奚唏徙饩阋浠淅屣嬉玺樨曦觋欷熹禊禧钸皙穸蜥蟋舾羲粞翕醯鼷",xia:"瞎虾匣霞辖暇峡侠狭下厦夏吓掀葭嗄狎遐瑕硖瘕罅黠",xian:"锨先仙鲜纤咸贤衔舷闲涎弦嫌显险现献县腺馅羡宪陷限线冼藓岘猃暹娴氙祆鹇痫蚬筅籼酰跹",xiang:"相厢镶香箱襄湘乡翔祥详想响享项巷橡像向象芗葙饷庠骧缃蟓鲞飨",xiao:"萧硝霄削哮嚣销消宵淆晓小孝校肖啸笑效哓咻崤潇逍骁绡枭枵筱箫魈",xie:"楔些歇蝎鞋协挟携邪斜胁谐写械卸蟹懈泄泻谢屑偕亵勰燮薤撷廨瀣邂绁缬榭榍歙躞",xin:"薪芯锌欣辛新忻心信衅囟馨莘歆铽鑫",xing:"星腥猩惺兴刑型形邢行醒幸杏性姓陉荇荥擤悻硎",xiong:"兄凶胸匈汹雄熊芎",xiu:"休修羞朽嗅锈秀袖绣莠岫馐庥鸺貅髹",xu:"墟戌需虚嘘须徐许蓄酗叙旭序畜恤絮婿绪续讴诩圩蓿怵洫溆顼栩煦砉盱胥糈醑",xuan:"轩喧宣悬旋玄选癣眩绚儇谖萱揎馔泫洵渲漩璇楦暄炫煊碹铉镟痃",xue:"靴薛学穴雪血噱泶鳕",xun:"勋熏循旬询寻驯巡殉汛训讯逊迅巽埙荀薰峋徇浔曛窨醺鲟",ya:"压押鸦鸭呀丫芽牙蚜崖衙涯雅哑亚讶伢揠吖岈迓娅琊桠氩砑睚痖",yan:"焉咽阉烟淹盐严研蜒岩延言颜阎炎沿奄掩眼衍演艳堰燕厌砚雁唁彦焰宴谚验厣靥赝俨偃兖讠谳郾鄢芫菸崦恹闫阏洇湮滟妍嫣琰晏胭腌焱罨筵酽魇餍鼹",yang:"殃央鸯秧杨扬佯疡羊洋阳氧仰痒养样漾徉怏泱炀烊恙蛘鞅",yao:"邀腰妖瑶摇尧遥窑谣姚咬舀药要耀夭爻吆崾徭瀹幺珧杳曜肴鹞窈繇鳐",ye:"椰噎耶爷野冶也页掖业叶曳腋夜液谒邺揶馀晔烨铘",yi:"一壹医揖铱依伊衣颐夷遗移仪胰疑沂宜姨彝椅蚁倚已乙矣以艺抑易邑屹亿役臆逸肄疫亦裔意毅忆义益溢诣议谊译异翼翌绎刈劓佾诒圪圯埸懿苡薏弈奕挹弋呓咦咿噫峄嶷猗饴怿怡悒漪迤驿缢殪贻旖熠钇镒镱痍瘗癔翊衤蜴舣羿翳酏黟",yin:"茵荫因殷音阴姻吟银淫寅饮尹引隐印胤鄞堙茚喑狺夤氤铟瘾蚓霪龈",ying:"英樱婴鹰应缨莹萤营荧蝇迎赢盈影颖硬映嬴郢茔莺萦撄嘤膺滢潆瀛瑛璎楹鹦瘿颍罂",yo:"哟唷",yong:"拥佣臃痈庸雍踊蛹咏泳涌永恿勇用俑壅墉慵邕镛甬鳙饔",you:"幽优悠忧尤由邮铀犹油游酉有友右佑釉诱又幼卣攸侑莸呦囿宥柚猷牖铕疣蝣鱿黝鼬",yu:"迂淤于盂榆虞愚舆余俞逾鱼愉渝渔隅予娱雨与屿禹宇语羽玉域芋郁吁遇喻峪御愈欲狱育誉浴寓裕预豫驭禺毓伛俣谀谕萸蓣揄喁圄圉嵛狳饫庾阈妪妤纡瑜昱觎腴欤於煜燠聿钰鹆瘐瘀窳蝓竽舁雩龉",yuan:"鸳渊冤元垣袁原援辕园员圆猿源缘远苑愿怨院塬沅媛瑗橼爰眢鸢螈鼋",yue:"曰约越跃钥岳粤月悦阅龠樾刖钺",yun:"耘云郧匀陨允运蕴酝晕韵孕郓芸狁恽纭殒昀氲",za:"匝砸杂拶咂",zai:"栽哉灾宰载再在咱崽甾",zan:"攒暂赞瓒昝簪糌趱錾",zang:"赃脏葬奘戕臧",zao:"遭糟凿藻枣早澡蚤躁噪造皂灶燥唣缫",ze:"责择则泽仄赜啧迮昃笮箦舴",zei:"贼",zen:"怎谮",zeng:"增憎曾赠缯甑罾锃",zha:"扎喳渣札轧铡闸眨栅榨咋乍炸诈揸吒咤哳怍砟痄蚱齄",zhai:"摘斋宅窄债寨砦",zhan:"瞻毡詹粘沾盏斩辗崭展蘸栈占战站湛绽谵搌旃",zhang:"樟章彰漳张掌涨杖丈帐账仗胀瘴障仉鄣幛嶂獐嫜璋蟑",zhao:"招昭找沼赵照罩兆肇召爪诏棹钊笊",zhe:"遮折哲蛰辙者锗蔗这浙谪陬柘辄磔鹧褚蜇赭",zhen:"珍斟真甄砧臻贞针侦枕疹诊震振镇阵缜桢榛轸赈胗朕祯畛鸩",zheng:"蒸挣睁征狰争怔整拯正政帧症郑证诤峥钲铮筝",zhi:"芝枝支吱蜘知肢脂汁之织职直植殖执值侄址指止趾只旨纸志挚掷至致置帜峙制智秩稚质炙痔滞治窒卮陟郅埴芷摭帙忮彘咫骘栉枳栀桎轵轾攴贽膣祉祗黹雉鸷痣蛭絷酯跖踬踯豸觯",zhong:"中盅忠钟衷终种肿重仲众冢锺螽舂舯踵",zhou:"舟周州洲诌粥轴肘帚咒皱宙昼骤啄着倜诹荮鬻纣胄碡籀舳酎鲷",zhu:"珠株蛛朱猪诸诛逐竹烛煮拄瞩嘱主著柱助蛀贮铸筑住注祝驻伫侏邾苎茱洙渚潴驺杼槠橥炷铢疰瘃蚰竺箸翥躅麈",zhua:"抓",zhuai:"拽",zhuan:"专砖转撰赚篆抟啭颛",zhuang:"桩庄装妆撞壮状丬",zhui:"椎锥追赘坠缀萑骓缒",zhun:"谆准",zhuo:"捉拙卓桌琢茁酌灼浊倬诼廴蕞擢啜浞涿杓焯禚斫",zi:"兹咨资姿滋淄孜紫仔籽滓子自渍字谘嵫姊孳缁梓辎赀恣眦锱秭耔笫粢觜訾鲻髭",zong:"鬃棕踪宗综总纵腙粽",zou:"邹走奏揍鄹鲰",zu:"租足卒族祖诅阻组俎菹啐徂驵蹴",zuan:"钻纂攥缵",zui:"嘴醉最罪",zun:"尊遵撙樽鳟",zuo:"昨左佐柞做作坐座阝阼胙祚酢",cou:"薮楱辏腠",nang:"攮哝囔馕曩",o:"喔",dia:"嗲",chuai:"嘬膪踹",cen:"岑涔",diu:"铥",nou:"耨",fou:"缶",bia:"髟"},i=e.length,r="",o=new RegExp("[a-zA-Z0-9- ]"),l=0;l<i;l++){var n=e.substr(l,1),s="";for(var c in a)if(-1!=a[c].indexOf(n)){s=c;break}if(o.test(n)||0==s.length)r+=n;else if(0<s.length){switch(t){case"PY":s=s.substr(0,1).toUpperCase();break;case"py":s=s.substr(0,1);break;case"PINYIN":s=s.toUpperCase();break;case"pinyin":s=s;break;default:s=s.substr(0,1).toUpperCase()+s.substr(1,s.length)}r+=s}}for(r=r.replace(/ /g,"-");0<r.indexOf("--");)r=r.replace("--","-");return r}}),Ext.define("JE.util.RbacUtil",{countUserByDeptCode:function(e,t,a){var i={deptCodes:e,cascade:!0};Ext.isEmpty(t)||(i.whereSql=t),0==a&&(i.cascade=a);var r=JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","countUserByDeptCode"),params:i});return r.success?1*r.obj:-1},countUserByDeptId:function(e,t,a){var i={deptIds:e,cascade:!0};Ext.isEmpty(t)||(i.whereSql=t),0==a&&(i.cascade=a);var r=JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","countUserByDeptId"),params:i});return r.success?1*r.obj:-1},queryUserByDeptCode:function(e,t,a,i){var r={deptCodes:e,cascade:!0};return Ext.isEmpty(t)||(r.whereSql=t),0==a&&(r.cascade=a),Ext.isEmpty(i)||(r.queryFields=i),JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","queryUserByDeptCode"),params:r})},queryUserByDeptId:function(e,t,a,i){var r={deptIds:e,cascade:!0};return Ext.isEmpty(t)||(r.whereSql=t),0==a&&(r.cascade=a),Ext.isEmpty(i)||(r.queryFields=i),JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","queryUserByDeptId"),params:r})},countUserByRoleCode:function(e,t,a){var i={roleCodes:e,cascade:!0};Ext.isEmpty(t)||(i.whereSql=t),0==a&&(i.cascade=a);var r=JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","countUserByRoleCode"),params:i});return r.success?1*r.obj:-1},countUserByRoleId:function(e,t,a){var i={roleIds:e,cascade:!0};Ext.isEmpty(t)||(i.whereSql=t),0==a&&(i.cascade=a);var r=JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","countUserByRoleId"),params:i});return r.success?1*r.obj:-1},queryUserByRoleCode:function(e,t,a,i){var r={roleCodes:e,cascade:!0};return Ext.isEmpty(t)||(r.whereSql=t),0==a&&(r.cascade=a),Ext.isEmpty(i)||(r.queryFields=i),JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","queryUserByRoleCode"),params:r})},queryUserByRoleId:function(e,t,a,i){var r={roleIds:e,cascade:!0};return Ext.isEmpty(t)||(r.whereSql=t),0==a&&(r.cascade=a),Ext.isEmpty(i)||(r.queryFields=i),JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","queryUserByRoleId"),params:r})},countUserBySentryCode:function(e,t,a){var i={sentryCodes:e,cascade:!0};Ext.isEmpty(t)||(i.whereSql=t),0==a&&(i.cascade=a);var r=JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","countUserBySentryCode"),params:i});return r.success?1*r.obj:-1},countUserBySentryId:function(e,t,a){var i={sentryIds:e,cascade:!0};Ext.isEmpty(t)||(i.whereSql=t),0==a&&(i.cascade=a);var r=JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","countUserBySentryId"),params:i});return r.success?1*r.obj:-1},queryUserBySentryCode:function(e,t,a,i){var r={sentryCodes:e,cascade:!0};return Ext.isEmpty(t)||(r.whereSql=t),0==a&&(r.cascade=a),Ext.isEmpty(i)||(r.queryFields=i),JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","queryUserBySentryCode"),params:r})},queryUserBySentryId:function(e,t,a,i){var r={sentryIds:e,cascade:!0};return Ext.isEmpty(t)||(r.whereSql=t),0==a&&(r.cascade=a),Ext.isEmpty(i)||(r.queryFields=i),JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","queryUserBySentryId"),params:r})},countUser:function(e){var t={};Ext.isEmpty(e)||(t.whereSql=e);var a=JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","countUser"),params:t});return a.success?1*a.obj:-1},queryUser:function(e,t){var a={};return Ext.isEmpty(e)||(a.whereSql=e),Ext.isEmpty(t)||(a.queryFields=t),JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","queryUser"),params:a})},countDeptByCode:function(e,t,a){var i={deptCodes:e,cascade:!0};Ext.isEmpty(t)||(i.whereSql=t),0==a&&(i.cascade=a);var r=JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","countDeptByCode"),params:i});return r.success?1*r.obj:-1},countDeptById:function(e,t,a){var i={deptIds:e,cascade:!0};Ext.isEmpty(t)||(i.whereSql=t),0==a&&(i.cascade=a);var r=JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","countDeptById"),params:i});return r.success?1*r.obj:-1},queryDeptByCode:function(e,t,a,i){var r={deptCodes:e,cascade:!0};return Ext.isEmpty(t)||(r.whereSql=t),0==a&&(r.cascade=a),Ext.isEmpty(i)||(r.queryFields=i),JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","queryDeptByCode"),params:r})},queryDeptById:function(e,t,a,i){var r={deptIds:e,cascade:!0};return Ext.isEmpty(t)||(r.whereSql=t),0==a&&(r.cascade=a),Ext.isEmpty(i)||(r.queryFields=i),JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","queryDeptById"),params:r})},countRoleByCode:function(e,t,a){var i={roleCodes:e,cascade:!0};Ext.isEmpty(t)||(i.whereSql=t),0==a&&(i.cascade=a);var r=JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","countRoleByCode"),params:i});return r.success?1*r.obj:-1},countRoleById:function(e,t,a){var i={roleIds:e,cascade:!0};Ext.isEmpty(t)||(i.whereSql=t),0==a&&(i.cascade=a);var r=JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","countRoleById"),params:i});return r.success?1*r.obj:-1},queryRoleByCode:function(e,t,a,i){var r={roleCodes:e,cascade:!0};return Ext.isEmpty(t)||(r.whereSql=t),0==a&&(r.cascade=a),Ext.isEmpty(i)||(r.queryFields=i),JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","queryRoleByCode"),params:r})},queryRoleById:function(e,t,a,i){var r={roleIds:e,cascade:!0};return Ext.isEmpty(t)||(r.whereSql=t),0==a&&(r.cascade=a),Ext.isEmpty(i)||(r.queryFields=i),JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","queryRoleById"),params:r})},countSentryByCode:function(e,t,a){var i={sentryCodes:e,cascade:!0};Ext.isEmpty(t)||(i.whereSql=t),0==a&&(i.cascade=a);var r=JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","countSentryByCode"),params:i});return r.success?1*r.obj:-1},countSentryById:function(e,t,a){var i={sentryIds:e,cascade:!0};Ext.isEmpty(t)||(i.whereSql=t),0==a&&(i.cascade=a);var r=JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","countSentryById"),params:i});return r.success?1*r.obj:-1},querySentryByCode:function(e,t,a,i){var r={sentryCodes:e,cascade:!0};return Ext.isEmpty(t)||(r.whereSql=t),0==a&&(r.cascade=a),Ext.isEmpty(i)||(r.queryFields=i),JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","querySentryByCode"),params:r})},querySentryById:function(e,t,a,i){var r={sentryIds:e,cascade:!0};return Ext.isEmpty(t)||(r.whereSql=t),0==a&&(r.cascade=a),Ext.isEmpty(i)||(r.queryFields=i),JE.ajax({url:JE.getUrlMaps("je.core.rbac.rbac","querySentryById"),params:r})}}),Ext.define("JE.util.RendererUtil",{buildRendererTactics:function(e,t){var a=[],i=Ext.isObject(t.otherConfig)?t.otherConfig:Ext.decode(Ext.value(t.otherConfig,"{}"));if(-1!=["cgroup","rgroup","cbbfield"].indexOf(e.basicXtype)){var r=Ext.value(e.configInfo,"").split(",")[0];if(JE.isNotEmpty(r)){var o={type:"dic",dicCode:t.ddCode=r,enableIcon:t.enableIcon};Ext.each(Ext.value(t.dicColor,"").split(","),function(e){"BGCOLOR"==e?(o.bgCss=!0,t.enableBGColor=!0):"COLOR"==e&&(o.textCss=!0)});var l=JE.dicInfoData[r];("cbbfield"!=e.xtype||l&&"LIST"==l.DICTIONARY_DDTYPE||JE.isEmpty(e.cascadeField))&&a.push(o)}}if(-1!=["datemonthfield","datetimefield","datefield"].indexOf(e.basicXtype)){var n=Ext.value(t.dateFormat,e.format),s=e.submitFormat;a.push({type:"dateformat",format:n,submitFormat:s})}if("uxfilefield"==e.basicXtype){var c=Ext.value(e.configInfo,"").split(","),d=c[2],u=Ext.value(c[3],""),E=u.split("*")[0],p=u.split("*")[1];a.push({type:"file",fileType:d,height:p,width:E,funcCode:e.funcCode,tableName:e.tableName,pkName:e.pkName})}else"uxfilesfield"==e.basicXtype&&a.push({type:"file",fileType:"files",funcCode:e.funcCode,tableName:e.tableName,pkName:e.pkName});if("colorfield"==e.basicXtype&&a.push({type:"color"}),"ckeditor"==e.basicXtype&&a.push({type:"ckeditor"}),"cbblistfield"==e.basicXtype){r=Ext.value(e.configInfo,"").split(",")[0];a.push({type:"cbblistfield",dicCode:r})}if("multiitem"==e.basicXtype){r=Ext.value(e.configInfo,"").split(",")[0];a.push({type:"multiitem",dicCode:r})}return"barfield"==e.basicXtype&&(a.push({type:"bar",configInfo:e.configInfo}),t.align="left"),"starfield"==e.basicXtype&&a.push({type:"star"}),t.multiRows&&a.push({type:"multiRows"}),t.columnTip&&a.push({type:"tip"}),"1"!=i.keyword&&-1!=["barfield","starfield","cgroup","rgroup","cbbfield","uxfilefield","uxfilesfield","cbblistfield","graphfield"].indexOf(e.basicXtype)||a.push({type:"highlighting"}),t.merge&&(a.push({type:"merge"}),t.allowEdit=!1),t.listeners&&t.listeners.linkclick&&a.push({type:"link"}),a},summaryRenderer:function(e,t,a,i,r,o,l){var n=t.column;if(n.rightBorderColor&&(t.tdAttr=' style="border-right-color:'+n.rightBorderColor+';" '),n.summary){var s=n.summaryMsg,c=Ext.value(a.get("summary__index"),0);1==a.allRecord&&(s=Ext.value(n.summaryAllMsg,s));var d=JE.decode(Ext.value(n.summaryFormat,"[]"));if(Ext.isNumeric(e)&&JE.isNotEmpty(d[c])&&(e=Ext.util.Format.number(e,d[c].code)),Ext.isEmpty(s))return e;if(s=JE.decode(s)[c].code,summary=JE.decode(n.summary)[c].code,"zdy"==summary){var u=s;Ext.isEmpty(u)||(u=new Ext.XTemplate(u),e=JE.eval(u.apply(a.data),JE.local.lang.core.util.RendererUtil.summaryRendererZdyTplError,!1),e=Ext.value(e,""))}else e="msg"==summary?s:s+"："+e;return e}return""},renderer:function(w,J,S,T,e,D,t){var N=this,k=J.column,I=t.store;if(!k||!k.useMark&&!k.usePostil&&Ext.isEmpty(w)&&(!I.mergesInfo||!I.mergesInfo[k.dataIndex]))return"";if(Ext.isEmpty(k.tactics))return w;var _=w;if(J.tdAttr=Ext.value(J.tdAttr,""),J.style=Ext.value(J.style,""),Ext.each(k.tactics,function(o){switch(o.type){case"dic":var t=JE.getDicItems(o.dicCode,!0),e=(Ext.value(w,"")+"").split(",");if(0<e.length){var a=[],i=[],r="",l="";Ext.each(e,function(e){dicItem=t[e],dicItem&&(a.push('<div class="'+dicItem.iconCls+'"></div>'),i.push(Ext.value(dicItem.text,JE.local.lang.core.util.RendererUtil.dicNoItem)),r=dicItem.backgroundColor,l=dicItem.textColor)}),_=1!=o.enableIcon||Ext.isEmpty(dicItem.iconCls)?Ext.value(i.join(","),w):"<center>"+a.join(" ")+"</center>",o.bgCss&&(J.tdAttr+=' style="background-color:'+r+';" '),o.textCss&&(J.style+="color:"+l+";")}break;case"file":if("img"==o.fileType){var n=w.split("*")[0],s=w.split("*")[1],c=Ext.isEmpty(o.width)?"":" width = "+o.width,d=Ext.isEmpty(o.height)?"":" height = "+o.height;_="<img alt = '"+n+"' src ='"+JE.getFileUrl(s,"","","",o.tableName)+"' "+c+" "+d+" >"}else{var u=[];if("files"==o.fileType)Ext.each(JE.toObj(w),function(e){u.push(e)});else{n=w.split("*")[0],s=w.split("*")[1];u.push({name:n,path:s})}var E=[],p=o.funcCode,f=S.get(o.pkName);Ext.each(u,function(e){var t=e.path,a=e.name,i="JE.File.doAct('download',{name:'"+a+"',path:'"+t+"',funcCode:'"+p+"',field:'"+k.dataIndex+"',beanId:'"+f+"'},'"+o.tableName+"')",r="JE.File.doAct('preview',{name:'"+a+"',path:'"+t+"',funcCode:'"+p+"',field:'"+k.dataIndex+"',beanId:'"+f+"'},'"+o.tableName+"')";txt=a+'&nbsp;<a style="color:blue;text-decoration:none;" href="javascript:void(0)" onclick="javascript:'+i+';">'+JE.local.lang.core.util.RendererUtil.fileDownload+'</a>|<a style="color:green;text-decoration:none;" href="javascript:void(0)" onclick="javascript:'+r+';">'+JE.local.lang.core.util.RendererUtil.filePreview+"</a>",E.push(txt)}),_=E.join("</br>")}break;case"color":Ext.isEmpty(w)||(J.tdAttr+=' style="background-color:'+w+';" ');break;case"ckeditor":if(Ext.isEmpty(w)||(_=JE.getUEditorBox(Ext.htmlDecode(w))),k.allowEdit){J.style+="position:relative;";var m=JE.getIconTpl("jeicon jeicon-pencil",{style:"position:absolute;right:0px;top:0px;cursor: pointer;",onclick:"JE.editCKEditorVal('"+N.getId()+"','"+S.getId()+"','"+k.dataIndex+"');"});_+=m}break;case"cbblistfield":if(!Ext.isEmpty(w)){var g=[];i=[];try{g=Ext.decode(w)}catch(e){}Ext.each(g,function(e){var t=e.text;Ext.isEmpty(t)&&(t=JE.toDicText(o.dicCode,e.code)),i.push("<b>"+t+"</b>："+e.value)}),_=i.join("</br>")}break;case"multiitem":if(!Ext.isEmpty(w)){g=[],i=[];try{g=Ext.decode(w)}catch(e){}Ext.each(g,function(e){i.push("<b>"+e.text+'</b><font color="#a0a0a0">('+e.code+")</font>")}),_=i.join("</br>")}break;case"dateformat":try{var h=[];Ext.each(w.split(","),function(e){h.push(Ext.Date.format(Ext.Date.parse(e,o.submitFormat),o.format))}),_=h.join(",")}catch(e){_=w}break;case"multiRows":_=w.replaceAll("\n","<br/>"),J.style+="word-wrap:break-word; word-break:normal;overflow:visible;white-space:normal";break;case"tip":J.tdAttr+='data-qtip="'+Ext.htmlEncode(_)+'" data-qtip-type="grid"';break;case"link":k.hasListener("linkclick")&&(_='<span class="link-text">'+_+"</span>");break;case"bar":var x=Number(isNaN(w)?0:w),y=JEBarField.getRangeImg(o.configInfo,x);_=JEBarField.getHtmlTpl({width:x,img:y,cls:"je-field-bar-grid"});break;case"star":_='<div class="je-field-star">'+JEStarField.getStarView(w)+"</divb>";break;case"mark":_=JEMarkField.getMarkView(w);break;case"postil":x=JE.toNum(w);_='<div class="je-column-postil '+(0==x?"empty":"")+'">批注('+x+")</div>";break;case"highlighting":var v=JE.Action.getQueryKeyWord(I,k.dataIndex,w);Ext.isEmpty(v)||(_=(_+="").replace(v,"<span style='color:red'>"+v+"</span>"),w==_&&(_=_.replace(v.toUpperCase(),"<span style='color:red'>"+v.toUpperCase()+"</span>")),w==_&&(_=_.replace(v.toLowerCase(),"<span style='color:red'>"+v.toLowerCase()+"</span>")));break;case"merge":if(I.mergesInfo&&I.mergesInfo[k.dataIndex]){var b="";Ext.each(I.fieldsInfo[k.dataIndex],function(e){b+=Ext.value(S.get(e),"").toString()});var C=I.mergesInfo[k.dataIndex][b];C&&("grouping"==D.ftype?C.start==T&&C.start!=C.end?(J.tdAttr+=' style="border-bottom-width:0px;" ',_=""):C.start+1==T?J.tdAttr+=" rowspan = "+(C.end-C.start)+" ":T>C.start+1&&T<=C.end&&(J.tdAttr+=' style="display:none;" '):"groupingsummary"==D.ftype?C.start==T&&C.start!=C.end?(J.tdAttr+=' style="border-bottom-width:0px;" ',_=""):C.start+1==T?(J.tdAttr+=" rowspan = "+(C.end-C.start-1)+" ",J.tdAttr+=' style="border-bottom-width:0px;" '):T>C.start+1&&T<C.end?J.tdAttr+=' style="display:none;" ':T==C.end&&C.start!=C.end&&(_=""):C.start==T?J.tdAttr+=" rowspan = "+(C.end-C.start+1)+" ":T>C.start&&T<=C.end&&(J.tdAttr+=' style="display:none;" '))}}}),JE.isNotEmpty(J.tdAttr)){var a=J.tdAttr,i=J.tdAttr.match(/style=\".*?\"/g);if(JE.isNotEmpty(i)&&1<i.length){var r="";Ext.each(i,function(e){r+=e.substring(7,e.length-1)+";",a=a.replaceAll(e,"")}),a+=' style="'+r+'"',J.tdAttr=a}}return _},editCKEditorVal:function(e,t,a){var i=Ext.getCmp(e),r=i.store.getById(t),o=r.get(a);i.funcData.info.funcAction,i.funcData.info.tableName,JE.win({title:JE.local.lang.core.util.RendererUtil.ckEditorTitle,useButton:!0,border:0,items:{xtype:"ckeditor",value:o},fn:function(e){o=e.items.get(0).getValue(),r.set(a,o)}}).show()},buildRendererTDStyle:function(e){var t="";return JE.isNotEmpty(e.rightBorderColor)&&(t+="border-right-color:"+e.rightBorderColor+";"),JE.isNotEmpty(e.bottomBorderColor)&&(t+="border-bottom-color:"+e.bottomBorderColor+";"),JE.isNotEmpty(e.altRowBGColor)&&e.rowIndex%2!=0&&(t+="background-color: "+e.altRowBGColor+";"),JE.isNotEmpty(t)&&(t=' style="'+t+'"'),t}}),Ext.define("JE.util.ReportUtil",{constructor:function(e){e=Ext.apply({},e),this.view=e.view},fn:{sum:function(e,t){return Ext.Array.sum(this.buildData(e,t))},min:function(e,t){return Ext.Array.min(this.buildData(e,t))},max:function(e,t){return Ext.Array.max(this.buildData(e,t))},count:function(e,t){return this.buildData(e,t).length},avg:function(e,t){var a=Ext.Array.mean(this.buildData(e,t));return a=Number(Ext.util.Format.number(a,"0.00"))},params:function(e){return"'"+Ext.value(this.reportConfig.params[e],"")+"'"},dic:function(e,t){if(JE.isEmpty(e))return[];Ext.isString(t)||(t="text");var a=JE.getDicItems(e),i=(t=Ext.value(t,"text"),[]);return Ext.each(a,function(e){i.push(e[t])}),i},chart:function(){var e=arguments[0],t=arguments[1],a=arguments[2],i=arguments[arguments.length-1];if(JE.isNotEmpty(e)){Ext.isObject(t)&&(i=t,t=null),Ext.isObject(a)&&(i=a,a=null);var r="",o=[];if(4<arguments.length){for(var l={},n=3;n<arguments.length-1;n++){var s=arguments[n].split("."),c=(s[0],s[1]);if(i.objDS)l[c]=i.objDS[c];else{var d=!1;Ext.each(i.groups,function(e){if(e.fieldName==c)return l[c]=e.value,!(d=!0)}),d||(l[c]=this.buildData(arguments[n],i)[0])}}Ext.iterate(l,function(e,t){r+=" params-"+e+"='"+t+"'",o.push(e)})}return'"<div chartdiv chartCode='+e+" width="+Ext.value(t,200)+" height="+Ext.value(a,100)+" "+r+" paramsKeys = '"+o.join(",")+"'></div>\""}return""},header:function(){for(var e=[],t=0;t<arguments.length-1;t++)e.push(arguments[t]);return 1<e.length?"\"<div headerdiv headers='"+JE.encodeURI(e.join(","))+"'></div>\"":Ext.value(e[0],"")}},buildData:function(e,i){var t=[],r=Ext.value(i.groups,[]),o=(Ext.value(i.objDS,{}),"");if(Ext.isArray(e))t=e;else if(Ext.isString(e)){var a=e.split("."),l=a[0];if(o=a[1],this.dataSource[l])t=this.dataSource[l];else if(Ext.isEmpty(o)){o=l;var n=this.configInfo.tds[o];t.push(this.computeFormula(n.formula,r,n.defaultValue))}}var s=[];return Ext.each(t,function(t){var e=0;if(Ext.isObject(t)){var a=0;Ext.each(r,function(e){t[e.fieldName]==e.value&&a++}),e=a==r.length?t[o]:null}else e=t;null!=e&&(-1!=["group","count"].indexOf(i.formula)?s.push(e):s.push(JE.toNum(e)))}),s},parseTable:function(e){var C=this,t=Ext.DomQuery.select("table",e),w=new Ext.util.MixedCollection;return Ext.each(t,function(e,t){for(var a={name:"__table__"+t,rows:[],html:"",group:!1,bindingDS:e.getAttribute("data-bindingDS")},i=[],r=0,o=e.rows.length,l=0;l<o;l++){var n=[];0==r&&Ext.each(e.rows[0].cells,function(e){r+=Number(e.colSpan,"1")});for(var s=0;s<r;s++)n.push({rowIndex:l,cellIndex:s,empty:!0,hGroups:[],vGroups:[]});i.push({cells:n,html:""})}a.cellNum=r,a.rowNum=o;for(l=0;l<i.length;l++){var c=i[l],d=e.rows[l],u=0,E=!1;for(s=0;s<c.cells.length;s++){var p=c.cells[s],f=d.cells[u];if(!p.mark&&f){var m={hGroups:[],vGroups:[],rowIndex:p.rowIndex,cellIndex:p.cellIndex,colSpan:Number(f.colSpan,"1"),rowSpan:Number(f.rowSpan,"1"),code:JE.uuid(),html:f.outerHTML,obj:Ext.clone(f)},g=f.getAttribute("data-code");if(g){var h=C.configInfo.tds[g];Ext.apply(m,h)}-1==["V","DATA"].indexOf(m.to)&&!E||"1"!=m.group?m.group="0":a.group=!0,E&&a.group&&JE.isNotEmpty(m.groupSummary)&&(a.groupSummary=!0),"DATA"==m.to?E=!0:-1!=["V","H"].indexOf(m.to)&&("group("==m.formula.substring(0,6)?m.formula=m.formula.substring(6,m.formula.length-1):"dic("==m.formula.substring(0,4)&&(m.formula=m.formula.substring(4,m.formula.length-1),m.dicCode=m.formula.split(",")[1],m.dicItemCode=m.formula.split(",")[2],m.formula=m.formula.split(",")[0]),m.fieldName=m.formula);for(var x=0;x<m.rowSpan;x++)for(var y=0;y<m.colSpan;y++)if(0!=x||0!=y){var v=i[l+x].cells[s+y];v&&(v.mark=!0,v.ref=m.code,v.to=m.to)}c.cells.splice(s,1,m),s+=m.colSpan-1,u++}}jQuery(d).html("{_value_}"),i[l].html=d.outerHTML,E=!1}jQuery(e).html("{_value_}"),a.html=e.outerHTML,a.rows=i;var b=document.createTextNode("{"+a.name+"}");e.parentNode.replaceChild(b,e),w.add(a.name,a)}),w},parseConfigInfo:function(e){var r=this,u={tds:{},objs:{}},E=["code","text","formula","to","editable","field","group","groupField","groupFieldTpl","groupSummary","defaultValue"],t=Ext.DomQuery.select("input[type=button][reportBtn]",e);if(Ext.each(t,function(a){var e=a.getAttribute("data-code"),t=a.parentNode,i={};Ext.each(E,function(e){i[e]=a.getAttribute("data-"+e)}),i.defaultValue=Ext.value(i.defaultValue,0);var r=document.createElement("span");Ext.each(["fontSize","fontFamily","fontWeight","color"],function(e){var t=a.getAttribute("data-"+e);JE.isNotEmpty(t)&&(r.style[e]=t)}),i.style=r.getAttribute("style");var o=document.createTextNode("{"+e+"}");t.replaceChild(o,a);for(var l,n=5,s=t;0<n&&s;){if("TD"==s.nodeName){l=s;break}s=s.parentNode,n--}if(l){var c=l.getAttribute("data-code");if(JE.isEmpty(c))l.setAttribute("data-code",e);else{var d=Ext.value(l.getAttribute("data-codes"),[]);JE.isNotEmpty(d)&&(d=d.split(",")),d.push(e),l.setAttribute("data-codes",d.join(","))}u.tds[e]=i}else u.objs[e]=i}),r.configInfo=u,!r.reportConfig.ds){r.reportConfig.ds={};var a=JE.ajax({url:JE.getUrlMaps("je.core.load"),params:{tableCode:"JE_CORE_DATASOURCE",whereSql:"and JE_CORE_DATASOURCE_ID in('"+r.reportConfig.dsIds.replaceAll(",","','")+"')",limit:-1}}).rows;Ext.each(a,function(e){r.reportConfig.ds[e.DATASOURCE_CODE]=JE.getChartDS(e)})}var o={},l=Ext.clone(r.reportConfig.params),n=r.reportConfig.doPageAct;Ext.iterate(r.reportConfig.ds,function(e,t){if(!o[e])if(Ext.value(t.pageDS,r.reportConfig.bindDS)==e)if("loadPage"==n){var a=r.reportConfig.doPageSize,i=r.reportConfig.doPageIndex;l.limit=a,o[e]=t[n](i,l)}else l.limit=Ext.value(l.limit,t.pageSize),o[e]=t[n](l);else o[e]=t.load(l)}),r.dataSource=o},computeNewTable:function(e,r,o){var l=this,t=[],n=0,s=0,c={};return Ext.each(e.rows,function(e,a){var i=[];Ext.each(e.cells,function(e){if(!e.empty&&e.obj){var t=Ext.value(e.html,"");e.num=c,t=l.computeCell(e,a,r,o),i.push(t),0==a&&(n+=Number(e.obj.width,"0"),s+=e.colSpan)}}),t.push(e.html.replace("{_value_}",i.join("")))}),n-=4,t.push('<tr height=0 ><td colspan="'+s+'" style="border-color:transparent;padding:0px;"><div style="width:'+n+'px"></td></td></tr>'),e.html.replace("{_value_}",t.join(""))},computeCell:function(a,s,c,d){var u=this,E=a.obj.cloneNode(!0);if(E.rowSpan=a.rowSpan,E.colSpan=a.colSpan,!Ext.isEmpty(a.code)){var p=E.innerHTML,f="&nbsp;",m=Ext.value(a.hGroups,[]).concat(Ext.value(a.vGroups,[])),i=[a],e=E.getAttribute("data-codes");JE.isNotEmpty(e)&&Ext.each(e.split(","),function(e){var t=u.configInfo.tds[e];t&&(t.num=a.num,i.push(t))}),Ext.each(i,function(e){if("NUM"==e.to&&(e.num[e.code]=JE.isNotEmpty(c)?d:Ext.value(e.num[e.code],0),e.num[e.code]++,e.value=e.num[e.code]+(u.view.getPageData().fromRecord-1)),JE.isNotEmpty(e.value))f=e.value;else if(JE.isNotEmpty(e.formula)){var t=e.formula.split(".");JE.isNotEmpty(c)?f=c[t[1]]:2==t.length&&u.dataSource[t[0]]||(f=u.computeFormula(e.formula,m,e.defaultValue,c))}else"1"==e.editable&&(f="");if(u.reportConfig.renderer){var a=u.reportConfig.renderer,i={rowIndex:s,configInfo:u.configInfo,dataSource:u.dataSource,info:e,util:u,parentNode:E};f=a(f,i,c,d);var r=i.tdStyle;if(JE.isNotEmpty(r)){var o=E.getAttribute("style")||"";E.setAttribute("style",o+";"+r)}}if("1"==e.editable){var l=e.code;f='<span fieldspan name="{name}" code="'+l+'" value="'+JE.encodeURI(f)+'"></span>',Ext.each(m,function(e){l+="~"+e.value}),f=f.replace("{name}",l)}var n=u.configInfo.tds[e.code];n&&JE.isNotEmpty(n.style)&&(f="<span style='"+n.style+"'>"+f+"</span>"),p=p.replace("{"+e.code+"}",f)}),E.innerHTML=p}return E.outerHTML},parseFn:function(e,t){t=Ext.value(t,0),Ext.isString(e)&&(e=parseFormula(e).items);for(var a=e[t],i=t+1,r=[],o="";i<e.length;i++){var l=e[i];if("argument"==l.type)e[i-1]&&"argument"==e[i-1].type?r.push(""):JE.isNotEmpty(o)&&r.push(o);else{if("function"==l.type&&"stop"==l.subtype){JE.isNotEmpty(o)&&r.push(o);break}if("function"==l.type&&"start"==l.subtype)r.push(this.parseFn(e,i)),i=o.index;else{o="";for(var n=i;n<e.length;n++){var s=e[n];if("argument"==s.type||"function"==s.type&&"stop"==s.subtype){i--;break}o+=s.value,i++}}}}return{index:t+=i,fn:a.value,args:r}},computeFormula:function(e,i,t,a){for(var r=this,o=parseFormula(e),l=(i=Ext.value(i,[]),[]),n=0;n<o.items.length;n++){var s=o.items[n],c=s.value;if("function"==s.type&&"start"==s.subtype){fn=r.parseFn(o.items,n);var d={groups:i,objDS:a};fn.args.push(d),c=r.fn[fn.fn].apply(r,fn.args),"group"==fn.fn&&(c=c.items),n=fn.index}else if("operand"==s.type){var u=s.value.split("."),E=Ext.value(a,r.dataSource[u[0]]),p=u[1];if(1<u.length)c=t,E&&Ext.isObject(E)?c=Ext.value(E[p],c):Ext.each(E,function(t){var a=0;if(Ext.each(i,function(e){t[e.fieldName]==e.value&&a++}),a==i.length)return c=t[p],!1}),Ext.isArray(c)||Ext.isObject(c)?c="'"+Ext.encode(c)+"'":Ext.isNumeric(c)||(c="'"+c+"'");else if(r.configInfo.tds[s.value]){var f=r.configInfo.tds[s.value];c=r.computeFormula(f.formula,i,f.defaultValue,a)}}else"text"==s.type&&(c="'"+s.value+"'");Ext.isArray(c)&&(c="'"+c.join(",")+"'"),l.push(Ext.value(c,0))}var m="";return 0<l.length&&(m=JE.eval(l.join(" "))),Ext.value(m,t)},getFieldValue:function(e,t){var a=[];return Ext.each(t,function(e){a.push({fieldName:e.code,value:e.value})}),this.group(e,{groups:a}).items},group:function(e,t,a,i){var r=[];t=Ext.value(t,{});if(JE.isEmpty(a)){t.formula="group";var o=this.buildData(e,t),l=new Ext.util.MixedCollection;Ext.each(o,function(e){l.get(e)||l.add(e,e)}),r=l.items}else r=this.fn.dic(a,i);return{fieldName:e,items:r}},buildNewTable:function(e){for(var p=this,t=e.rowNum,f=e.cellNum,m=[],l=e.rows,a=0;a<t;a++)for(var i=0;i<f;i++){var r=(j=l[a].cells[i]).colSpan,n=j.rowSpan,s=j.code,c=j.fieldName,d=a,u=i,o=Ext.value(j.hGroups,[]).concat(Ext.value(j.vGroups,[]));if("H"!=j.to||j.hOk)if("V"!=j.to||j.vOk){if("DATA"==j.to){i=f;m=[];var E=j.formula.split(".")[0],g=p.dataSource[E],h=l[a],x=Ext.value(j.groupField,"").split(".")[1],y=j.groupFieldTpl,v="",b=0,C=j.groupSummary,w="padding:4px;border-color:"+j.obj.style.borderColor+";";Ext.each(g,function(e,t){for(var a={html:h.html,cells:[]},i=0,r=[],o=0;o<f;o++){var l=Ext.clone(h.cells[o]),n="";JE.isEmpty(l.formula)||(l.ready=!0,l.value=e[l.formula.split(".")[1]],n=l.value),r.push({value:n}),"1"==l.group&&(l.vGroups=Ext.clone(r)),a.cells.push(l),i+=l.colSpan}if(x&&y&&v!=e[x]){v=e[x];var s=document.createElement("TD");s.innerHTML="{__"+x+"__}",s.setAttribute("style",w);n=v;if(y){for(var c=0,d=t;d<g.length&&g[d][x]==n;d++)c++;n=JE.toXT(y,{name:n,count:c})}m.push({html:h.html,cells:[{groupRow:!0,code:"__"+x+"__",colSpan:i,rowSpan:1,value:n,obj:s,vGroups:[]}]}),b++}m.push(a);var u=g[t+1];if(v=e[x],x&&C&&(t==g.length-1||v!=u[x])){var E={html:h.html,cells:[]};for(o=0;o<f;o++){(l=Ext.clone(h.cells[o])).groupCell=!0,l.ready=!0,"1"==l.group?l.formula==l.groupField?l.value=e[x]:l.groupSummary&&(p.fn[l.groupSummary]?l.value=p.fn[l.groupSummary].call(p,l.formula,{formula:l.groupSummary,groups:[{fieldName:x,value:v}]}):l.value=l.groupSummary):l.groupSummary?p.fn[l.groupSummary]?l.value=p.fn[l.groupSummary].call(p,l.formula,{formula:l.groupSummary,groups:[{fieldName:x,value:v}]}):l.value=l.groupSummary:l.value="",E.cells.push(l)}m.push(E),b++}}),l.splice.apply(l,[d,n].concat(m)),t=l.length,a+=g.length-1+b}}else{J=p.group(c,{groups:o},j.dicCode,j.dicItemCode);var m=[];Ext.each(J.items,function(e,t){for(var a=d;a<d+n;a++){for(var i={html:l[a].html,cells:[]},r=0;r<f;r++){var o=Ext.clone(l[a].cells[r]);r==u?(o.ready=!0,o.vOk=!0,o.value=e):u<r&&o.vGroups.push({code:s,value:e,formula:c,ds:c.split(".")[0],fieldName:c.split(".")[1]}),i.cells.push(o)}for(r=0;r<u;r++)i.cells[r].rowSpan>i.cells[u].rowSpan&&(i.cells[r].rowSpan+=J.items.length-1,0<t&&(i.cells[r].empty=!0));m.push(i)}}),0<m.length&&l.splice.apply(l,[d,n].concat(m)),t=l.length}else{for(var J=p.group(c,{groups:o},j.dicCode,j.dicItemCode),S=0;S<t;S++){for(var T=[],D=l[S].cells[u],N=Ext.value(D.code,D.ref),k=u,I=u;0<=I;I--)if(l[S].cells[I].code==N){k=I;break}if((D=l[S].cells[k]).colSpan>r||S<d){var _=(J.items.length-1)*r;D.colSpan+=_;var A=Number(Ext.value(j.obj.getAttribute("width"),"0")),O=Number(Ext.value(D.obj.getAttribute("width"),"0"));0<A&&0<O&&D.obj.setAttribute("width",O+A*_);for(I=0;I<_;I++)T.push({rowIndex:S,cellIndex:k+I,empty:!0,hGroups:[],vGroups:[],mark:!0,ref:D.code});l[S].cells.splice.apply(l[S].cells,[k+1,0].concat(T))}else Ext.each(J.items,function(e){for(var t=u;t<u+r;t++){var a=Ext.clone(l[S].cells[t]);S==d?(a.ready=!0,a.hOk=!0,a.value=e,T.push(a)):d<S&&(a.hGroups.push({code:s,value:e,formula:c,ds:c.split(".")[0],fieldName:c.split(".")[1]}),T.push(a))}}),l[S].cells.splice.apply(l[S].cells,[u,r].concat(T))}i+=J.items.length*r-1,f=l[a].cells.length}}if(e.cellNum=f,e.rowNum=t,e.group)for(a=0;a<t;a++)for(i=0;i<f;i++){var j;if((j=l[a].cells[i])&&"1"==j.group){d=a,u=i;var R=j.value,M=(n=j.rowSpan,j.vGroups);for(S=d+1;S<t;S++){var L=l[S].cells[u];if(L&&!L.empty){var U=!0;Ext.each(L.vGroups,function(e,t){if(!M[t]||M[t].value!=e.value)return U=!1}),"1"!=L.group&&(U=!1),U&&L.value==R?(L.group="0",L.empty=!0,l[d].cells[u].rowSpan+=L.rowSpan):(n=L.rowSpan,M=L.vGroups,R=L.value,d=S)}}}}return e},doReport:function(e){var r=this;r.reportConfig=Ext.value(e,{});var t=document.createElement("DIV");t.innerHTML=Ext.value(r.reportConfig.htmlTpl,r.htmlTpl),r.parseConfigInfo(t);var a=r.parseTable(t),o=t.innerHTML;return Ext.iterate(r.configInfo.objs,function(e,t){if(JE.isNotEmpty(t.formula)){var a=r.computeFormula(t.formula,[],"");Ext.isArray(a)&&(a=a.join(",")),o=o.replace("{"+e+"}",a)}else if("1"==t.editable){var i='<span fieldspan name="'+t.code+'" code="'+t.code+'"></span>';o=o.replace("{"+e+"}",i)}else{a=(0,r.reportConfig.renderer)("",{configInfo:r.configInfo,dataSource:r.dataSource,info:t,util:r});o=o.replace("{"+e+"}",a)}}),a.each(function(e){var a=r.buildNewTable(e),i=[],t=Ext.value(r.dataSource[e.bindingDS],[{}]);Ext.each(t,function(e,t){i.push(r.computeNewTable(a,e,t))}),o=o.replace("{"+e.name+"}",i.join("</br>"))}),JE.getUEditorBox(o)},renderer:function(e,t){return e},formulaTypes:{noop:"无操作",operand:"变量",function:"方法",subexpression:"子运算试",argument:"参数","operator-prefix":"运算符-前缀","operator-infix":"运算符-中缀","operator-postfix":"运算符-后缀","white-space":"空格",unknown:"未知",start:"开始",stop:"结束",text:"文字",number:"数字",logical:"逻辑",error:"错误",range:"并列",math:"公式",concatenate:"连接",intersect:"交集",union:"并集"}}),Ext.define("JE.util.Transaction",function(){return{tasks:null,begin:function(){this.tasks=new Ext.util.HashMap},addTask:function(e,t){if(this.tasks)return this.tasks.add(e,t),this;JE.error("事务还没有begin,请先开始事务.")},end:function(){var a=new Array;if(this.tasks.each(function(e,t){if(1!=function(e,t){if("sql"!=e&&t&&Ext.isEmpty(t.tableCode))return JE.error("请在"+e+"操作传入表名(tableCode),格式为{tableCode:表名....}!"),!1;switch(e){case"insert":if(!t.values)return JE.error("请传入保存数据的字段值,格式为{tableCode:表名,values:{TEST_NAME:''}}"),!1;break;case"remove":if(!t.whereSql)return JE.error("请传入删除的whereSql.格式为{tableCode:表名,whereSql:删除条件}"),!1;break;case"removeByIds":if(!t.ids)return JE.error("请传入删除的主键值,格式为{tableCode:表名,ids:主键1,主键2}."),!1;break;case"update":if(!t.values)return JE.error("请传入修改数据的字段值,格式为{tableCode:表名,values:{主键名：主键值,字段1:值}}"),!1;break;case"updateBatch":if(!t.values||!t.whereSql)return JE.error("请传入修改数据的字段值和whereSql,格式为{tableCode:表名,values:{字段1:值},whereSql:修改条件}."),!1;break;case"sql":if(!t)return JE.error("请传入需执行的SQL"),!1;break;default:return JE.error(e+"不是合法的关键字,合法的关键字有(insert、remove、removeByIds、update、updateBatch、sql)"),!1}return!0}(e,t))return!1;a.push({taskKey:e,config:t})}),a.length<=0)return!1;var e=JE.ajax({url:JE.getUrlMaps("je.core.dbsql","doTrans"),params:{strData:Ext.encode(a)}});return a=void 0,this.tasks=null,!!e.success}}}),Ext.define("JE.util.Util",{initIM:function(){"1"==JE.systemConfig.JE_IM_ENABLE&&(window._im_option_={userId:JE.USER.userId},JE.loadScript(["/plugin/im/index.min.css","/plugin/im/index.min.js"]))},getFileThumbnail:function(e,t){if(JE.isNotEmpty(e)&&JE.isNotEmpty(t)){var a=e[t.styleConfig],i=t.width,r=t.height,o="";if(JE.isNotEmpty(a))a=Ext.JSON.decode(a),JE.toNum(a.width)<JE.toNum(i)&&(i=a.width),JE.toNum(a.height)<JE.toNum(r)&&(r=a.height),o='<img style="'+(a="width:"+i+"px;height:"+r+"px;")+'" src="'+(e[t.imgUrl]||JE.getFileUrl(e[t.imgCdnUrl],"PROJECT",t.imgType,"",t.tableCode))+'" />';else o='<i style="'+("font-size:80px; color:"+JE.getFileIcon(e[t.imgName]).color)+'" class ="'+e[t.icon]+'"></i>';return o}return""},getCurrentUser:function(){return JE.USER},setWestMenuVisible:function(e){var t=Ext.getCmp("_jewestview");t&&"appmenutiled"==t.xtype&&t.setVisible(e)},isSaasAdmin:function(){return"admin"==JE.USER.userCode||-1!=JE.USER.roleNames.indexOf("系统管理员")},initJSandCSS:function(){var e=JE.systemConfig.PROJECT_URL_HASHMAP;e&&JE.loadScript(e);var t=JE.systemConfig.JE_SYS_JS;JE.isNotEmpty(t)&&JE.eval(t);var a=JE.systemConfig.JE_SYS_CSS;JE.isNotEmpty(a)&&Ext.util.CSS.createStyleSheet(a)},getPlusInfo:function(){return JE.split(JE._plusinfo,",")},getFileIcon:function(e){var t=e.split(".").pop().toLocaleLowerCase(),a="unknownfile",i="a9aba9";return-1!=["doc","docx"].indexOf(t)?(a="word",i="0057aa"):-1!=["xls","xlsx"].indexOf(t)?(a="excel",i="00843e"):-1!=["ppt","pptx"].indexOf(t)?(a="ppt",i="f34e19"):-1!=["rar","zip","arj","gz","z"].indexOf(t)?(a="zip",i="fbaf32"):-1!=["bmp","gif","jpg","pic","png","tif","jpeg"].indexOf(t)?(a="image",i="FF7744"):"pdf"==t?(a="pdf",i="e52c0e"):"txt"==t&&(a="txt",i="2ba244"),{type:a,icon:"jeicon jeicon-"+a,color:"#"+i,html:'<svg class="jeicon" aria-hidden="true"><use xlink:href="#jeicon-'+a+'"></use></svg>'}},getUserPhoto:function(){var e=arguments[0],t=arguments[1];if(Ext.isBoolean(e)&&(t=e,e=""),e=Ext.value(e,JE.USER.userId),!JE.__USERS__){JE.__USERS__={};var a=JE.ajax({url:JE.getUrlMaps("je.core.rbac.user.loadUserInfo")});Ext.each(a,function(e){JE.__USERS__[e.USERID]=JE.__USERS__[e.USERCODE]={id:e.USERID,code:e.USERCODE,name:e.USERNAME,photo:e.PHOTO,photoUrl:e.PHOTOURL}})}var i=JE.__USERS__[e]||{},r=i.photoUrl;if(!r&&i.photo&&(r=i.photo,r=0==(r=JE.split(r,"*")[1]).indexOf("data:image/")?r:JE.getFileUrl(r)),t){if(JE.isNotEmpty(r))return'<img class="je-user-photo photo-img" src="'+r+'">';var o=i.name||"";return'<div class="je-user-photo photo-text">'+(o=2<o.length?o.substring(o.length-2):o)+"</div>"}return r},getStaticUrl:function(e,t){t=t||"image";var a=(JE.static||{})[t];return JE.buildCdnUrl(a&&a[e])},getOnlineInfo:function(e,t){var a=window.__online_info__||{},i=a[e];if(i)return-1!=["cdn_router","cdn-exclude","hash_map"].indexOf(e)&&Ext.isString(i)&&(i=a[e]=Ext.decode(i)),t?i[t]:i},buildCdnUrl:function(a){if(a.startsWith("http"))return a;a=a.startsWith("/")?a.substring(1):a;var i=JE.getOnlineInfo("cdn")||"",e=JE.getOnlineInfo("hash_map")||{};if((a=e[a]||a).startsWith("data:image/"))return a;if(a="/"+a,JE.isNotEmpty(e)&&a){var t=JE.getOnlineInfo("cdn_router")||[],r=JE.getOnlineInfo("cdn_exclude")||[];Ext.each(t,function(e){if(a.startsWith(e)){var t=!0;return Ext.each(r,function(e){if(a.startsWith(e))return t=!1}),t&&(a=i+a),!1}})}return i&&-1==a.indexOf(i)&&window.ServerUrl&&(a=window.ServerUrl+a),a},regStr:function(e,t){switch(t){case"phone":t="^([1][3-9]{1})+\\d{9}$";break;case"telphone":t="^((\\d{3,4}-)|\\d{3.4}-)?\\d{7,8}$";break;case"email":t="^\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$";break;case"idcard":t="(^\\d{15}$)|(^\\d{17}([0-9]|X))$"}return!JE.isEmpty(e)&&!JE.isEmpty(t)&&new RegExp(t).test(e)},checkPassword:function(e){var t=0;if(e.length<6)return t;switch(JE.regStr(e,"\\d")&&t++,JE.regStr(e,"[a-z]")&&t++,JE.regStr(e,"[A-Z]")&&t++,JE.regStr(e,"[^a-zA-Z0-9]")&&t++,t){case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4}},getUrlMaps:function(e){return(JE.urlMaps||{})[e]},showMap:function(e){if(window.BMap){var t={items:{xtype:"uxmap",address:e.address,point:e.point,callback:e.fn},autoShow:!0};delete(e=Ext.apply({title:"地图",width:800,height:600},e)).fn,JE.win(Ext.apply(e,t))}else JE.alert("没有检测到百度地图插件，请检查！")},getDate4Msg:function(e){if(!e||!Ext.isDate(e))return"";var t=Ext.Date.clearTime(e),a=Ext.Date.clearTime(new Date),i=0==(i=a.getDay())?7:i,r=parseInt((a-t)/864e5),o="",l=Math.abs(r),n=new Date,s=new Date;if(n.setDate(n.getDate()-(i-0)),s.setDate(s.getDate()+(7-i)),0==l)o="今天";else if(1==l)o=0<r?"昨天":"明天";else if(t.getTime()>=n.getTime()&&t.getTime()<=s.getTime()){o="周"+["一","二","三","四","五","六","日"][(0==t.getDay()?7:t.getDay())-1]}else o=i-l<=0&&0<i-l+7?0<r?"上周":"下周":0<r?"更早":"近期";return o},decodeUnicode:function(e){return e=e.replace(/\\/g,"%"),unescape(e)},encodeUnicode:function(e){for(var t=[],a=0;a<e.length;a++)t[a]=("00"+e.charCodeAt(a).toString(16)).slice(-4);return"\\u"+t.join("\\u")},decodeHex:function(e){var t,a=e.trim(),i="0x"===a.substr(0,2).toLowerCase()?a.substr(2):a,r=i.length;if(r%2!=0)return alert("Illegal Format ASCII Code!"),"";for(var o=[],l=0;l<r;l+=2)t=parseInt(i.substr(l,2),16),o.push(String.fromCharCode(t));return o.join("")},encodeHex:function(e){if(""===e)return"";for(var t=["0x"],a=0;a<e.length;a++)t.push(e.charCodeAt(a).toString(16));return t.join("")},checkFlash:function(){var e,t=0;if(document.all)(e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))&&(t=1,VSwf=e.GetVariable("$version"),parseInt(VSwf.split(" ")[1].split(",")[0]));else if(navigator.plugins&&0<navigator.plugins.length&&(e=navigator.plugins["Shockwave Flash"])){t=1;for(var a=e.description.split(" "),i=0;i<a.length;++i)isNaN(parseInt(a[i]))||parseInt(a[i])}return t},cutImage:function(o){JE.uploadFile({fileTypes:"jpg;png;jpeg;bmp",type:"local",params:{returnType:"all",jeFileType:"PROJECT"},callback:function(r){var e="uxjcrop",i=(r.name,r.docInfo);if(Ext.isIE&&Ext.isIE9m)JE.win({title:o.title||"图像截取",width:500,height:500,autoShow:!0,items:{xtype:e,params:{path:JE.getFileUrl("","","",i.JE_CORE_DOCUMENT_ID)||r.privateUrl,size:o.size},callback:function(e){var t={};o.params?t=Ext.apply(t,o.params):o.userPhoto&&(t={fieldCode:"PHOTO",tableCode:"JE_CORE_ENDUSER",funcCode:"JE_CORE_ENDUSER",pkValue:JE.USER.userId}),t.strData=e,t.fileName=i.DOCUMENT_DOCNAME,t.fileFormat=i.DOCUMENT_FORMAT;var a=JE.ajax({url:"/je/doc/document/doSaveDiyImg",params:t});if(a.success){if(o.callback){e=a.obj;o.callback({docInfo:e,url:e.DOCUMENT_ADDRESS,name:e.DOCUMENT_DOCNAME,size:e.DOCUMENT_DOCSIZE,privateUrl:e.DOCUMENT_PRIVATEKEY})}}else JE.alert("文件保存失败，请稍微再试!")}}});else{var t=new FileReader;t.readAsDataURL(r.files[0]),t.onload=function(){JE.win({title:o.title||"图像截取",width:500,height:500,autoShow:!0,items:{xtype:e,params:{path:this.result,size:r.files[0].size},callback:function(e){var t={};o.params?t=Ext.apply(t,o.params):o.userPhoto&&(t={fieldCode:"PHOTO",tableCode:"JE_CORE_ENDUSER",funcCode:"JE_CORE_ENDUSER",pkValue:JE.USER.userId}),t.strData=e.path,t.fileName=r.files[0].name;var a=JE.ajax({url:"/je/doc/document/doSaveDiyImg",params:t});if(a.success){if(o.callback){var i=a.obj;o.callback({docInfo:i,url:i.DOCUMENT_ADDRESS,name:i.DOCUMENT_DOCNAME,size:i.DOCUMENT_DOCSIZE,privateUrl:i.DOCUMENT_PRIVATEKEY})}}else JE.alert("文件保存失败，请稍后再试!")}}})}}}})},_BADGES:{},loadBadge:function(e,a){if("plus"==JE.getTheme()){var t={};JE.isNotEmpty(e)&&(t.funcCode=e),JE.ajax({url:JE.getUrlMaps("je.core.menu.loadBadge"),params:t,async:!0,success:function(e){var t=Ext.decode(Ext.value(e.responseText,"{}"));0!=t.success&&(Ext.iterate(t,function(e,t){if(JE.isNotEmpty(t)){t.cls=Ext.value(t.cls,"");var a=Ext.value(JE._BADGES[e],t),i=a.num=t.num;t.cls&&0==t.cls.indexOf("num-")?a.cls=t.cls.replaceAll("num-","badge-"):JE.isNotEmpty(t.cls)&&(a.cls="badge-"+t.cls),a.cls=Ext.value(a.cls,"badge-blue"),JE._BADGES[e]=a,JE.loadBadgeById(e,i);var r=a.parent||[];Ext.each(r,function(e){var t=JE._BADGES[e];if(t){var a=0;Ext.each(t.menus.split(","),function(e){var t=JE._BADGES[e];t&&(a+=JE.toNum(t.num))}),JE.loadBadgeById(t.id,a)}})}}),a&&a(t))}})}},loadBadgeById:function(a,i){var e=Ext.getCmp("_jewestview"),t=Ext.getCmp("_appcenterview"),r=JE._BADGES[a];if("plus"==JE.getTheme()&&!JE.isEmpty(a)&&!JE.isEmpty(r)){i=JE.toNum(Ext.value(i,r.num));if(e)if("appmenutiled"==e.xtype)e.loadBadge(a,i);else{var o=e.menu;e.items.each(function(e){var t=e.store.getNodeById(a);t&&t.set("nodeInfo",i)}),o&&o.items.each(function(e){var t=e.store.getNodeById(a);if(t)return t.set("nodeInfo",i),!1})}var l=Ext.getCmp("app-topmenu");if(l){var n=l.getCmp(a);if(n){var s=n.initialConfig.text;if(0<i)s+='<div class="badge '+Ext.value(r.cls,"")+'" style="'+Ext.value(r.style,"")+'">'+i+"</div>";n.setText(s)}l.menu&&l.menu.items.each(function(e){var t=e.store.getById(a);if(t)return t.set("nodeInfo",i),!1})}var c=Ext.getCmp("app-shortcutview");if(c){var d=c.store.getById(a);d&&(d.set({num:r.num,numCls:r.cls,numStyle:r.style}),d.commit())}if(t&&t.getCmp(a)){var u=t.getCmp(a),E=u.initialConfig.title;if(0<i)E+='<div class="badge '+Ext.value(r.cls,"")+' active" style="'+Ext.value(r.style,"")+'">'+i+'</div><div class="badge unactive">'+i+"</div>";u.setTitle(E),0==i&&u.tab&&u.tab.btnInnerEl&&u.tab.btnInnerEl.setStyle("padding-top","0px")}}},lockAPP:function(e){var t=Ext.getCmp("je-app-viewport").getCmp("applockview").lockField;t.inputEl.dom.setAttribute("type","text"),t.reset();var a=JE.currentUser.locked=0==e?"0":"1";Ext.getCmp("je-app-viewport").getLayout().setActiveItem(JE.toBool(a)?"applockview":"appmainview"),JE.ajax({url:JE.getUrlMaps("je.core.rbac.user","updateUserLocked"),async:!0,params:{locked:a}})},sendTransaction:function(e){(e=e||{}).titleText=Ext.value(e.title,"");var t=e.winCfg||{};delete e.title,delete e.winCfg,JE.win({title:"任务交办",width:t.width||940,height:t.height||JE.getBodyHeight()-150,border:0,autoShow:!0,items:Ext.apply({xtype:"jetpview"},e),showFn:e.showFn})},showTransaction:function(e,t,a){var i,r=e||{};if(Ext.isString(e)){if(r=JE.ajax({url:JE.getUrlMaps("je.core.getInfoById"),params:{tableCode:"JE_SYS_JOB",pkValue:e}}),JE.isEmpty(r))return void JE.alert("任务不存在！")}else e.isModel&&(i=e);JE.win({title:"任务内容",autoShow:!0,width:750,height:-1!=["send","sendchild"].indexOf(t)?550:400,items:{xtype:"jetpinfoview",initData:r,record:i,viewType:t,callback:a}})},sendSMS:function(e){var t=(e=e||{}).title||(JE.isEmpty(e.phone)?"公司成员短信发送":"手机号短信发送");delete e.title,JE.win({title:t,width:940,height:680,border:0,autoShow:!0,items:Ext.apply({xtype:"jesmsview"},e)})},sendEmail:function(e){var t=(e=e||{}).title||"邮件发送";e._title=e.title,delete e.title;var a=e.email||[];if(JE.isNotEmpty(a)){if(e.type=e.type||"SYS","USER"==e.type){var i=JE.ajax({url:JE.getUrlMaps("je.core.load"),params:{tableCode:"JE_SYS_EMAILCONFIG",whereSql:" and EMAILCONFIG_GSR_ID = '"+JE.USER.userId+"'",orderSql:" order by SY_ORDERINDEX",limit:-1}}).rows;Ext.each(i,function(e,t){a.push({text:e.EMAILCONFIG_ZHMC,code:e.EMAILCONFIG_YXDZ})})}else{var r=JE.systemConfig.JE_SYS_EMAIL_USERNAME;JE.isNotEmpty(r)&&a.push({text:r,code:r})}if(JE.isEmpty(a))return JE.alert("发件人信息为空，请检查配置！"),!1}e.emailSend=a;var o=e.callback;delete e.callback,JE.win({title:t,border:0,autoShow:!0,items:Ext.apply({xtype:"jeemailview"},e),showFn:function(e){o&&o(e)}})},doButtonLog:function(e){if("1"==JE.systemConfig.JE_SYS_BTNLOG&&JE.isNotEmpty(e.funcCode)){var t=-1==["gridInsertBtn","gridEditBtn","gridUpdateBtn","gridRemoveBtn","gridDisabledBtn","gridExportXLSBtn","formSaveBtn","formNewBtn","formCopyBtn","formBackBtn","actionUpdate","actionEdit","actionRemove","actionAdd"].indexOf(e.code)?"02":"01",a={funcName:e.funcName,funcCode:e.funcCode,funcId:e.funcId,btnId:e.button_id,btnName:e.text||e.tooltip,btnTypeName:JE.toDicText("JE_FUNC_BUTTONTYPE",e.type),btnTypeCode:e.type,btnNatureName:JE.toDicText("JE_FUNC_BUTTONNATURE",t),btnNatureCode:t};JE.ajax({url:JE.getUrlMaps("je.core.btnlog","insertBtnLog"),async:!0,params:a})}},showColor:function(a){JE.loadScript(["/static/ux/spectrum/spectrum.css","/static/ux/spectrum/spectrum.js"]);var e=jQuery(a.dom).spectrum({palette:Ext.value(a.colors,[["#000000","#434343","#666666","#999999","#b7b7b7","#cccccc","#d9d9d9","#efefef","#f1f1f1","#ffffff"],["#980000","#ff0000","#ff9900","#ffff00","#00ff00","#00ffff","#4a86e8","#0000ff","#9900ff","#ff00ff"],["#e6b8af","#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d9ead3","#c9daf8","#cfe2f3","#d9d2e9","#ead1dc"],["#dd7e6b","#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#a4c2f4","#9fc5e8","#b4a7d6","#d5a6bd"],["#cc4125","#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6d9eeb","#6fa8dc","#8e7cc3","#c27ba0"],["#a61c00","#cc0000","#e69138","#f1c232","#6aa84f","#45818e","#3c78d8","#3d85c6","#674ea7","#a64d79"],["#85200c","#990000","#b45f06","#bf9000","#38761d","#134f5c","#1155cc","#0b5394","#351c75","#741b47"],["#5b0f00","#660000","#783f04","#7f6000","#274e13","#0c343d","#1c4587","#073763","#20124d","#4c1130"]]),allowEmpty:!0,chooseText:"确定",cancelText:"取消",showInitial:!0,showPalette:!0,showSelectionPalette:!0,maxPaletteSize:10,preferredFormat:"hex",showInput:!0,change:function(e){var t=Ext.isEmpty(e)?"":e.toHexString();a.callback&&a.callback(t)}});return 0!=a.autoShow&&Ext.defer(function(){e.spectrum("show"),e.spectrum("set",a.value)},100),e},bytesToSize:function(e){if(0===e)return"0 B";var t=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,t)).toPrecision(3)+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][t]},getIconCls:function(e,t,a,i){if(!JE.isEmpty(e)){t=Ext.value(t,"iconCls"),a=Ext.value(a,"fontIconCls");var r=Ext.value(e[t],i);return"plus"==JE.getTheme()&&(r=Ext.value(e[a],r)),r}},changeTheme:function(e,t,a){if(a&&"leftMenu"==a){var i=["black","white","black-gradual","white-gradual"];Ext.each(i,function(e){Ext.getBody().removeCls("je-menu-"+e)}),-1==i.indexOf(e)&&(e="black"),window._JE_SYS_THEME_LEFTMENU=e,Ext.getBody().addCls("je-menu-"+e)}else{i=["black","blue","red","green","purple","gradual-one","gradual-two","gradual-three","gradual-four","gradual-five"];Ext.each(i,function(e){Ext.getBody().removeCls("je-theme-"+e)}),-1==i.indexOf(e)&&(e="blue"),Ext.getBody().addCls("je-theme-"+e)}if(t){i=Ext.value(JE.currentUser.theme,"blue,black,blue").split(",");a&&"leftMenu"==a?i[1]=e:i[0]=e,JE.ajax({url:JE.getUrlMaps("je.core.rbac.user","doUpdateInfo"),async:!0,params:{tableCode:"JE_CORE_ENDUSER",USERID:JE.currentUser.userId,THEME:i.join(",")}})}},getTheme:function(){return"plus"},split:function(e,t){return JE.isEmpty(e)?[]:e.split(t)},getLodop:function(e){return JE.loadScript("/static/ux/Lodop6/LodopFuncs.js"),getLodop(e)},loadScript:function(e,t,a){var i=this;i.loadedScripts=i.loadedScripts||{};var r=Ext.isArray(e)?e:[e],o=[],l=[];Ext.each(r,function(e){i.loadedScripts[e]||(-1!=e.indexOf(".js")?o.push(e):l.push(e),i.loadedScripts[e]=e)});a=a,t=t;Ext.isBoolean(t)&&(a=t,t=Ext.emptyFn),0<l.length&&Ext.require(l,t),0<o.length&&(a?Ext.require(o,t):Ext.syncRequire(o,t)),JE.isEmpty(l)&&JE.isEmpty(o)&&t&&t()},getLocalLang:function(e,t){if(!JE.local)return{};var a=JE.eval("JE.local.lang."+e);return t&&Ext.applyIf(a,JE.local.lang.common),Ext.value(a,{})},zipImage:function(n){if("undefined"!=typeof FileReader){var e="__je_single_file_image",t=Ext.get(e);t&&t.remove(),(t=Ext.getBody().insertHtml("afterBegin","<input type='file' style='position: absolute;height:0px;left:-500px;top:-500px;'  accept='image/*' id='"+e+"'>",!0)).on("change",function(e,t){var i=Ext.value(n.quality,.5),r=Ext.value(n.maxSize,0),o=t.files[0],l=o.type;if(/image\/\w+/.test(l)){var a=new FileReader;a.readAsDataURL(o),a.onload=function(e){var t=e.target.result,a=new Image;a.src=t,a.onload=function(){var e=document.createElement("canvas"),t=1;0<r&&(this.width>r||this.height>r)&&(t=this.width>this.height?r/this.width:r/this.height),e.width=this.width*t,e.height=this.height*t,e.getContext("2d").drawImage(this,0,0,e.width,e.height);var a=e.toDataURL(l,i);n.callback&&n.callback({url:a,name:o.name,size:o.size})}}}else JE.alert("请选择图片格式文件!")}),t.dom.click()}else JE.alert("您的浏览器不支持图片压缩，请选择主流浏览器！")},uploadFile:function(t){if(!JE.isEmpty(t)){Ext.isFunction(t)&&(t={callback:t});var r=Ext.apply({uploadUrl:JE.getUrlMaps("je.core.uploadFile"),uploadFieldName:"formUploadFiles",uploadFilePath:"",fileCount:0,fileTypes:"*"},t);r.uploadUrl=JE.replaceOldUrl(r.uploadUrl);var a=[];Ext.each(Ext.value(r.fileTypes,"*").split(";"),function(e){a.push("*."+e)}),r.fileTypes=a.join(";");var o=Ext.apply({filePath:r.uploadFilePath,uploadableFields:r.uploadFieldName,jeFileType:r.jeFileType||"PROJECT"},Ext.value(r.params,{}));if(o.jeFileType=o.jeFileType||"PROJECT",t.multiSelect){r.fileCount=r.multiSelect?r.fileCount:1;var e=JE.win({title:JE.local.lang.core.util.Util.uploadFileTitle,width:Ext.value(r.width,500),height:Ext.value(r.height,200),items:{xtype:"uploadpanel",file_types:r.fileTypes,file_upload_limit:t.fileSize?t.fileSize:r.fileCount,upload_url:r.uploadUrl+"?login=TRUE",file_post_name:r.uploadFieldName,post_params:o,failure:function(e,t,a){JE.error(t+"\n"+a)},success:function(e,t,a){var i=Ext.decode(Ext.value(t,"{}"),!0);i&&1==i.success?r.callback&&("all"==o.returnType?r.callback({url:i.obj.DOCUMENT_ADDRESS,docInfo:i.obj,name:e.name,size:e.size},i):r.callback({url:i.obj,name:e.name,size:e.size},i)):JE.error(t,t)}}});JE.isNotEmpty(r.x)||JE.isNotEmpty(r.y)?e.showAt([r.x,r.y]):e.show()}else{var i="__je_single_upload_form",l=Ext.get(i);l&&l.remove();var n=JE.format("<form id='{0}' style='position:relative;height:0px;left:-500px;top:-500px;'><input type='file' name='{1}'></form>",i,r.uploadFieldName),s=(l=Ext.getBody().insertHtml("afterBegin",n,!0)).first();s.on("change",function(e,a){var i=a.value.substring(a.value.lastIndexOf("\\")+1,a.value.length);if(JE.isNotEmpty(i)&&"*.*"!=r.fileTypes&&-1==r.fileTypes.split(";").indexOf("*"+i.substring(i.lastIndexOf(".")).toLowerCase()))return alert(JE.format(JE.local.lang.core.util.Util.uploadFileFileTypeAlert,r.fileTypes)),!1;Ext.isIE9m||!t.type||"local"!==t.type?(Ext.getBody().mask("文件上传中..."),Ext.isIE&&Ext.isIE9m&&(o.authorization=Ext.util.Cookies.get("authorization")),Ext.Ajax.request({form:l,url:r.uploadUrl,isUpload:!0,params:o,success:function(e){Ext.getBody().unmask();var t=Ext.decode(e.responseText,!0);t&&t.success?r.callback&&("all"==o.returnType?r.callback({url:t.obj.DOCUMENT_ADDRESS,privateUrl:t.obj.DOCUMENT_PRIVATEKEY,docInfo:t.obj,name:i,size:a.size},t):r.callback({url:t.obj,name:i,size:a.size},t)):JE.error(t&&t.obj,t)}})):r.callback(a)}),s.dom.click()}}},getFileUrl:function(e,t,a,i,r){if(!e&&!i)return e;var o=!1;"PUBLIC"==(t=t||"PROJECT")&&(o=!0,t="PROJECT");var l=[];JE.isNotEmpty(t)&&l.push("jeFileType="+t),JE.isNotEmpty(a)&&l.push("type="+a),JE.isNotEmpty(i)&&l.push("pkValue="+i),JE.isNotEmpty(r)&&l.push("beanTableCode="+r),JE.isNotEmpty(e)&&l.push("path="+e);var n=Ext.util.Cookies.get("authorization");JE.isNotEmpty(n)&&!o&&l.push("authorization="+n);var s=JE.getUrlMaps("je.core.doc.document","doLoadFile"),c=s;return 0<l.length&&(c=s+"?"+l.join("&")),c},printHtml:function(e,t,a){var i=this,r="printArea_";i.printAreaCount=Ext.value(i.printAreaCount,0);var o=Ext.get(r+i.printAreaCount);o&&o.destroy(),i.printAreaCount++;var l=r+i.printAreaCount;iframe=document.createElement("iframe"),iframe.setAttribute("id",l),iframe.setAttribute("style","position:absolute;width:0px;height:0px;left:-500px;top:-500px;"),document.body.appendChild(iframe);var n=iframe.contentDocument||iframe.contentWindow.document;n.open(),n.write(Ext.value(e,"")),n.close();var s=iframe.contentWindow||iframe.contentDocument;s.close(),s.focus(),t?(Ext.getBody().mask(Ext.value(t,JE.local.lang.core.util.Util.printHtmlMask)),Ext.defer(function(){Ext.getBody().unmask(),s.print()},Ext.value(a,1e3))):setTimeout(function(){s.print()},500)},sendMsgTo:function(e,t){},ajax:function(a){var t={};Ext.isString(a)&&(a={url:a});var e={method:"POST",async:!1,success:function(e){t=JE.getAjaxData(e,a.text)},failure:function(e){JE.error(e.responseText,a.url,JE.format(JE.getLocalLang("core.util.Util.ajaxError"),Ext.encode(a.params)))}};if(a.async&&(e={method:"POST"},a.mask)){var i=Ext.value(a.maskCmp,Ext.WindowManager.getActive()),r=i&&"window"==i.xtype?i.getEl():Ext.getBody();r.mask(Ext.value(a.maskMsg,"正在请求，请稍等..."),"je-ajax-mask");var o=!1;Ext.each(["success","failure","callback"],function(e){if(a[e]){o=!0;var t=a[e];a[e]=function(){Ext.callback(t,this,arguments),r.unmask()}}}),o||(a.callback=function(){r.unmask()})}return JE.isEmpty(a.timeout)&&JE.isNotEmpty(JE.systemConfig.JE_CORE_AJAXTIMEOUT)&&(a.timeout=1e3*JE.toNum(JE.systemConfig.JE_CORE_AJAXTIMEOUT)),JE.isNotEmpty(a.url)&&0==a.url.indexOf("/")&&(a.url=a.url.substring(1)),a.url=JE.getUrlMaps(a.url)||a.url,0==a.urlMaps||new RegExp("[.](js|css|json|html)","g").test(a.url)||(a.url=JE.replaceOldUrl(a.url)),e=Ext.apply(e,a),Ext.Ajax.request(e),t},getAjaxData:function(e,t){var a;return JE.isEmpty(e)?a:a=t?Ext.value(e.responseText,""):Ext.decode(Ext.value(e.responseText,"{}"))},saasAjax:function(a){var e="http://jesaas.com/"+a.url,t=a.params||{};t.phone="1",Ext.data.JsonP.request({url:e,params:t,callback:function(e,t){e&&a.callback&&a.callback(t)}})},submit:function(e,a){if(e.getForm().isValid()){var i=a.msgFn,r=a.error;delete a.error;var t={submitEmptyText:!1,failure:function(e,t){if(!r||0!=r(e,t))switch(t.failureType){case Ext.form.action.Action.CLIENT_INVALID:JE.alert(JE.local.lang.core.util.Util.submitClientInvalid,"warn");break;case Ext.form.action.Action.CONNECT_FAILURE:JE.error(JE.local.lang.core.util.Util.submitConnectFailure,a.url,"");break;case Ext.form.action.Action.SERVER_INVALID:i?i(t.result,JE.local.lang.core.util.Util.submitServerInvalid):JE.error(t.result.obj||t.result.message,t.result,"")}}};delete a.msgFn,JE.isEmpty(a.timeout)&&JE.isNotEmpty(JE.systemConfig.JE_CORE_AJAXTIMEOUT)&&(a.timeout=1e3*JE.toNum(JE.systemConfig.JE_CORE_AJAXTIMEOUT)),t=Ext.apply(t,a),e.getForm().submit(t)}},toFixed:function(e){if(20<e||e<0)throw new RangeError(JE.local.lang.core.util.Util.toFixedError);var t=this;if(isNaN(t)||t>=Math.pow(10,21))return t.toString();if(void 0===e||0==e)return Math.round(t).toString();var a=t.toString(),i=a.split(".");if(i.length<2){a+=".";for(var r=0;r<e;r++)a+="0";return a}var o=i[0],l=i[1];if(l.length==e)return a;if(l.length<e){a+=".";for(r=0;r<e-l.length;r++)a+="0";return a}a=o+"."+l.substr(0,e);var n=l.substr(e,e+1);if(5<=parseInt(n)){var s=Math.pow(10,e);a=(a=(parseFloat(a)*s+1)/s).toFixed(e)}return a},toRMBNumber:function(e){var t,a,i,r="",o="零壹贰叁肆伍陆柒捌玖",l="万仟佰拾亿仟佰拾万仟佰拾元角分",n=(e=new String(Math.round(100*e))).length,s=0;if(15<n)return alert("超出计算范围"),"";if(0==e)return r="零元整";l=l.substr(l.length-n,n);for(var c=0;c<n;c++)i=parseInt(e.substr(c,1),10),c!=n-3&&c!=n-7&&c!=n-11&&c!=n-15?0==i?(a=t="",s+=1):s=(a=(t=0!=i&&0!=s?"零"+o.substr(i,1):o.substr(i,1),l.substr(c,1)),0):(0!=i&&0!=s?(t="零"+o.substr(i,1),a=l.substr(c,1),s=0):0!=i&&0==s?(t=o.substr(i,1),a=l.substr(c,1),s=0):(a=0==i&&3<=s?t="":(t="",l.substr(c,1)),s+=1),c!=n-11&&c!=n-3||(a=l.substr(c,1))),r=r+t+a;return 0==i&&(r+="整"),r},message_tpl:'<div class="item"><div class="title">{title}<span class="close">x</span></div><div class="content">{content}</div></div>',msg:function(e,t){e=Ext.value(e,""),t=Ext.value(t,JE.local.lang.core.util.Util.msgTitle);JE.message_msg||(JE.message_msg=Ext.DomHelper.insertFirst(document.body,{cls:"je-message je-message-msg"},!0));var a=JE.toXT(JE.message_tpl,{title:t,content:e}),i=Ext.DomHelper.append(JE.message_msg,a,!0);i.hide(),i.slideIn("t").ghost("t",{delay:1e3,remove:!0})},notice:function(e,t,a,i){e=Ext.value(e,""),t=Ext.value(t,JE.local.lang.core.util.Util.msgTitle),i=Ext.value(i,!0);"0"!=JE.USER.sound&&i&&"0"!=JE.systemConfig.JE_SYS_PLAYAUDIO&&setTimeout(function(){JE.playAudio("/static/ux/media/notice.mp3")}),JE.message_notice||(JE.message_notice=Ext.DomHelper.insertFirst(document.body,{cls:"je-message je-message-notice"},!0));var r=JE.toXT(JE.message_tpl,{title:t,content:e}),o=Ext.DomHelper.append(JE.message_notice,r,!0);o.down(".title .close").on("click",function(){o.remove()}),o.hide(),o.slideIn("b"),0!=a&&o.ghost("b",{delay:Ext.value(a,5e3),remove:!0})},playAudio:function(e,t){if(!JE.isEmpty(e)){e=JE.buildCdnUrl(e);var a=t?"__JE_COMMON_AUDIO_VOICE":"__JE_COMMON_AUDIO",i=document.getElementById(a);if(i){if(!Ext.isIE9m&&0<i.currentTime&&!i.ended)return;document.body.removeChild(i)}return(i=document.createElement(Ext.isIE9m?"embed":"audio")).setAttribute("id",a),i.setAttribute("hidden",!0),i.setAttribute("src",e),Ext.isIE9m?i.setAttribute("autostart",!0):i.setAttribute("autoplay","autoplay"),document.body.appendChild(i),t?i:void 0}},loadI18NScript:function(){window._JE_LOCAL_LANG=Ext.util.Cookies.get("je-local-lang")||"zh_CN","en"==window._JE_LOCAL_LANG?JE.loadScript("/static/js/i18n/je-lang-en.js"):JE.loadScript(["/static/js/i18n/je-lang-zh_CN.js","/static/js/i18n/e-lang-zh_CN.js"])},loadAlertScript:function(){JE.loadScript(["/static/ux/jqueryConfirm/dist/jquery-confirm.min.css","/static/ux/jqueryConfirm/dist/jquery-confirm.min.js","/static/ux/popover/css/popover.css","/static/ux/popover/js/popover.min.js"],!0)},loadChartScript:function(e){e?JE.loadScript(["/static/ux/chart/EChart/4.0/echarts.min.js","/static/ux/chart/EChart/theme/shine.js","/static/ux/chart/EChart/theme/dark.js","/static/ux/chart/EChart/theme/infographic.js","/static/ux/chart/EChart/theme/macarons.js","/static/ux/chart/EChart/theme/vintage.js"]):JE.loadScript(["/static/ux/chart/FusionCharts/FusionCharts.js"])},loadVueScript:function(){},windowTitleNotice:function(e){JE.browser.isFocus||(JE.browser.noticeTitleFn&&JE.browser.noticeTitleFn.clear(),JE.browser.noticeTitle=Ext.value(e,"你有新消息"),JE.browser.noticeTitleFn=JE.defer(function(){if(-1==document.title.indexOf(JE.browser.noticeTitle))document.title="【"+JE.browser.noticeTitle+"】";else{for(var e="",t=0;t<JE.browser.noticeTitle.length;t++)e+="　";document.title="【"+e+"】"}},500))},desktopNotice:function(i,r,o,l,n){JE.windowTitleNotice(r),!JE.browser.isFocus&&window.Notification&&Notification.requestPermission(function(e){if("granted"==e){var t={body:Ext.value(i,"您有一条新消息！"),icon:Ext.value(l,"/JE/data/config/resource/logo.png"),renotify:JE.isNotEmpty(n),tag:n},a=new Notification(Ext.value(r,"消息提醒"),t);a.onclick=function(){window.focus(),o&&o(a)}}})},alert:function(e,t){JE.dialog(e,null,t,{alert:!0,icon:"fa fa-info-circle"})},confirm:function(e,t,a,i,r){JE.dialog(e,t,a,{confirm:!0,icon:"fa fa-question-circle",okText:i,cancelText:r})},prompt:function(e,t,a,i,r){e=Ext.value(e,""),i=Ext.value(i,"");e=['<div class="form-group">',"<label>"+e+"</label>",r?'<textarea class="value form-control" required ></textarea>':'<input type="text" placeholder="" class="value form-control" value="'+i+'"/>',"</div>"].join(""),JE.dialog(e,t,a,{prompt:!0,value:i})},dialog:function(e,a,t,i){e=Ext.value(e,""),a=Ext.value(a,Ext.emptyFn);var r=Ext.value(i,{});Ext.isObject(t)?r=Ext.applyIf(t,r):r.title=Ext.value(t,"");var o=Ext.value(r.buttons,{});if(Ext.iterate(o,function(e,t){Ext.isString(t)&&(o[e]={text:t})}),r.alert||r.confirm||r.prompt||r.okcancelButton){r.okcancelButton=!0;var l=Ext.value(r.okText,JE.local.lang.common.okButtonText),n=Ext.value(r.cancelText,JE.local.lang.common.cancelButtonText);o={ok:{btnClass:"btn-blue",text:l,keys:["enter"]},cancel:{text:n,keys:["esc"]}},r.alert&&delete o.cancel}var s={title:Ext.value(r.title,JE.local.lang.core.util.Util.msgTitle),content:e,buttons:o,type:Ext.value(r.type,"blue"),icon:r.icon,boxWidth:"30%",useBootstrap:!1,onAction:function(e){var t="";return r.prompt&&(t=this.$content.find(".value").val()),a(e,t)}};if("plus"!=JE.getTheme()&&(s.theme="light,jedefault",s.boxWidth="20%",r.okcancelButton&&(s.buttons.ok.btnClass="btn-green")),window.jconfirm){var c=window.jconfirm(s);c.onOpenBefore=function(){var e=c.$body,t=e.outerWidth(),a=30;Ext.iterate(c.buttons,function(e,t){a+=t.el.outerWidth()+JE.toNum(t.el.css("marginRight").replace("px",""))}),t<a&&e.width(a)}}},popOver:function(e,t,a,i,r){e=e;t=Ext.valueFrom(t,""),a=Ext.valueFrom(a,JE.local.lang.core.util.Util.noticeTitle),i=Ext.valueFrom(i,"right"),r=Ext.valueFrom(r,"body");var o=$(e).attr("id");Ext.isEmpty(o)&&(o=parseInt(1e5*Math.random()),$(e).attr("id",o));if($(e).attr("aria-describedby"))$(e).popover("destroy");else{$("[aria-describedby]").popover("destroy");$(e).popover({container:"body",trigger:"click",placement:i,title:a+'<span onclick="$(\'[aria-describedby]\').popover(\'destroy\');" class="JE_COMM_DELLETEHS16 pull-right" alt="关闭"></span>',html:!0,content:'<div style="word-break:break-all;">'+t+"</div>"});$(e).popover("toggle")}},formWin:function(e){var t=e.title,a=Ext.value(e.items,[]),i=e.iconCls,r=Ext.value(e.layout,"column"),o=(Ext.value(e.frame,!1),e.fn),l=Ext.value(e.width,400),n=Ext.value(e.height,300),s=l,c=Ext.value(e.height,150),d=Ext.value(e.defaults,{});if(autoScroll=Ext.value(e.autoScroll,!0),"fit"==r&&(autoScroll=!1),0<e.plusHeight)n=e.plusHeight;else if("plus"==JE.getTheme()){l+=100;var u=0;Ext.each(a,function(e){"hidden"==e.xtype||e.hidden||u++}),n+=60+12*u}JE.win({iconCls:i,title:t,minWidth:s,minHeight:c,width:l,height:n,maximizable:1==e.maximizable,showFn:e.showFn,items:[Ext.apply({xtype:"form",layout:r,itemId:"form",border:0,autoScroll:autoScroll,bodyPadding:"5",defaults:Ext.apply({labelAlign:"right",xtype:"textfield",labelWidth:80,columnWidth:1,margin:"1"},d),items:a},Ext.value(e.formConfig,{}))],useButton:Ext.value(e.useButton,!0),buttons:e.buttons,okButtonText:e.okButtonText,cancelButtonText:e.cancelButtonText,fn:function(e){var t=e.down("form");if(!t.isValid())return!1;var a=t.getForm().getValues();return o?o(a,e):void 0}}).show()},log:function(){var e=Array.prototype.slice.apply(arguments);e.unshift("log"),JE.windowConsole.apply(JE,e)},infoLog:function(){var e=Array.prototype.slice.apply(arguments);e.unshift("info"),JE.windowConsole.apply(JE,e)},warnLog:function(){var e=Array.prototype.slice.apply(arguments);e.unshift("warn"),JE.windowConsole.apply(JE,e)},errorLog:function(){var e=Array.prototype.slice.apply(arguments);e.unshift("error"),JE.windowConsole.apply(JE,e)},windowConsole:function(){try{window.console||(window.console={},window.console.log=window.console.info=window.console.warn=window.console.error=function(){});var e=Array.prototype.slice.apply(arguments),t=e[0];e=1<e.length?e.slice(1,e.length):[],window.console[t||"log"].apply(window.console,e)}catch(e){}},hasOnlineClass:function(e){var t=!0;return 0!=e.indexOf("PRO.")&&Ext.get("JE-all-min-JS")&&Ext.isEmpty(Ext.ClassManager.get(e))&&(t=!1),t},initCtr:function(e,t){Ext.isEmpty(e)||JE.getApplication().getController(e)},win:function(a){if(a.useButton){if(Ext.applyIf(a,{buttonAlign:"center"}),a.buttons=[{text:Ext.value(a.okButtonText,JE.local.lang.common.okButtonText),cls:"btn JEPLUS_B_L10",iconCls:"jeicon jeicon-check",fontIconCls:"fa fa-check",itemId:"okButton",handler:function(e){var t=e.up("window");a.fn?0!=a.fn(t)&&t.close():t.close()}},{text:Ext.value(a.cancelButtonText,JE.local.lang.common.cancelButtonText),cls:"btn",fontIconCls:"fa fa-close",iconCls:"jeicon jeicon-error",itemId:"cancelButton",handler:function(e){e.up("window").close()}}],Ext.isArray(a.useButton)){var i=[];Ext.each(a.useButton,function(t){Ext.isObject(t)?i.push(t):Ext.each(a.buttons,function(e){if(t==e.itemId)return i.push(e),!1})}),a.buttons=i}Ext.each(a.buttons,function(e){e.iconCls=JE.getIconCls(e)})}var e=a.autoShow;delete a.autoShow;var t=Ext.create("Ext.window.Window",Ext.apply({modal:!0,maximizable:!0,width:JE.getBodyWidth()-100,height:JE.getBodyHeight()-100,layout:"fit"},a));return a.showFn&&t.on("show",function(e){a.showFn(e)}),e&&t.show(),t},getBodyWidth:function(){return Ext.getBody().getBox().width},getBodyHeight:function(){return Ext.getBody().getBox().height},systemError:function(e){var t;try{t=Ext.isString(e)?Ext.decode(e):e}catch(e){}if(t&&!t.success&&t.errorCode&&"0"==JE.systemConfig.JE_SYS_ERRORTYPE){if("1101"==t.errorCode)return;return JE.win(Ext.apply({title:t.code+"("+t.errorCode+")",height:500,width:700,html:t.message,autoShow:!0},t.exceptionId?{useButton:!0,okButtonText:"查看异常",cancelButtonText:"关闭",fn:function(){JE.showFuncForm("JE_CORE_EXCEPTION",t.exceptionId,!0)}}:{})),!0}},error:function(e,t,a){if(0!=(e=(e||"")+"").indexOf("Uncaught NetworkError: Failed to execute 'send' on 'XMLHttpRequest'")){if(-1==e.indexOf(" JSON ")){JE.log(e,t,a);var i=JE.systemConfig.JE_SYS_ERRORPHONE||"400-0999-235";e=Ext.value(e,"系统功能正在更新中，请稍后！<br/>联系电话："+i),e='<i class="jeicon jeicon-error-circle close" style="position: absolute;right: 10px;top: 10px;font-size: 20px;color: #ddd;cursor: pointer;"></i><div style="text-align:center;"><img style="width:250px;" src="'+JE.getStaticUrl("JE.common.error")+'"></div><div style="padding: 10px;text-align: center;font-size: 14px;font-family: 微软雅黑;font-weight: bold;color: #757575;">'+e+"</div>",JE.win({title:"",bodyPadding:20,width:400,height:280,html:e,header:!1,resizable:!1,maximizable:!1,minimizable:!1,autoShow:!0,showFn:function(t){t.getEl().on("click",function(e){e.getTarget("i.close",1)&&t.close()})}})}}else JE.logout()},getFuncData:function(e,t){var a=t;return Ext.isBoolean(a)&&(a={refresh:a}),Ext.create("JE.core.util.FuncUtil").getFuncData(e,a)},getFunc:function(e,t){var a;try{a=Ext.create("JE.core.util.func.Func",{funcCode:e,idSuffix:t})}catch(e){}return a},getFuncView:function(e,t,a){var i;if(Ext.isEmpty(t))return i;var r=e+"_je"+t+"view";a=Ext.value(a,"");return Ext.isEmpty(a)&&(a="_window",(i=Ext.getCmp(r+a))||(a="")),i=Ext.getCmp(r+a)},getFuncPermSql:function(e){var t=JE.CoreUtil.getUSPremData("FUNCPERM",e),a={info:{},permInfo:{}};return Ext.create("JE.core.util.PermUtil").buildDataPerm(a,t),JE.toXT(a.info.permSql)},showDicFunc:function(r,o){o=Ext.value(o,{});var e=JE.ajax({url:JE.getUrlMaps("je.core.dd.dd","initLoad"),params:{tableCode:"JE_CORE_DICTIONARY",limit:1,whereSql:" AND DICTIONARY_DDCODE='"+r+"'"}}).rows[0];if(e){if(-1==["TREE","LIST"].indexOf(e.DICTIONARY_DDTYPE))return void JE.alert("只支持列表和树形字典编辑！");var l="JE_CORE_DICTIONARYITEM"+("1"==e.DICTIONARY_ZWFFLAG?"_ZWF":""),t=!(o.winConfig={title:e.DICTIONARY_DDNAME,useButton:!0,okButtonText:o.field?"更新组件":"更新缓存",fn:function(e){var t=JE.getFuncView(l,"grid");if(t){var a=t.getStore().getUpdatedRecords().concat(t.getStore().getNewRecords());if(JE.isNotEmpty(a)){var i=t.getButton("gridUpdateBtn");i&&i.fireEvent("click",i)}}JE.ajax({url:JE.getUrlMaps("je.core.dd.dd","clearCache"),params:{ddCode:r}}),delete JE.dicListData[r],o.field?(o.field.refreshItems&&o.field.refreshItems(),JE.msg("更新完成！")):JE.msg("更新完成，请刷新功能！")}});"1"==JE.systemConfig.SY_JECORE&&"1"==e.SY_JECORE&&(t=!0);var a=JE.getFuncData(l);JE.showFunc(l,Ext.applyIf({whereSql:Ext.value(a.info.whereSql,"")+" and DICTIONARYITEM_DICTIONARY_ID = '"+e.JE_CORE_DICTIONARY_ID+"'",values:{DICTIONARYITEM_DICTIONARY_ID:e.JE_CORE_DICTIONARY_ID,DICTIONARY_DDTYPE:e.DICTIONARY_DDTYPE},readOnly:t},o)),t&&JE.msg("系统字典不支持编辑！")}else JE.alert("字典【"+r+"】不存在!")},showFuncForm:function(e,t,a,i,r,o){JE.showFunc(e,{id:t,readOnly:a,type:"form",callback:i,width:r,height:o})},showFunc:function(e,s){s=Ext.value(s,{});var c=JE.getFuncData(e,{funcPerm:s.funcPerm}),t=Ext.value(s.values,{}),o=s.type;c.info=Ext.apply(c.info,Ext.value(s.info,{})),c.info.orderSql=Ext.value(s.orderSql,c.info.orderSql),c.info.whereSql+=" "+Ext.value(s.whereSql,""),c.info.treeParentSql=Ext.value(s.whereSql,"");var a=Ext.value(s.idSuffix,"_window"),d={};if("form"==o){if(JE.isNotEmpty(s.id)){t=JE.ajax({url:JE.getUrlMaps("je.core.getInfoById"),params:{tableCode:Ext.value(c.info.viewTableName,c.info.tableName),pkValue:s.id}})}else{var i=Ext.apply(c.getDefVals(t),t);s.useTreeDefVals&&Ext.apply(i,JE.Action.doTreeBeforeSave(c.info)),t=i}if(c.info.idSuffix=a,d.items={xtype:s.useForm?"jeformview":"jeeditview",funcData:c,useChild:Ext.value(s.useChild,!1),mainData:t},s.useForm&&(d.items.xtype="jeformview",d.items.id=c.info.funcCode+"_jeformview"+a),!Ext.isEmpty(c.info.winFormWH)){var r=c.info.winFormWH.split(",");Ext.isEmpty(r[0])||(s.width=Ext.value(s.width,Number(r[0]))),Ext.isEmpty(r[1])||(s.height=Ext.value(s.height,Number(r[1])),JE.toNum(s.height)>JE.toNum(JE.getBodyHeight())&&(s.height=JE.getBodyHeight()-110))}!s.field&&"0"==JE.systemConfig.JE_SYS_FORMWINCLOSEBTN||(d.useButton=[{text:s.cancelButtonText||"关闭",cls:"btn JEPLUS_B_L10",itemId:"close",handler:function(e){e.up("window").close()}}],d.buttonAlign="center")}else{if(JE.isNotEmpty(s.columns)){var l=[{xtype:"rownumberer",width:40,align:"center",text:"No."}];Ext.each(s.columns,function(i){Ext.each(c.grid.columns,function(e){if(e.dataIndex==i.dataIndex){var t=i.field;delete i.field;var a=Ext.apply(e,i);return t&&Ext.each(["field","searchField","editField"],function(e){a[e]&&Ext.apply(a[e],t)}),l.push(a),!1}})}),c.grid.columns=l}d.items={xtype:"jemainview",bodyPadding:1,idSuffix:a,funcData:c,border:0,mainData:t}}return d=Ext.apply(d,{title:Ext.value(s.title,c.info.funcName),width:Ext.value(s.width,JE.getBodyWidth()-100),height:Ext.value(s.height,JE.getBodyHeight()-100),border:0}),JE.isNotEmpty(s.winConfig)&&Ext.apply(d,s.winConfig),(d=JE.win(d)).show(null,function(){var l=d.items.get(0),n=l.mainData;if("form"==o){l=s.useForm?l:l.getCmp("jeformview"),s.hideTbar&&l.getDockedComponent("buttonBar").hide();var e=Ext.create(c.info.modelName,n);l.loadRecord(e),JE.CoreUtil.setChildInfo({funcData:l.funcData,data:e.data}),l.fireEvent("selfactivate",l),JE.Action.doReadFuncEdit(l,e);var t=l.getDockedComponent("buttonBar").down("button[ref=formBackBtn]");if(t&&(t.hide(),t.noReadOnly=!0),s.readOnly)if(l.useWF){var a=l.getDockedComponent("buttonBar").query("[wfButton]");Ext.each(a,function(e){e.hide()})}else l.setReadOnly(!0);else l.useWF||l.formSaveBtnPrem()||l.setReadOnly(!0);if(s.callback&&s.callback(l),setTimeout(function(){l.doLayout()},200),d.on("close",function(){var e=Ext.getCmp(c.info.funcCode+"_jegridview");if(e){var t=l.form.getValues(),a=t[c.info.pkName];if(JE.isNotEmpty(a)){var i=e.store.getById(a);if(i){i.set(t),i.commit();var r=Ext.getCmp(c.info.funcCode+"_jeformview"),o=Ext.getCmp(c.info.funcCode+"_jecenterview");r&&"jeeditview"==o.getLayout().getActiveItem().xtype&&a==r.form.findField(c.info.pkName).getValue()&&Ext.isEmpty(n.__doTaskForm)&&e.fireEvent("itemdblclick",e.view,i)}}}}),JE.isNotEmpty(s.field)&&"0"!=JE.systemConfig.JE_SYS_FORMWINCLOSEBTN){var i=d.getDockedItems('toolbar[ui="footer"]')[0];i.getCmp("close").getEl().removeCls("JEPLUS_B_L10"),i.insert(0,{text:"保存并使用本条数据",cls:"btn JEPLUS_B_L10",iconCls:JE.getIconCls({iconCls:"jeicon jeicon-check",fontIconCls:"fa fa-check"}),handler:function(){var e=l.getValue(c.info.pkName);if(JE.isNotEmpty(e)){var a=s.field,i=l.getValue(),r={};Ext.each(a.configData.valueNames,function(e,t){r[a.configData.fieldNames[t]]=i[e]}),a.formObj.setValues(r),d.close()}else{if(!l.getForm().isValid())return;var t=l.getButton("formSaveBtn");t&&(l.on({endsubmit:{fn:function(e,t,a,i){var r=s.field,o=i,l={};Ext.each(r.configData.valueNames,function(e,t){l[r.configData.fieldNames[t]]=o[e]}),r.formObj.setValues(l),d.close()},single:!0}}),t.fireHandler())}}})}}else var r=setInterval(function(){var e=Ext.getCmp(c.info.funcCode+"_jegridview"+c.info.idSuffix);if(e){if(clearInterval(r),e.mainData=n,"grid"==o){var t=e.getDockedComponent("buttonBar").down("button[ref=gridEditBtn]");t&&t.hide()}s.readOnly&&l.setReadOnly(!0),JE.isNotEmpty(s.queryParams)&&Ext.apply(e.store.proxy.extraParams,s.queryParams),s.hideTbar&&e.getDockedComponent("buttonBar").hide(),s.callback&&s.callback(l)}},50)}),d},printFunc:function(e,t){t=Ext.value(t,{});JE.isEmpty(e)?JE.alert("请选择功能编码！"):Ext.create("JE.core.util.PrintUtil").printFunc(e,t)},showIddt:function(e,t,a,i){JE.initCtr(t);var r={xtype:a};i&&(r=Ext.applyIf(r,i)),JE.win({title:e,items:r}).show()},showChart:function(e,t){if(JE.isEmpty(e))JE.alert(JE.format(JE.local.lang.core.util.Util.showChartAlert,""));else{var a=JE.ajax({url:JE.getUrlMaps("je.core.load"),params:{tableCode:"JE_CORE_CHARTS",whereSql:"and CHARTS_CODE = '"+e+"'",limit:1}}).rows[0];if(JE.isEmpty(a))JE.alert(JE.format(JE.local.lang.core.util.Util.showChartAlert,e));else{var i=(t=Ext.value(t,{})).hideSearchBar,r=Ext.value(t.params,{}),o={xtype:"jechartview",chartBean:a,chartCode:e,hideSearchBar:i,chartAttrs:Ext.value(t.chartAttrs,{}),chartParams:r,listeners:t.listeners};delete t.listeners,JE.win(Ext.apply(t,{title:Ext.value(t.title,JE.local.lang.core.util.Util.showChartTitle),border:0,items:o})).show()}}},showReport:function(e,t){if(JE.isEmpty(e))JE.alert(JE.format(JE.local.lang.core.util.Util.showReportAlert,""));else{var a=JE.ajax({url:JE.getUrlMaps("je.core.load"),params:{tableCode:"JE_CORE_REPORT",whereSql:"and REPORT_CODE = '"+e+"'",limit:1}}).rows[0];if(JE.isEmpty(a))JE.alert(JE.format(JE.local.lang.core.util.Util.showReportAlert,e));else{var i={xtype:"jereportview",reportBean:a,reportCode:e,hideSearchBar:(t=Ext.value(t,{})).hideSearchBar,reportParams:Ext.value(t.params,{}),editable:1==t.editable,values:Ext.value(t.values,{}),listeners:t.listeners};delete t.listeners,JE.win(Ext.apply(t,{title:Ext.value(t.title,JE.local.lang.core.util.Util.showReportTitle),border:0,items:i})).show()}}},getActionUrls:function(e){return{load:(e=Ext.value(e,"/je"))+JE.getUrlMaps("method.load"),save:e+JE.getUrlMaps("method.doSave"),update:e+JE.getUrlMaps("method.doUpdate"),copy:e+JE.getUrlMaps("method.doCopy"),remove:e+JE.getUrlMaps("method.doRemove"),disable:e+JE.getUrlMaps("method.doDisable"),updateList:e+JE.getUrlMaps("method.doUpdateList"),insertUpdateList:e+JE.getUrlMaps("method.doInsertUpdateList")}},toStr:function(e){return Ext.isEmpty(e)?"":Ext.isObject(e)||Ext.isArray(e)?JE.encode(e):e+""},getObjAttr:function(e,t){if(!JE.isEmpty(e))return Ext.isString(e)&&(e=JE.decode(e)),e[t]},toObj:function(e){return Ext.isEmpty(e)?null:JE.decode(e,!0)},toBool:function(e){return"1"==e},toNum:function(t){var e=0;try{Ext.isNumeric(t)&&(e=Number(t,0))}catch(e){JE.error(e.message,t+JE.local.lang.core.util.Util.toNumError,"")}return e},toNumStr:function(e,t){e=JE.toNum(e)+"";for(var a=0;a<t-e.length;a++)e="0"+e;return e},toDefVal:function(e,t){if(!Ext.isString(e))return e;var a;switch(e=Ext.value(e,"").trim()){case"@USER_ID@":a=JE.currentUser.userId;break;case"@USER_CODE@":a=JE.currentUser.userCode;break;case"@USER_NAME@":a=JE.currentUser.username;break;case"@USER_JTGSMC@":a=JE.currentUser.jtgsMc;break;case"@USER_JTGSID@":a=JE.currentUser.jtgsId;break;case"@USER_ZHID@":a=JE.currentUser.zhId;break;case"@USER_ZHMC@":a=JE.currentUser.zhMc;break;case"@DEPT_ID@":a=JE.currentUser.deptId;break;case"@DEPT_CODE@":a=JE.currentUser.deptCode;break;case"@DEPT_NAME@":a=JE.currentUser.deptName;break;case"@DEPT_PATH@":a=JE.currentUser.dept.path;break;case"@IS_MANAGER@":a=JE.currentUser.isManager;break;case"@NOW_DATE@":a=Ext.Date.format(new Date,"Y-m-d");break;case"@NOW_MONTH@":a=(new Date).getMonth()+1;break;case"@NOW_YEAR@":a=(new Date).getFullYear();break;case"@NOW_TIME@":a=Ext.Date.format(new Date,"Y-m-d H:i:s");break;case"@USER_MONITORDEPT@":a="'"+Ext.value(JE.currentUser.monitorDeptCode,"").replaceAll(",","','")+"'";break;case"@USER_DEPTFZR@":a="'"+Ext.value(JE.currentUser.dept.chargeUser,"").replaceAll(",","','")+"'";break;case"@COMPANY_QUERYIDS@":a="'"+Ext.value(JE.currentUser.dept.jtjggsId,"").replaceAll(",","','")+"'";break;default:var i=e.match(/\@.*?\@/g);if(!Ext.isEmpty(i)){var r=i[0].replaceAll("@",""),o=r.split("."),l=o[0];if(1<o.length){if("USER"==l&&(a=JE.currentUser),JE.isNotEmpty(a)&&Ext.isObject(a))for(var n=1;n<o.length;n++)a=a[o[n]]}else a=Ext.value(JE.systemConfig[r])}}return Ext.isEmpty(t)||null!=a||(a=t[e]),a=null==a?e:a},toXT:function(a,e,t){if(Ext.isEmpty(a))return"";var i=Ext.clone(Ext.value(e,{}));if(JE.isNotEmpty(t)){a=a.replaceAll("parent.","parent__");var r={};Ext.iterate(t,function(e,t){r["parent__"+e]=t}),Ext.apply(i,r)}var o=a.match(/\{@.*?\@}/g);Ext.each(o,function(e){var t=e.replaceAll("[.]","_").replaceAll("@","_");a=a.replaceAll(e,t),t=t.replace("{","").replace("}",""),e=e.replace("{","").replace("}",""),i[t]=JE.toDefVal(e)});var l=(a=new Ext.XTemplate(a)).apply(i);o=l.match(/\{.*?\}/g);return Ext.each(o,function(e){var t=e.replace("{","").replace("}","");i.hasOwnProperty(t)&&(l=l.replaceAll(e,i[t]))}),l},toDicText:function(e,t){if("LIST"!=Ext.value(JE.dicInfoData[e],{DICTIONARY_DDTYPE:"LIST"}).DICTIONARY_DDTYPE)return t;var a=JE.getDicItems(e,!0),i="";if(JE.isNotEmpty(t)){var r=[];Ext.each(t.split(","),function(e){var t=Ext.value(a[e],{text:""});r.push(t.text)}),i=r.join(",")}return i},getChartDS:function(e){return Ext.create("JE.core.util.chart.ChartDS",e)},getDataSource:function(e){return JE.getChartDS(e)},doMask:function(e,t,a,i){var r;e&&((r=Ext.isElement(e.dom)?e:e.getEl())?(t=Ext.value(t,JE.local.lang.core.util.Util.doMaskMsg),r.mask(t,i),Ext.defer(function(){a&&a(),r.unmask()},100)):a&&a())},doWait:function(e){},timeLog:function(e,t){if(Ext.isDate(e)){var a=((new Date).getTime()-e.getTime())/1e3;t=Ext.value(t,JE.local.lang.core.util.Util.timeLogMsg),JE.infoLog(t,":",a,JE.local.lang.core.util.Util.timeLogUnit)}},scrollBy:function(e,t,a){e&&t&&((e.el||e).scrollByEl(t,!0),a&&t&&(Ext.isBoolean(a)?t.highlight():t.highlight(a.color,a.cfg)))},buildFuncTree:function(){JE.getUrlMaps("je.core.dd.tree","loadTreeData"),tableName,whereSql},getDicItems:function(e,t,a){var i=JE.dicListData[e],r=Ext.value(JE.dicInfoData[e],{DICTIONARY_DDTYPE:"LIST"});if(JE.isNotEmpty(e)&&(Ext.isEmpty(i)||!Ext.isEmpty(a))){var o=r.DICTIONARY_DDTYPE,l=!1;if(Ext.isBoolean(a)&&(l=a,a=""),"LIST"==o)0==(i=JE.ajax({url:JE.getUrlMaps("je.core.dd.dd.getDicItemByCode"),params:{tableCode:"JE_CORE_DICTIONARY",DICTIONARY_DDCODE:e,whereSql:Ext.value(a,""),DICTIONARY_ZWFFLAG:Ext.value(r.DICTIONARY_ZWFFLAG,"0")}})).success&&(i=[]),!l&&Ext.isEmpty(a)&&JE.isNotEmpty(i)&&(JE.dicListData[e]=i);else{i=[];var n=JE.getDicItems4Tree(e,{whereSql:a});Ext.each(n,function(e){i.push({id:e.id,code:e.code,text:e.text,iconCls:e.iconCls,icon:e.icon,iconClsImage:"",textColor:"",backgroundColor:""})})}}if(1!=t)return i=Ext.value(i,[]);var s={};return Ext.isEmpty(i)||Ext.each(i,function(e){s[e.code]=e}),s},getDicItems4Tree:function(e,t){var a=(t=t||{}).whereSql||"",i=t.excludes||"checked",r=JE.dicInfoData[e],o=[];return r&&(o=JE.ajax({url:JE.getUrlMaps("je.core.dd.tree","loadTree"),params:{node:"ROOT",onlyItem:!0,excludes:i,strData:Ext.encode([{ddCode:e,whereSql:a,ddName:"",async:!1,orderSql:"",parentSql:"",rootId:"",nodeInfo:"",params:{},moreRoot:!1,zwfFlag:Ext.value(r.DICTIONARY_ZWFFLAG,"0")}])}})),o},selectWin:function(e){var t=Ext.create("JE.core.view.SSWinView",e);return t.show(),t},showWFView:function(e){JE.Action.doWfSingleView(e)},showFuncCfg:function(a,e,i,r){e=Ext.value(e,"main");r=Ext.value(r,{});var t={title:JE.local.lang.core.util.Util.showFuncCfgTitle,autoShow:!0,bodyPadding:1,items:[{xtype:"funccfg."+e,border:0}]};"fieldform"==e||"columnform"==e||"simplefunc"==e?(t.width=310,t.minWidth=310,t.height=JE.getBodyHeight(),t.x=JE.getBodyWidth()-t.width,t.modal=!1,"columnform"==e?t.x=t.x-t.width:"simplefunc"==e&&(t.modal=!0)):"powerview"==e&&(t.width=950,t.height=700,t.autoShow=!0,t.height=Ext.getBody().getHeight()-245),"powerview"==e&&(t.width=1e3,t.height=JE.getBodyHeight()-150,t.items[0].powerTypes=r.type,t.items[0].funcInfo=r.funcInfo,t.items[0].selfContr=r.selfContr,t.items[0].cmp=r.cmp),-1!=["main","fieldform"].indexOf(e)&&("fieldform"==e&&r.onlyField?(t.modal=!0,t.items[0].hideEditColBtn=!0):(t.modal=!1,Ext.getBody().mask(),t.listeners={close:function(e){var t=Ext.getCmp("funccfg.columnform");t&&t.ownerCt.close(),Ext.getBody().unmask()}})),t.showFn=function(e){var t=e.items.get(0);t.otherCfg=r,t.loadFunc(a,i)},JE.win(t)},random:function(e,t){return t=Ext.value(t,0),parseInt(Math.random()*(e-t+1)+t)},uuid:function(e){return"xxxxxxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},eval:function(str,errorMsg,showError){if(Ext.isEmpty(str))return str;var obj;try{obj=Ext.isIE8?eval("(0,"+str+")"):eval("("+str+")")}catch(e){console.trace&&console.trace("eval出错了"),Ext.isEmpty(errorMsg)||(e=errorMsg+"</br>"+e),0!=showError&&JE.error(e)}return obj},getIconTpl:function(e,t){var a='<input type="button" class="{iconCls} je-button-icon"  {style} {onclick} />';Ext.isEmpty(e)||(a=a.replace("{iconCls}",e));t=Ext.applyIf(Ext.value(t,{}),{style:"",onclick:""});return Ext.iterate(t,function(e,t){JE.isNotEmpty(t)&&(t=e+'="'+t+'" '),a=a.replace("{"+e+"}",t)}),a},getUEditorBox:function(e,t){return'<div class="'+(t?"ueditor-box":"ueditor-box ueditor-box-html")+'">'+(e=Ext.value(e,""))+"</div>"},toBigButton:function(e,t){return"plus"==JE.getTheme()||0==t||Ext.isEmpty(e.bigIconCls)||"ACTION"==e.type||(e.tooltip=Ext.value(e.text,e.tooltip),e.iconCls=e.bigIconCls,e.scale="large",delete e.text),e},copy:function(e){window.clipboardData.setData("Text",e),JE.alert(JE.local.lang.core.util.Util.copyAlert)},previewImage:function(e,t,a){var i=".jpg,.bmp,.gif,.png",r=e.value.substring(e.value.lastIndexOf(".")+1).toLowerCase(),o=window.navigator.userAgent.toUpperCase();if(imgTpl='<img  src="{src}" style="'+(a=a&&""!=a?a:"")+'" />',-1<i.indexOf(r))if(e.files)if(window.FileReader){var l=new FileReader;l.onload=function(e){t.innerHTML=imgTpl.replace("{src}",e.target.result)},l.readAsDataURL(e.files[0])}else-1<o.indexOf("SAFARI")&&alert(JE.local.lang.core.util.Util.previewImageAlert);else if(-1<o.indexOf("MSIE"))-1<o.indexOf("MSIE 6")?url=e.value:(e.select(),-1<o.indexOf("MSIE 9")&&e.blur(),t.innerHTML='<div style="'+a+"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod='scale',src="+document.selection.createRange().text+')"></div>');else if(-1<o.indexOf("FIREFOX")){var n=parseFloat(o.toLowerCase().match(/firefox\/([\d.]+)/)[1]);t.innerHTML=n<7?imgTpl.replace("{src}",e.files[0].getAsDataURL()):imgTpl.replace("{src}",window.URL.createObjectURL(e.files[0]))}else t.innerHTML=imgTpl.replace("{src}",e.value);else alert(JE.format(JE.local.lang.core.util.Util.previewImageAlert2,i)),e.value="",-1<o.indexOf("MSIE")&&(e.select(),document.selection.clear()),e.outerHTML=e.outerHTML},preFillUp:function(e,t,a){for(var i="",r=0;r<t-(e+"").length;r++)i+=a;return i+e},isNaN:function(e,t){return isNaN(e)?t=t||"":e},isEmpty:function(e){return Ext.isObject(e)?Ext.Object.isEmpty(e):Ext.isEmpty(e)},isNotEmpty:function(e){return!JE.isEmpty(e)},getXTypeByClassName:function(e){Ext.isEmpty(Ext.ClassManager.get(e))&&Ext.syncRequire(e);var t=Ext.ClassManager.getAliasesByName(e)[0];return t=Ext.value(t,"").replace("widget.","")},encode:function(e){if(null==e)return"null";if(Ext.isDate(e))return Ext.Date.format(e,"Y-m-d H:i:s");if(Ext.isArray(e)){var t=["[",""],a=e.length;for(i=0;i<a;i+=1)t.push(JE.encode(e[i]),",");return t[t.length-1]="]",t.join("")}if(Ext.isObject(e)){var i,r;t=["{",""];for(i in e)if(r=e[i],e.hasOwnProperty(i)){if(void 0===r)continue;t.push(JE.encode(i),":",JE.encode(r),",")}return t[t.length-1]="}",t.join("")}return"function"==typeof e?Ext.encode(e.toString()):Ext.encode(e)},decode:function(e,t){return Ext.decode(e,t)},encodeURI:function(e){return encodeURIComponent(e)},decodeURI:function(e){return decodeURIComponent(e)},format:function(e,t){if(JE.isEmpty(e))return"";if(Ext.isDate(e))return Ext.util.Format.date(e,t);if(Ext.isString(e))return Ext.util.Format.format.apply(Ext.util.Format,arguments);if(JE.isNotEmpty(t)&&"number"==typeof e&&isFinite(e)){var a="";return e<0&&(e=-e,a="-"),a+Ext.util.Format.number(e,t)}return""},insertAtCursor:function(e,t){if(document.selection)document.selection.createRange().text=t;else if("number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd){var a=e.selectionStart,i=e.selectionEnd,r=a,o=e.value;e.value=o.substring(0,a)+t+o.substring(i,o.length),r+=t.length,e.selectionStart=e.selectionEnd=r}else e.value+=t},moveCursorEnd:function(e){e.focus();var t=e.value.length;if(document.selection){var a=e.createTextRange();a.moveStart("character",t),a.collapse(),a.select()}else"number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd&&(e.selectionStart=e.selectionEnd=t)},numberToLetter:function(e){var t={0:"A",1:"A",2:"B",3:"C",4:"D",5:"E",6:"F",7:"G",8:"H",9:"I",10:"J",11:"K",12:"L",13:"M",14:"N",15:"O",16:"P",17:"Q",18:"R",19:"S",20:"T",21:"U",22:"V",23:"W",24:"X",25:"Y",26:"Z"}[e];return t||JE.local.lang.core.util.Util.numberToLetterEmptyText},openWindow:function(e,t,a){var i=JE.uuid().replaceAll("-","_"),r={width:screen.availWidth,height:screen.availHeight,top:0,left:0,toolbar:"no",menubar:"no",scrollbars:"yes",resizable:"yes",location:"no",status:"no"},o=[];Ext.apply(r,Ext.value(a,{})),a&&Ext.isEmpty(a.top)&&Ext.isEmpty(a.left)&&(r.top=(screen.availHeight-r.height)/2,r.left=(screen.availWidth-r.width)/2),Ext.iterate(r,function(e,t){o.push(e+"="+t)}),o.join(",");function l(e,t){var a=document.getElementsByClassName("pagebody");"X"!=t&&""!=t||(n+="+"==e?.01:-.01),"Y"!=t&&""!=t||(s+="+"==e?.01:-.01);for(var i=0;i<a.length;i++){a[i].style["-webkit-transform"]="scale("+n+","+s+")"}}var n=1,s=1;if(JE.isEmpty(t)){var c=new Image;c.src=e;var d=window.open("","_blank");d.document.write(c.outerHTML),d.document.title="导出图片",d.document.close()}else{var u=document.createElement("form");u.method="post",u.action=e,u.target=i,Ext.iterate(t,function(e,t){var a=document.createElement("input");a.type="hidden",a.name=e,a.value=Ext.value(t,""),u.appendChild(a)}),document.body.appendChild(u);var E=JE.decodeURI(t.htmlTpl),p=JE.win({xtype:"panel",layout:"fit",cls:"je-print-view",style:"text-align:-webkit-center;",html:E,autoScroll:!0,autoShow:!0,dockedItems:[{height:40,xtype:"toolbar",dock:"top",style:"border-width:0px;",cls:"je-link-toolbar",defaults:{padding:0,xtype:"button",style:"color:#444;",cls:"btn JEPLUS_B_C07"},items:[{text:"等比例+",handler:function(){l("+","")}},{text:"等比例-",handler:function(){l("-","")}},{text:"横向+",handler:function(){l("+","X")}},{text:"横向-",handler:function(){l("-","X")}},{text:"纵向+",handler:function(){l("+","Y")}},{text:"纵向-",handler:function(){l("-","Y")}}]}],useButton:[{text:"打印",cls:"btn JEPLUS_B_L10",handler:function(){for(var e=document.getElementsByClassName("NoBorder"),t=0;t<e.length;t++){var a=e[t];a.style["border-bottom"]="0px",a.style["border-top"]="0px"}E=document.getElementsByClassName("pagediv-border")[0].innerHTML,E+="<style>html,body{height:100%;margin:0px;padding:0px;}.div-box{font-family: tahoma, arial, verdana, sans-serif;font-size:12px;height:100%;}.pagebody{-moz-transform-origin: 0 0;-webkit-transform-origin:0 0;-o-transform-origin:0 0;}.div-box *{box-sizing: border-box;-moz-box-sizing: border-box;-ms-box-sizing: border-box;-webkit-box-sizing: border-box;}.table-grid-cell-inner{text-overflow: ellipsis;padding: 3px 6px 4px 6px;border:1px solid #000;table-layout:fixed;word-break:break-all;}.childFunc table tr.firstRow td { border-top: 0px !important; } .childFunc table tr.lastRow td { border-bottom: 0px !important; } .childFunc table tr td.firstCol { border-left: 0px !important; } .childFunc table tr td.lastCol { border-right: 0px !important; }.pagediv-border{border:1px solid #cccccc;}</style>";var i,r,o=document.createElement("iframe"),l=document.body.appendChild(o);o.id="myIframe",o.style="width: auto;",i=l.contentWindow||l.contentDocument,(r=l.contentDocument||l.contentWindow.document).open(),r.write(E),r.close(),i.print(),p.close()}},"cancelButton"]})}},openCalc:function(){JE._Calculator||(JE._Calculator=Ext.create("Ext.Component",{xtype:"box",height:600,width:390,cls:"je-calculator-box",shadow:!1,floating:!0,draggable:!0,html:'<iframe scrolling="auto" frameborder="0" width="100%" height="100%" src="/static/ux/sience-calc/calc.html" ></iframe><div class="title" style="">计算器 <i class="fa fa-close"></i><div>',listeners:{hide:function(e){e.getEl().down("iframe").dom.src="/static/ux/sience-calc/calc.html"},afterrender:function(e){e.getEl().down(".fa-close").on("click",function(){e.hide()})}}})),JE._Calculator.show()},openCalendar:function(o){JE.formWin({title:"日历任务",width:675,height:370,modal:!0,useButton:!0,autoShow:!0,frame:!1,defaults:{xtype:"textfield",columnWidth:.5,msgTarget:"side",labelWidth:65,margin:"5 0 0 0 ",labelAlign:"center"},formConfig:{border:0,frame:!1,bodyStyle:"background:transparent;padding:5px 10px 10px;"},items:[{xtype:"hidden",name:"JE_SYS_CALENDAR_ID"},{fieldLabel:"标题",name:"CALENDAR_TITLE",allowBlank:!1,columnWidth:.7,emptyText:"请输入标题..."},{fieldLabel:"创建人",name:"SY_CREATEUSERNAME",readOnly:!0,value:JE.currentUser.username,columnWidth:.3},{xtype:"hidden",name:"SY_CREATEUSER",value:JE.currentUser.userCode},{fieldLabel:"开始",xtype:"datetimefield",format:"Y-m-d H:i",submitFormat:"Y-m-d H:i:s",name:"CALENDAR_STARTTIME",allowBlank:!1,columnWidth:.4,listeners:{change:function(e,t,a){var i=e.up("form").form.findField("CALENDAR_ENDTIME").getValue();if(!Ext.isEmpty(t)&&!Ext.isEmpty(i)){var r=JE.DATE.parseDateTime(t),o=JE.DATE.parseDateTime(i);r.getTime()>=o.getTime()&&(JE.msg(JE.getLocalLang("sys.calendar.msg.timeAlert")),e.setValue(a))}},expand:function(e,t){var a=e.picker,i=e.up("form").form.findField("CALENDAR_YESORNO_CODE").getValue();a.hour.setReadOnly("1"==i),a.minute.setReadOnly("1"==i),a.minute.step=30,a.minute.setMaxValue(30),a.second.readOnly||a.second.setReadOnly(!0)}}},{fieldLabel:"结束",xtype:"datetimefield",format:"Y-m-d H:i",allowBlank:!1,submitFormat:"Y-m-d H:i:s",name:"CALENDAR_ENDTIME",columnWidth:.4,listeners:{change:function(e,t,a){var i=e.up("form").form.findField("CALENDAR_STARTTIME").getValue();if(!Ext.isEmpty(t)&&!Ext.isEmpty(i)){var r=JE.DATE.parseDateTime(t);JE.DATE.parseDateTime(i).getTime()>=r.getTime()&&(JE.msg(JE.getLocalLang("sys.calendar.msg.timeAlert")),e.setValue(a))}},expand:function(e,t){var a=e.picker,i=e.up("form").form.findField("CALENDAR_YESORNO_CODE").getValue();a.hour.setReadOnly("1"==i),a.minute.setReadOnly("1"==i),(a.minute.step=30)!=a.minute.maxValue&&a.minute.setMaxValue(30),a.second.readOnly||a.second.setReadOnly(!0)}}},{fieldLabel:"全天",xtype:"yesnofield",name:"CALENDAR_YESORNO_CODE",columnWidth:.2,labelWidth:40,configInfo:"YESORNO,CALENDAR_YESORNO_CODE~CALENDAR_YESORNO_NAME,code~text",listeners:{change:function(e,t,a){var i=e.up("form").form,r=i.findField("CALENDAR_STARTTIME"),o=i.findField("CALENDAR_ENDTIME");"1"==t?(r.format="Y-m-d",o.format="Y-m-d"):(r.format="Y-m-d H:i",o.format="Y-m-d H:i"),r.setValue(r.getValue()),o.setValue(o.getValue())}}},{fieldLabel:"类型",xtype:"cbbfield",name:"CALENDAR_CALENDARTYPE_CODE",configInfo:"JE_SYS_CALENDARTYPE,CALENDAR_CALENDARTYPE_CODE~CALENDAR_CALENDARTYPE_NAME,code~text",value:"1"},{xtype:"hidden",name:"CALENDAR_CALENDARTYPE_NAME",value:"日常记录"},{fieldLabel:"提醒",xtype:"cbbfield",name:"CALENDAR_REMINDER_CODE",configInfo:"JE_SYS_REMINDER,CALENDAR_REMINDER_CODE~CALENDAR_REMINDER_NAME,code~text",value:"-1"},{xtype:"hidden",name:"CALENDAR_REMINDER_NAME",value:"从不"},{fieldLabel:"所属组",xtype:"cbbfield",name:"CALENDAR_GROUPID",dataArray:[],displayField:"text",valueField:"id",configData:{fieldNames:["CALENDAR_GROUPID","CALENDAR_GROUPNAME","CALENDAR_GROUPCOLOR"],valueNames:["id","text","code"]},columnWidth:.4},{xtype:"hidden",name:"CALENDAR_GROUPNAME"},{xtype:"hidden",name:"CALENDAR_GROUPCOLOR"},{fieldLabel:"消息提醒",xtype:"cgroup",labelWidth:80,name:"CALENDAR_MESSAGETYPE_CODE",configInfo:"JE_WF_MESSAGETYPE,CALENDAR_MESSAGETYPE_CODE~CALENDAR_MESSAGETYPE_NAME,code~text",columnWidth:.6},{xtype:"hidden",name:"CALENDAR_MESSAGETYPE_NAME"},{fieldLabel:"备注",xtype:"htmleditor",name:"CALENDAR_NOTES",columnWidth:1}],showFn:function(e){var t=e.down("form"),a=JE.ajax({url:JE.getUrlMaps("je.core.calendar","getGroupTree")});if(t.form.findField("CALENDAR_GROUPID").getStore().loadData(a.children),o)if("update"==o.type){var i=o.pkValue,r=JE.ajax({url:JE.getUrlMaps("je.core.getInfoById"),params:{tableCode:"",pkValue:i}});t.form.setValues(r)}else o.values&&t.form.setValues(o.values)},fn:function(e,t){t.down("form");var a=e.JE_SYS_CALENDAR_ID;e.tableCode="JE_SYS_CALENDAR";var i=JE.ajax({url:JE.getUrlMaps("je.core.calendar",Ext.isEmpty(a)?"doSave":"doUpdate"),params:e});if(!i.success)return JE.alert("操作失败!"),!1;o.callback&&o.callback(i.obj),Ext.isEmpty(a)?JE.msg(JE.getLocalLang("common.saveSuccessAlert")):JE.msg(JE.getLocalLang("common.updateSuccessAlert"))}})},DES:function(e){if("1"!=JE.systemConfig.JE_SYS_ENCRYPT)return e;var t="PCAT1",a="PCAT2",i="PCAT3";if(JE.isNotEmpty(JE.systemConfig.JE_SYS_ENCRYPT_KEY1)&&(t=JE.systemConfig.JE_SYS_ENCRYPT_KEY1),JE.isNotEmpty(JE.systemConfig.JE_SYS_ENCRYPT_KEY2)&&(a=JE.systemConfig.JE_SYS_ENCRYPT_KEY2),JE.isNotEmpty(JE.systemConfig.JE_SYS_ENCRYPT_KEY3)&&(i=JE.systemConfig.JE_SYS_ENCRYPT_KEY3),Ext.isObject(e)||Ext.isElement(e)){var r=e,o=[],l=["whereSql","orderSql","tableCode"];return JE.isNotEmpty(JE.systemConfig.JE_SYS_ENCRYPT_FIELD)&&(l=JE.split(JE.systemConfig.JE_SYS_ENCRYPT_FIELD,",")),Ext.each(l,function(e){for(var t;!t||-1!=o.indexOf(t);)index=JE.random(23),t="abcdefghigklmnopqrstuvwxyz".substring(index,index+1);if(o.push(t),Ext.isElement(r)&&"FORM"==r.nodeName){var a=r;if(a[e]){var i=document.createElement("input");Ext.fly(i).set({type:"hidden",value:JE.DES(a[e].value),name:t}),a[e].setAttribute("disable","disable"),a.appendChild(i)}}else r.hasOwnProperty(e)&&(r[t]=JE.DES(r[e]),delete r[e])}),{code:"params-keys",value:o.join(",")}}return DES.strEncode(e,t,a,i)},defer:function(e,t,a){if(!Ext.isEmpty(e)){if(a)if(0==e.call())return;var i=setInterval(function(){0==e.call()&&clearInterval(i)},Ext.value(t,1e3));return{clear:function(){clearInterval(i)},fn:i}}},logout:function(e){1!=e&&JE.ajax({url:"/j_spring_security_logout",async:!0}),JE.WebSocket.close(),Ext.util.Cookies.clear("authorization"),window.location.href="/login.html"}}),Ext.define("JE.util.VTypes",{vtypes:{unique:{fn:function(e,t,a,i){var r=t.funcCode,o=JE.getFuncData(r).info.tableName,l=t.up("jeformview");if(!l)return!0;if(l.funcData.info.funcCode==r){if(!l.getRecord())return!0;var n=l.getRecord().get(t.name),s=l.funcData.info.pkName;l.getForm().findField(s).getValue();if(Ext.isEmpty(e)||e==n||e==t.originalValue)return!0}else if(Ext.isEmpty(e)||e==t.ownerCt.startValue)return!0;var c={tableCode:o,FIELDCODE:t.name};return c[t.name]=e,JE.ajax({url:JE.getUrlMaps("je.core.checkFieldUniquen"),params:c}).success},text:"该数据已存在，请重新输入",mask:""},repetition:{fn:function(e,t){if(t.repetition){var a=Ext.getCmp(t.repetition.targetCmpId);return!Ext.isEmpty(a)&&e==a.getValue()}},text:"两个指定组件的组件值不一样",mask:""},daterange:{fn:function(e,t){var a=t.parseDate(e);if(!a)return!1;if(!t.startDateField||this.dateRangeMax&&a.getTime()==this.dateRangeMax.getTime()){if(t.endDateField&&(!this.dateRangeMin||a.getTime()!=this.dateRangeMin.getTime())){var i=t.up("form").down("#"+t.endDateField);i.setMinValue(a),i.validate(),this.dateRangeMin=a}}else{var r=t.up("form").down("#"+t.startDateField);r.setMaxValue(a),r.validate(),this.dateRangeMax=a}return!0},text:"开始时间必须小于结束时间"}},init:function(){var i=this;i.localLang=JE.getLocalLang("core.util.VTypes"),Ext.iterate(i.vtypes,function(e,t){var a={};a[e]=t.fn,Ext.isEmpty(t.text)||(a[e+"Text"]=i.localLang[e+"Text"]),Ext.isEmpty(t.mask)||(a[e+"Mask"]=t.mask),Ext.apply(Ext.form.field.VTypes,a)})}}),Ext.define("JE.util.WebSocket",{debug:!1,SendCommand:{UNKNOWN:0,HEARTBEAT:1,HANDSHAKE:2,LOGIN:3,LOGOUT:4,KICK:5,CHAT:6,CANCEL:7,PUSH:8,OK:10,ERROR:11},ReceiveCommand:{HANDSHAKE:0,IMMSG:1,IM:2,IMGROUPMSG:3,JEPLUS:4,UNREAD:5},connectInterval:5,connectTimes:5,init:function(){JE.WebSocket.connect()},socketio:!0,connect:function(e){var t=JE.WebSocket;t._socket_url=e||JE.systemConfig.JE_CORE_WEBSOCKETURL||"http://219.142.64.198:7001",t.connet4socketio(),t.debug&&console.debug("try connect server, url="+t._socket_url)},connet4websocket:function(){var e=JE.WebSocket,t=e._socket=new WebSocket(e._socket_url);t.onmessage=e._onReceive,t.onopen=e._onOpen,t.onclose=e._onClose,t.onerror=e._onError},connet4socketio:function(){var e=JE.WebSocket;JE.loadScript("/static/ux/socket-io/socket.io.js");var t=e._socket=io.connect(e._socket_url,{transports:[window.WebSocket?"websocket":"polling"]});t.on("connect",e._onOpen),t.on("error",e._onError),t.on("disconnect",e._onDisconnect),t.on("_handshakeEvent",e._onReceive),t.on("message",e._onReceive)},close:function(e){var t=JE.WebSocket,a=t.getSocket();a&&a.close(),t.debug&&e&&console.info("try close web socket client, reason="+e)},getSocket:function(){return JE.WebSocket._socket},getUnReadMsg:function(){return JE.WebSocket._unread_msg||[]},_onReceive:function(e){var t=JE.WebSocket;t.debug&&console.log(">>> receive packet=",e),t._receive(JSON.parse(e||"{}"))},_onOpen:function(){var e=JE.WebSocket;e.debug&&console.log("Web Socket opened!"),e._handshake()},_onClose:function(){var e=JE.WebSocket;delete e._socket,e.debug&&console.log("Web Socket closed!")},_onError:function(e){var t=JE.WebSocket;t.close(),t.debug&&console.error("Web Socket receive, error",e)},_onDisconnect:function(){JE.WebSocket;console.log("Web Socket disconnect! Begin reconnect ...")},_receive:function(e){var t=JE.WebSocket,a=t.ReceiveCommand,i=JE.toNum(e.type),r=e.data;switch(t.debug&&console.log(e),i){case a.HANDSHAKE:(r=JSON.parse(r)).success||console.log("<<< handshake error:",r.msg);break;case a.JEPLUS:try{var o=JSON.parse(r),l=JE.eval(o.callFunction);l&&l.call(l,r)}catch(e){JE.eval(r)}break;case a.UNREAD:t._unread_msg=r=JSON.parse(r);for(var n={},s=0;s<r.length;s++){var c=r[s];if(c.type==a.JEPLUS)try{(o=JSON.parse(c.data)).batchCallFunction?(n[o.batchCallFunction]=n[o.batchCallFunction]||[],n[o.batchCallFunction].push(o)):t._receive(c)}catch(e){t._receive(c)}}JE.isNotEmpty(n)&&Ext.iterate(n,function(e,t){(e=JE.eval(e))&&e.call(e,Ext.encode({totalCount:t.length,rows:t}))});break;case a.IMMSG:case a.IM:case a.IMGROUPMSG:window._je_im_onmessage_&&window._je_im_onmessage_(e)}},send:function(e,t){var a=this,i=a.getSocket();if(i)if(a.socketio)i.emit(e,t);else{var r={cmd:0,type:0,sessionId:"",flags:0,body:t};switch(e){case"message":r.cmd=a.SendCommand.CHAT;break;case"_handshakeEvent":r.cmd=a.SendCommand.HANDSHAKE;break;case"heartbeat":r.cmd=a.SendCommand.HEARTBEAT}i.send(JSON.stringify(r))}else console.error("The socket is null")},_handshake:function(){JE.WebSocket.send("_handshakeEvent",{userId:JE.USER.userId,deviceId:"web",osName:"web",osVersion:"1.0",clientVersion:"1.0"})}}),Ext.define("JE.vue.util",{destroyEl:function(e){setTimeout(function(){e.$destroy(!0),e.$el.parentNode.removeChild(e.$el)},100)},elementUI:function(e){return this.elementUI_VM||(this.elementUI_VM=new Vue),e?this.elementUI_VM[e]:this.elementUI},msg:function(e,t){JE.loadVueScript(),JE.vue.elementUI("$message")({duration:2e3,showClose:!0,message:e,type:t||"info"})},selectUser:function(a){JE.loadVueScript(),JE.loadScript(["/static/vue/components/personSelector/index.min.js","/static/vue/components/personSelector/index.min.css"]);var e=document.createElement("div");e.setAttribute("id","jevue-persion-selector"),e.innerHTML='<div class="vue-box"><person-selector :ishowerroricon="ishowerroricon" :callback="callback" :params="params" :value="value" :value-type="valueType"></person-selector></div>';var t=Ext.getBody().appendChild(e);a.configInfo=a.configInfo||"";var i={show:!0,types:["dept"],title:a.title,width:a.width,height:a.height},r=a.configInfo.split(",");i.selectType=a.multiple?"multiple":-1!=["M","M_"].indexOf(r[3])?"multiple":"single",i.async=-1!=["S_","M_"].indexOf(r[3]),"1"==JE.getObjAttr(a.otherConfig,"ROLE")&&i.types.push("role"),new Vue({el:t.dom,data:function(){return{params:i,value:a.value,valueType:a.valueType,ishowerroricon:a.isShowErrorIcon}},methods:{callback:function(e,t){if("ok"==e){var i=[];return Ext.each(t,function(e){var t={};for(var a in e)t[a.toLocaleLowerCase()]=e[a];i.push(t)}),a.callback(i)}JE.vue.destroyEl(this)}}})},dtPicker:function(t){JE.loadVueScript(),JE.loadScript(["/static/vue/components/dateTimePicker/index.min.js","/static/vue/components/dateTimePicker/index.min.css"]);function e(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild);e.parentNode.removeChild(e)}document.getElementById("jevue-dtPicker")&&e(document.getElementById("jevue-dtPicker")),document.getElementsByClassName("mu-popover")[0]&&e(document.getElementsByClassName("mu-popover")[0]);var a=document.createElement("div");a.setAttribute("id","jevue-dtPicker"),a.innerHTML='<date-time-picker @callback="callback" :params="params" />';var i=Ext.getBody().appendChild(a);new Vue({el:i.dom,data:function(){return{params:t.params}},methods:{callback:function(e){return t.callback(e)}}})}}),Ext.define("JE.vue.ux.form.VueField",{extend:"Ext.form.FieldContainer",layout:"fit",cls:"je-vue-field",mixins:["Ext.form.field.Field"],initComponent:function(){this.items={xtype:"container",layout:"fit",itemId:"vueBox",cls:"je-vue-field-box"},this.callParent(arguments),this.initField()},initVue:Ext.emptyFn,afterRender:function(){this.callParent(arguments),this.initVue(this.getCmp("vueBox").getEl().dom)},setReadOnly:function(e){e=Ext.value(e,!1);this.readOnly=e,this.vm&&(this.vm.readOnly=e)},setDisabled:function(e){var t=this.callParent(arguments);return this.vm&&(this.vm.disabled=e),t},getValue:function(){var e=this.value;return this.vm&&(e=this.vm.value),e},setValue:function(e){this.value=e,this.vm&&(this.vm.value=e)}}),Ext.define("JE.vue.ux.form.DateField",{extend:"JE.vue.ux.form.VueField",alias:["widget.vuedatefield"],initComponent:function(){this.callParent(arguments)},formatMaps:function(){},initVue:function(e){var t=this,a=["<el-date-picker",'size="small"','v-model="value"',':readonly="readonly"','type="date"','@change="change"','placeholder="'+(t.emptyText||"")+'">',"</el-date-picker>"].join(" ");e.innerHTML=a;var i=e.querySelector("el-date-picker");t.vm=new Vue({el:i,data:function(){return{value:t.value,readonly:t.readOnly,disabled:t.disabled,format:"yyyy-MM-dd"}},methods:{change:function(e){t.setValue(e)}}})}}),Ext.Loader.setPath("JE","JE");var JE=JE||{};Ext.define("JE",Ext.apply({singleton:!0,mixins:["JE.util.Common","JE.util.Util","JE.util.DataUtil","JE.util.RendererUtil","JE.util.PinYinUtil","JE.util.DwrMsgUtil","JE.util.RbacUtil"]},JE)),Ext.define("JE.vue",{singleton:!0,mixins:["JE.vue.util"]}),Ext.define("JE.DATE",{singleton:!0,mixins:["JE.util.DateUtil"]}),Ext.define("JE.ChartUtil",{singleton:!0,mixins:["JE.util.ChartUtil"]}),Ext.define("JE.File",{singleton:!0,mixins:["JE.util.OpenFileUtil"]}),Ext.define("JE.WebSocket",{singleton:!0,mixins:["JE.util.WebSocket"]});var DES=function(){var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return this.strEncode=function(e,t,a,i){if(null==e||null==e||0==(e=new String(e)).length)return"";for(var r=(new Date).valueOf(),o=0,l=0;l<t.length;l++)o+=t.charCodeAt(l);for(l=0;l<a.length;l++)o-=a.charCodeAt(l);var n=!1;for(l=0;l<i.length;l++)n?o+=i.charCodeAt(l):o-=i.charCodeAt(l),n=!n;o<0&&(o=-o);var s=4+(o+r)%16,c=(o+s)%g.length,d=[],u=encodeBase64(e).split(""),E=[];for(l=0;l<u.length;l++){var p=g.indexOf(u[l]);if(p=(p+c)%g.length,E.push(g.charAt(p)),E.length==s){for(var f=E.length-1;0<=f;f--)d.push(E[f]);E=[]}}if(0!=E.length)for(f=E.length-1;0<=f;f--)d.push(E[f]);for(var m=(s+=d.length+4).toString(16);m.length<4;)m="0"+m;return d.push(m),d.join("")},this.strDecode=function(e,t,a,i){return""},_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",this.encodeBase64=function(e){var t,a,i,r,o,l,n,s="",c=0;for(e=_utf8_encode(e);c<e.length;)r=(t=e.charCodeAt(c++))>>2,o=(3&t)<<4|(a=e.charCodeAt(c++))>>4,l=(15&a)<<2|(i=e.charCodeAt(c++))>>6,n=63&i,isNaN(a)?l=n=64:isNaN(i)&&(n=64),s=s+_keyStr.charAt(r)+_keyStr.charAt(o)+_keyStr.charAt(l)+_keyStr.charAt(n);return s},this.decodeBase64=function(e){var t,a,i,r,o,l,n="",s=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");s<e.length;)t=_keyStr.indexOf(e.charAt(s++))<<2|(r=_keyStr.indexOf(e.charAt(s++)))>>4,a=(15&r)<<4|(o=_keyStr.indexOf(e.charAt(s++)))>>2,i=(3&o)<<6|(l=_keyStr.indexOf(e.charAt(s++))),n+=String.fromCharCode(t),64!=o&&(n+=String.fromCharCode(a)),64!=l&&(n+=String.fromCharCode(i));return n=_utf8_decode(n)},_utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",a=0;a<e.length;a++){var i=e.charCodeAt(a);i<128?t+=String.fromCharCode(i):(127<i&&i<2048?t+=String.fromCharCode(i>>6|192):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128)),t+=String.fromCharCode(63&i|128))}return t},_utf8_decode=function(e){for(var t="",a=0,i=c1=c2=0;a<e.length;)(i=e.charCodeAt(a))<128?(t+=String.fromCharCode(i),a++):191<i&&i<224?(c2=e.charCodeAt(a+1),t+=String.fromCharCode((31&i)<<6|63&c2),a+=2):(c2=e.charCodeAt(a+1),c3=e.charCodeAt(a+2),t+=String.fromCharCode((15&i)<<12|(63&c2)<<6|63&c3),a+=3);return t},this}();
//# sourceMappingURL=maps/je-util-min.js.map
